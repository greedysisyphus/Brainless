import{r as u,a3 as ra,k as L,a4 as Ot,n as ge,a5 as na,a6 as Be,a7 as la,a8 as ia,a9 as oa,aa as Et,ab as ca,ac as da,ad as ua,ae as ma,af as xa,ag as Bt,ah as ha,ai as fa,aj as pa,ak as ga,al as ba,am as ya,J as va,y as ja,z as Na,an as wa,ao as Aa,ap as Sa,aq as Ct,G as ct,ar as Pa,as as ka,at as Ia,au as Ta,av as Oa,i as Ea,h as jt,U as Rt,M as Oe,d as Ba,aw as Ca,ax as Ra,ay as Nt,O as Da,az as za,aA as Ma,aB as $a,aC as _a,aD as La,aE as Ka,aF as Fa,aG as et,aH as wt,aI as Wa,aJ as Va,aK as Ga,j as e,W as tt,aL as pe,aM as At,R as St,B as Ua,c as Ha,X as Ya,Y as Ja,T as qa,aN as Xa,aO as Qa,aP as at,aQ as st,aR as rt,aS as Za,aT as es,aU as ts}from"./index.CE3AVWnB.js";import{s as Dt,a as as,b as ss,P as rs}from"./PolarAngleAxis.FIahnFpX.js";function lt(){return lt=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var n in s)({}).hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},lt.apply(null,arguments)}function Pt(t,a){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);a&&(n=n.filter(function(m){return Object.getOwnPropertyDescriptor(t,m).enumerable})),s.push.apply(s,n)}return s}function nt(t){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?Pt(Object(s),!0).forEach(function(n){ns(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Pt(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function ns(t,a,s){return(a=ls(a))in t?Object.defineProperty(t,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[a]=s,t}function ls(t){var a=is(t,"string");return typeof a=="symbol"?a:a+""}function is(t,a){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,a||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(t)}function zt(t){return typeof t=="string"?parseInt(t,10):t}function os(t,a){var s="".concat(a.cx||t.cx),n=Number(s),m="".concat(a.cy||t.cy),j=Number(m);return nt(nt(nt({},a),t),{},{cx:n,cy:j})}function Mt(t){return u.createElement(ra,lt({shapeType:"sector",propTransformer:os},t))}function kt(t,a){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);a&&(n=n.filter(function(m){return Object.getOwnPropertyDescriptor(t,m).enumerable})),s.push.apply(s,n)}return s}function Ce(t){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?kt(Object(s),!0).forEach(function(n){cs(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):kt(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function cs(t,a,s){return(a=ds(a))in t?Object.defineProperty(t,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[a]=s,t}function ds(t){var a=us(t,"string");return typeof a=="symbol"?a:a+""}function us(t,a){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,a||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(t)}var ms=(t,a)=>ja(t,a),xs=(t,a)=>Dt(t,"radiusAxis",a),De=L([ms,xs],(t,a)=>{if(!(t==null||a==null))return Ce(Ce({},t),{},{scale:a})}),dt=(t,a,s,n)=>as(t,"radiusAxis",a,n),hs=(t,a,s)=>Na(t,s),fs=(t,a,s)=>Dt(t,"angleAxis",s),ze=L([hs,fs],(t,a)=>{if(!(t==null||a==null))return Ce(Ce({},t),{},{scale:a})}),ut=(t,a,s,n)=>ss(t,"angleAxis",s,n),ps=(t,a,s,n)=>n,mt=L([Ot,ps],(t,a)=>{if(t.some(s=>s.type==="radialBar"&&a.dataKey===s.dataKey&&a.stackId===s.stackId))return a}),$t=L([ge,De,dt,ze,ut],(t,a,s,n,m)=>na(t,"radiusAxis")?Be(a,s,!1):Be(n,m,!1)),gs=L([ze,De,ge],(t,a,s)=>{var n=s==="radial"?t:a;if(!(n==null||n.scale==null))return la({numericAxis:n})}),bs=(t,a,s,n,m)=>m,ys=(t,a,s,n,m)=>s,vs=(t,a,s,n,m)=>a,_t=(t,a,s,n,m)=>n.maxBarSize,js=L([ge,Ot,ys,vs],(t,a,s,n)=>a.filter(m=>t==="centric"?m.angleAxisId===s:m.radiusAxisId===n).filter(m=>m.hide===!1).filter(m=>m.type==="radialBar")),Ns=()=>{},ws=L([js,ia,Ns],oa),As=L([ge,Et,ze,ut,De,dt,_t],(t,a,s,n,m,j,A)=>{var k,b,z=wa(A)?a:A;if(t==="centric"){var P,T;return(P=(T=Be(s,n,!0))!==null&&T!==void 0?T:z)!==null&&P!==void 0?P:0}return(k=(b=Be(m,j,!0))!==null&&b!==void 0?b:z)!==null&&k!==void 0?k:0}),Ss=L([ws,Et,ca,da,As,$t,_t],ua),Ps=L([Ss,mt],(t,a)=>{if(!(t==null||a==null)){var s=t.find(n=>n.stackId===a.stackId&&a.dataKey!=null&&n.dataKeys.includes(a.dataKey));if(s!=null)return s.position}}),Lt=L([ma],t=>t.filter(a=>a.type==="radialBar").filter(xa)),ks=L([Lt,Bt,ha],fa),It=L([ks,Lt,pa],ga),Is=(t,a,s)=>{var n=ge(t);return n==="centric"?It(t,"radiusAxis",a):It(t,"angleAxis",s)},Ts=L([Is,mt],ba),Os=L([ze,ut,De,dt,ya,mt,$t,ge,gs,va,bs,Ps,Ts],(t,a,s,n,m,j,A,k,b,z,P,T,U)=>{var{chartData:O,dataStartIndex:q,dataEndIndex:H}=m;if(j==null||s==null||t==null||O==null||A==null||T==null||k!=="centric"&&k!=="radial"||n==null)return[];var{dataKey:K,minPointSize:M}=j,{cx:C,cy:V,startAngle:R,endAngle:Y}=z,E=O.slice(q,H+1),$=k==="centric"?s:t,_=U?$.scale.domain():null;return Vs({angleAxis:t,angleAxisTicks:a,bandSize:A,baseValue:b,cells:P,cx:C,cy:V,dataKey:K,dataStartIndex:q,displayedData:E,endAngle:Y,layout:k,minPointSize:M,pos:T,radiusAxis:s,radiusAxisTicks:n,stackedData:U,stackedDomain:_,startAngle:R})}),Es=L([Bt,(t,a)=>a],(t,a)=>{var{chartData:s,dataStartIndex:n,dataEndIndex:m}=t;if(s==null)return[];var j=s.slice(n,m+1);return j.length===0?[]:j.map(A=>({type:a,value:A.name,color:A.fill,payload:A}))}),Bs=["shape","activeShape","cornerRadius","id"],Cs=["onMouseEnter","onClick","onMouseLeave"],Rs=["value","background"];function Re(){return Re=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var n in s)({}).hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},Re.apply(null,arguments)}function Tt(t,a){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);a&&(n=n.filter(function(m){return Object.getOwnPropertyDescriptor(t,m).enumerable})),s.push.apply(s,n)}return s}function D(t){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?Tt(Object(s),!0).forEach(function(n){xt(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Tt(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function xt(t,a,s){return(a=Ds(a))in t?Object.defineProperty(t,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[a]=s,t}function Ds(t){var a=zs(t,"string");return typeof a=="symbol"?a:a+""}function zs(t,a){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,a||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(t)}function it(t,a){if(t==null)return{};var s,n,m=Ms(t,a);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(t);for(n=0;n<j.length;n++)s=j[n],a.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(m[s]=t[s])}return m}function Ms(t,a){if(t==null)return{};var s={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(a.indexOf(n)!==-1)continue;s[n]=t[n]}return s}var ot=[];function Kt(t){var{sectors:a,allOtherRadialBarProps:s,showLabels:n}=t,{shape:m,activeShape:j,cornerRadius:A,id:k}=s,b=it(s,Bs),z=Da(b),P=ct(za),{onMouseEnter:T,onClick:U,onMouseLeave:O}=s,q=it(s,Cs),H=Ma(T,s.dataKey),K=$a(O),M=_a(U,s.dataKey);return a==null?null:u.createElement(u.Fragment,null,a.map((C,V)=>{var R=j&&P===String(V),Y=H(C,V),E=K(C,V),$=M(C,V),_=D(D(D(D({},z),{},{cornerRadius:zt(A)},C),Rt(q,C,V)),{},{onMouseEnter:Y,onMouseLeave:E,onClick:$,key:"sector-".concat(V),className:"recharts-radial-bar-sector ".concat(C.className),forceCornerRadius:b.forceCornerRadius,cornerIsExternal:b.cornerIsExternal,isActive:R,option:R?j:m});return u.createElement(Mt,_)}),n&&La.renderCallByParent(s,a))}function $s(t){var{props:a,previousSectorsRef:s}=t,{data:n,isAnimationActive:m,animationBegin:j,animationDuration:A,animationEasing:k,onAnimationEnd:b,onAnimationStart:z}=a,P=Ka(a,"recharts-radialbar-"),T=s.current,[U,O]=u.useState(!0),q=u.useCallback(()=>{typeof b=="function"&&b(),O(!1)},[b]),H=u.useCallback(()=>{typeof z=="function"&&z(),O(!0)},[z]);return u.createElement(Fa,{begin:j,duration:A,isActive:m,easing:k,onAnimationStart:H,onAnimationEnd:q,key:P},K=>{var M=K===1?n:(n??ot).map((C,V)=>{var R=T&&T[V];if(R){var Y=et(R.startAngle,C.startAngle),E=et(R.endAngle,C.endAngle);return D(D({},C),{},{startAngle:Y(K),endAngle:E(K)})}var{endAngle:$,startAngle:_}=C,X=et(_,$);return D(D({},C),{},{endAngle:X(K)})});return K>0&&(s.current=M??null),u.createElement(Oe,null,u.createElement(Kt,{sectors:M??ot,allOtherRadialBarProps:a,showLabels:!U}))})}function _s(t){var{data:a=[],isAnimationActive:s}=t,n=u.useRef(null),m=n.current;return s&&a&&a.length&&(!m||m!==a)?u.createElement($s,{props:t,previousSectorsRef:n}):u.createElement(Kt,{sectors:a,allOtherRadialBarProps:t,showLabels:!0})}function Ls(t){var a=ct(s=>Es(s,t.legendType));return u.createElement(Pa,{legendPayload:a??[]})}function Ks(t){var{dataKey:a,data:s,stroke:n,strokeWidth:m,name:j,hide:A,fill:k,tooltipType:b}=t;return{dataDefinedOnItem:s,positions:void 0,settings:{stroke:n,strokeWidth:m,fill:k,nameKey:void 0,dataKey:a,name:Oa(j,a),hide:A,type:b,color:k,unit:""}}}class Fs extends u.PureComponent{renderBackground(a){if(a==null)return null;var{cornerRadius:s}=this.props,n=Ea(this.props.background,!1);return a.map((m,j)=>{var{value:A,background:k}=m,b=it(m,Rs);if(!k)return null;var z=D(D(D(D(D({cornerRadius:zt(s)},b),{},{fill:"#eee"},k),n),Rt(this.props,m,j)),{},{index:j,key:"sector-".concat(j),className:jt("recharts-radial-bar-background-sector",n==null?void 0:n.className),option:k,isActive:!1});return u.createElement(Mt,z)})}render(){var{hide:a,data:s,className:n,background:m}=this.props;if(a)return null;var j=jt("recharts-area",n);return u.createElement(Oe,{className:j},m&&u.createElement(Oe,{className:"recharts-radial-bar-background"},this.renderBackground(s)),u.createElement(Oe,{className:"recharts-radial-bar-sectors"},u.createElement(_s,this.props)))}}function Ws(t){var a,s=ka(t.children,Ba),n={data:void 0,hide:!1,id:t.id,dataKey:t.dataKey,minPointSize:t.minPointSize,stackId:Ct(t.stackId),maxBarSize:t.maxBarSize,barSize:t.barSize,type:"radialBar",angleAxisId:t.angleAxisId,radiusAxisId:t.radiusAxisId},m=(a=ct(j=>Os(j,t.radiusAxisId,t.angleAxisId,n,s)))!==null&&a!==void 0?a:ot;return u.createElement(u.Fragment,null,u.createElement(Ia,{fn:Ks,args:D(D({},t),{},{data:m})}),u.createElement(Fs,Re({},t,{data:m})))}var Ee={angleAxisId:0,radiusAxisId:0,minPointSize:0,hide:!1,legendType:"rect",data:[],isAnimationActive:!Ta.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease",forceCornerRadius:!1,cornerIsExternal:!1};function Vs(t){var{displayedData:a,stackedData:s,dataStartIndex:n,stackedDomain:m,dataKey:j,baseValue:A,layout:k,radiusAxis:b,radiusAxisTicks:z,bandSize:P,pos:T,angleAxis:U,minPointSize:O,cx:q,cy:H,angleAxisTicks:K,cells:M,startAngle:C,endAngle:V}=t;return(a??[]).map((R,Y)=>{var E,$,_,X,te,Ae;if(s?E=Ca(s[n+Y],m):(E=Ra(R,j),Array.isArray(E)||(E=[A,E])),k==="radial"){$=Nt({axis:b,ticks:z,bandSize:P,offset:T.offset,entry:R,index:Y}),te=U.scale(E[1]),X=U.scale(E[0]),_=($??0)+T.size;var le=te-X;if(Math.abs(O)>0&&Math.abs(le)<Math.abs(O)){var Me=wt(le||O)*(Math.abs(O)-Math.abs(le));te+=Me}Ae={background:{cx:q,cy:H,innerRadius:$,outerRadius:_,startAngle:C,endAngle:V}}}else{$=b.scale(E[0]),_=b.scale(E[1]),X=Nt({axis:U,ticks:K,bandSize:P,offset:T.offset,entry:R,index:Y}),te=(X??0)+T.size;var ie=_-$;if(Math.abs(O)>0&&Math.abs(ie)<Math.abs(O)){var $e=wt(ie||O)*(Math.abs(O)-Math.abs(ie));_+=$e}}return D(D(D({},R),Ae),{},{payload:R,value:s?E:E[1],cx:q,cy:H,innerRadius:$,outerRadius:_,startAngle:X,endAngle:te},M&&M[Y]&&M[Y].props)})}class ht extends u.PureComponent{render(){return u.createElement(Aa,{id:this.props.id,type:"radialBar"},a=>{var s,n,m;return u.createElement(u.Fragment,null,u.createElement(Sa,{type:"radialBar",id:a,data:void 0,dataKey:this.props.dataKey,hide:(s=this.props.hide)!==null&&s!==void 0?s:Ee.hide,angleAxisId:(n=this.props.angleAxisId)!==null&&n!==void 0?n:Ee.angleAxisId,radiusAxisId:(m=this.props.radiusAxisId)!==null&&m!==void 0?m:Ee.radiusAxisId,stackId:Ct(this.props.stackId),barSize:this.props.barSize,minPointSize:this.props.minPointSize,maxBarSize:this.props.maxBarSize}),u.createElement(Ls,this.props),u.createElement(Ws,Re({},this.props,{id:a})))})}}xt(ht,"displayName","RadialBar");xt(ht,"defaultProps",Ee);var Gs=["axis","item"],Us={layout:"radial",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},Hs=u.forwardRef((t,a)=>{var s=Wa(t,Us);return u.createElement(Va,{chartName:"RadialBarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Gs,tooltipPayloadSearcher:Ga,categoricalChartProps:s,ref:a})});function qs(){const[t,a]=u.useState(!0),[s,n]=u.useState(null),[m,j]=u.useState(null),[A,k]=u.useState([]),[b,z]=u.useState([]),[P,T]=u.useState([]),[U,O]=u.useState([]),[q,H]=u.useState([]),[K,M]=u.useState([]),[C,V]=u.useState([]),[R,Y]=u.useState([]),[E,$]=u.useState([]),[_,X]=u.useState([]),[te,Ae]=u.useState([]),[le,Me]=u.useState([]),[ie,$e]=u.useState([]),[_e,Ft]=u.useState([]),[F,Wt]=u.useState("recent"),[I,Le]=u.useState("7days"),[be,Vt]=u.useState("7days"),[ue,ye]=u.useState(20),[ft,pt]=u.useState(!1),[Gt,ve]=u.useState(!0),je=r=>!r||!Array.isArray(r)?[]:r.filter(l=>l&&l["#text"]&&l["#text"]!==""&&!l["#text"].includes("2a96cbd8b46e442fc41c2b86b821562f")&&!l["#text"].includes("default")&&!l["#text"].includes("placeholder")),Ke=async()=>{var r,l,o,h,g,f,p,c,d,i,x,N,w;a(!0),n(null);try{const[v,S]=await Promise.all([Xa(),At(20)]),[Z,Fe,xe,he,We,Ve,Ge,Ue,He,Ye]=await Promise.all([Qa(2e3),at(10,"7day"),st(10,"7day"),rt(10,"7day"),at(10,"1month"),st(10,"1month"),rt(10,"1month"),at(10,"overall"),st(10,"overall"),rt(10,"overall")]);j(v==null?void 0:v.user);const Je=((r=S==null?void 0:S.recenttracks)==null?void 0:r.track)||[],Pe=Array.isArray(Je)?Je:[Je].filter(Boolean);k(Pe);const qe=(l=S==null?void 0:S.recenttracks)==null?void 0:l["@attr"];if(qe){const B=parseInt(qe.totalPages||"1",10),ae=parseInt(qe.page||"1",10);ve(ae<B)}else ve(Pe.length>=20);z(Array.isArray(Z)?Z:[]),Pe.length<=30?ye(Pe.length):ye(20);const Xe=B=>B?(Array.isArray(B)?B:[B]).map(y=>(y.image&&!Array.isArray(y.image)&&(y.image=[y.image]),y)):[],ke=B=>(Array.isArray(B)?B:B?[B]:[]).map(y=>(y.image&&(Array.isArray(y.image)||(y.image=[y.image]),y.image=y.image.filter(se=>se&&se["#text"]&&se["#text"]!=="")),y)),bt=B=>B?(Array.isArray(B)?B:[B].filter(Boolean)).map(y=>(y.image&&(Array.isArray(y.image)||(y.image=[y.image])),y)):[],Yt=Xe((o=Fe==null?void 0:Fe.topartists)==null?void 0:o.artist),Jt=Xe((h=We==null?void 0:We.topartists)==null?void 0:h.artist),qt=Xe((g=Ue==null?void 0:Ue.topartists)==null?void 0:g.artist),Qe=async B=>(await Promise.allSettled(B.map(async(y,se)=>{var G,oe;try{se>0&&await new Promise(ce=>setTimeout(ce,200*se));const ne=await Za(y.name),fe=(G=ne==null?void 0:ne.artist)==null?void 0:G.image;if(fe&&Array.isArray(fe)){const ce=je(fe);if(ce.length>0)return{...y,image:ce};try{const Ne=`https://ws.audioscrobbler.com/2.0/?${new URLSearchParams({method:"artist.getTopAlbums",api_key:es,format:"json",artist:y.name,limit:"3"}).toString()}`,de=await fetch(Ne);if(de.ok){const we=await de.json();if(we.error)throw new Error(we.message);const Ie=(oe=we==null?void 0:we.topalbums)==null?void 0:oe.album;if(Ie){const aa=Array.isArray(Ie)?Ie:[Ie];for(const Te of aa)if(Te.image){const sa=Array.isArray(Te.image)?Te.image:[Te.image],vt=je(sa);if(vt.length>0)return{...y,image:vt}}}}}catch(ee){console.warn(`ç„¡æ³•å¾å°ˆè¼¯ç²å–å‚™é¸åœ–ç‰‡ (${y.name}):`,ee.message)}}return y}catch(ne){return console.warn(`ç„¡æ³•ç²å–è—è¡“å®¶ ${y.name} çš„è©³ç´°è³‡è¨Š:`,ne.message),y}}))).map((y,se)=>y.status==="fulfilled"?y.value:(console.warn("è—è¡“å®¶å¢å¼·å¤±æ•—:",y.reason),B[se])).filter(Boolean),[yt,Xt,Qt]=await Promise.all([Qe(Yt),Qe(Jt),Qe(qt)]),Ze=async B=>{const ae=bt(B);return[...(await Promise.allSettled(ae.slice(0,10).map(async(G,oe)=>{var ne,fe,ce;try{oe>0&&await new Promise(de=>setTimeout(de,200*oe));const ee=await ts(G.artist.name,G.name),Ne=((fe=(ne=ee==null?void 0:ee.track)==null?void 0:ne.album)==null?void 0:fe.image)||((ce=ee==null?void 0:ee.track)==null?void 0:ce.image);if(Ne&&Array.isArray(Ne)){const de=je(Ne);if(de.length>0)return{...G,image:de}}return G}catch(ee){return console.warn(`ç„¡æ³•ç²å–æ›²ç›® ${G.artist.name} - ${G.name} çš„è©³ç´°è³‡è¨Š:`,ee.message),G}}))).map((G,oe)=>G.status==="fulfilled"?G.value:(console.warn("æ›²ç›®å¢å¼·å¤±æ•—:",G.reason),ae[oe])).filter(Boolean),...ae.slice(10)]},[Zt,ea,ta]=await Promise.all([Ze((f=he==null?void 0:he.toptracks)==null?void 0:f.track),Ze((p=Ge==null?void 0:Ge.toptracks)==null?void 0:p.track),Ze((c=Ye==null?void 0:Ye.toptracks)==null?void 0:c.track)]);M(yt),V(ke((d=xe==null?void 0:xe.topalbums)==null?void 0:d.album)),Y(Zt),$(Xt),X(ke((i=Ve==null?void 0:Ve.topalbums)==null?void 0:i.album)),Ae(ea),Me(Qt),$e(ke((x=He==null?void 0:He.topalbums)==null?void 0:x.album)),Ft(ta),T(yt),O(ke((N=xe==null?void 0:xe.topalbums)==null?void 0:N.album)),H(bt((w=he==null?void 0:he.toptracks)==null?void 0:w.track))}catch(v){console.error("ç²å–éŸ³æ¨‚è³‡æ–™å¤±æ•—:",v),n(v.message||"ç²å–éŸ³æ¨‚è³‡æ–™å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦")}finally{a(!1)}};u.useEffect(()=>{Ke()},[]),u.useEffect(()=>{be==="7days"?(T(K),O(C),H(R)):be==="30days"?(T(E),O(_),H(te)):be==="overall"&&(T(le),O(ie),H(_e))},[be,K,C,R,E,_,te,le,ie,_e]);const Ut=r=>{if(!r||!r.uts)return"æ­£åœ¨æ’­æ”¾";try{const l=parseInt(r.uts,10)*1e3,o=new Date(l),g=new Date-o,f=Math.floor(g/6e4),p=Math.floor(f/60),c=Math.floor(p/24);return f<1?"å‰›å‰›":f<60?`${f} åˆ†é˜å‰`:p<24?`${p} å°æ™‚å‰`:c<7?`${c} å¤©å‰`:o.toLocaleDateString("zh-TW",{month:"short",day:"numeric"})}catch(l){return console.error("æ™‚é–“æ ¼å¼åŒ–éŒ¯èª¤:",l),"æœªçŸ¥"}},J=r=>{if(!r)return"0";const l=parseInt(r,10);if(l<1e4)return l.toLocaleString("zh-TW");if(l>=1e6){const h=l/1e6;return h%1===0?`${h.toFixed(0)}M`:`${h.toFixed(1)}M`}const o=l/1e3;return o%1===0?`${o.toFixed(0)}K`:`${o.toFixed(1)}K`};u.useMemo(()=>!P||P.length===0?[]:P.slice(0,8).map((r,l)=>({name:r.name.length>15?r.name.substring(0,15)+"...":r.name,value:parseInt(r.playcount,10),fullName:r.name})),[P]);const re=u.useMemo(()=>{if(!b||b.length===0)return[];const r=Array.from({length:24},(l,o)=>({hour:o,count:0,label:`${o}:00`}));return b.forEach(l=>{var o,h;if((o=l.date)!=null&&o.uts&&!((h=l["@attr"])!=null&&h.nowplaying)){const g=parseInt(l.date.uts,10)*1e3,p=new Date(g).getHours();r[p].count++}}),r},[b]),Q=u.useMemo(()=>{if(!b||b.length===0)return[];const r=I==="30days"?30:7,l=new Date,o=new Date(l.getFullYear(),l.getMonth(),l.getDate()),h=Array.from({length:r},(f,p)=>{const c=new Date(o);c.setDate(c.getDate()-(r-1-p));const d=`${c.getFullYear()}-${String(c.getMonth()+1).padStart(2,"0")}-${String(c.getDate()).padStart(2,"0")}`;return{date:c.toLocaleDateString("zh-TW",{month:"short",day:"numeric"}),count:0,fullDate:c,dayName:c.toLocaleDateString("zh-TW",{weekday:"short"}),dateKey:d}}),g=new Map;return h.forEach((f,p)=>{g.set(f.dateKey,p)}),b.forEach(f=>{var p,c;if((p=f.date)!=null&&p.uts&&!((c=f["@attr"])!=null&&c.nowplaying)){const d=parseInt(f.date.uts,10)*1e3,i=new Date(d),x=new Date(i.getFullYear(),i.getMonth(),i.getDate()),N=`${x.getFullYear()}-${String(x.getMonth()+1).padStart(2,"0")}-${String(x.getDate()).padStart(2,"0")}`,w=g.get(N);w!==void 0&&h[w].count++}}),h},[b,I]),Se=u.useMemo(()=>Q.reduce((r,l)=>r+l.count,0),[Q]),me=u.useMemo(()=>{if(!re.length)return null;const r=re.reduce((l,o)=>o.count>l.count?o:l,re[0]);return{hour:r.hour,count:r.count}},[re]);u.useMemo(()=>!P||P.length===0?[]:P.slice(0,10).map(r=>({name:r.name.length>20?r.name.substring(0,20)+"...":r.name,plays:parseInt(r.playcount,10),fullName:r.name})),[P]);const W=u.useMemo(()=>{const r=new Set,l=new Set,o=new Set;(I==="7days"?b.filter(c=>{var w,v;if(!((w=c.date)!=null&&w.uts)||(v=c["@attr"])!=null&&v.nowplaying)return!1;const d=parseInt(c.date.uts,10)*1e3,i=new Date(d),x=new Date;x.setHours(0,0,0,0),i.setHours(0,0,0,0);const N=Math.floor((x-i)/(1e3*60*60*24));return N>=0&&N<7}):I==="30days"?b.filter(c=>{var w,v;if(!((w=c.date)!=null&&w.uts)||(v=c["@attr"])!=null&&v.nowplaying)return!1;const d=parseInt(c.date.uts,10)*1e3,i=new Date(d),x=new Date;x.setHours(0,0,0,0),i.setHours(0,0,0,0);const N=Math.floor((x-i)/(1e3*60*60*24));return N>=0&&N<30}):b).forEach(c=>{var d,i;(d=c.artist)!=null&&d["#text"]&&r.add(c.artist["#text"]),(i=c.album)!=null&&i["#text"]&&l.add(c.album["#text"]),c.name&&o.add(c.name)});const g={artists:r.size,albums:l.size,tracks:o.size,timestamp:Date.now()};let f=null;try{const c=localStorage.getItem("lastfm_stats_previous");if(c){const d=JSON.parse(c);Date.now()-d.timestamp<24*60*60*1e3&&(f=d)}}catch(c){console.error("è®€å–ä¸Šæ¬¡çµ±è¨ˆå¤±æ•—:",c)}try{localStorage.setItem("lastfm_stats_previous",JSON.stringify(g))}catch(c){console.error("ä¿å­˜çµ±è¨ˆå¤±æ•—:",c)}const p=(c,d)=>{if(!d||d===0)return null;const i=(c-d)/d*100;return Math.round(i)};return{artists:g.artists,albums:g.albums,tracks:g.tracks,artistsChange:f?p(g.artists,f.artists):null,albumsChange:f?p(g.albums,f.albums):null,tracksChange:f?p(g.tracks,f.tracks):null}},[b,I]),gt=u.useMemo(()=>{if(!re.length)return[];const r=Math.max(...re.map(l=>l.count),1);return re.map(l=>({hour:l.hour,count:l.count,fill:`hsl(${l.hour/24*240}, 70%, 60%)`,percentage:l.count/r*100}))},[re]),Ht=u.useMemo(()=>!Q||Q.length===0?[]:Q.map(r=>({day:r.dayName,date:r.date,count:r.count||0})),[Q]);return t?e.jsx("div",{className:"container-custom py-8",children:e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(tt,{className:"w-12 h-12 text-primary animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-text-secondary",children:"æ­£åœ¨è¼‰å…¥éŸ³æ¨‚è³‡æ–™..."})]})})}):s?e.jsx("div",{className:"container-custom py-8",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 rounded-xl p-6 text-center",children:[e.jsx("p",{className:"text-red-400 mb-4",children:s}),e.jsx("button",{onClick:Ke,className:"px-4 py-2 bg-primary/20 border border-primary/30 text-primary rounded-lg hover:bg-primary/30 transition-colors",children:"é‡æ–°è¼‰å…¥"})]})})}):e.jsx("div",{className:"container-custom py-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-purple-500/20 to-pink-500/20 rounded-xl border border-purple-500/30",children:e.jsx(pe,{className:"w-8 h-8 text-purple-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-primary mb-1",children:"éŸ³æ¨‚"}),e.jsx("p",{className:"text-text-secondary",children:"Last.fm éŸ³æ¨‚çµ±è¨ˆå’Œæ’­æ”¾è¨˜éŒ„"})]})]}),e.jsx("button",{onClick:Ke,className:"p-2 rounded-lg bg-surface/40 border border-white/10 text-text-secondary hover:text-primary hover:bg-surface/60 transition-colors",title:"é‡æ–°è¼‰å…¥",children:e.jsx(tt,{className:"w-5 h-5"})})]}),m&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-surface/40 backdrop-blur-md border border-white/10 rounded-xl p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-primary mb-1",children:J(m.playcount)}),e.jsx("div",{className:"text-sm text-text-secondary",children:"ç¸½æ’­æ”¾æ¬¡æ•¸"})]}),e.jsxs("div",{className:"bg-surface/40 backdrop-blur-md border border-white/10 rounded-xl p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-primary mb-1",children:J(m.artist_count)}),e.jsx("div",{className:"text-sm text-text-secondary",children:"ä¸åŒè—è¡“å®¶"})]}),e.jsxs("div",{className:"bg-surface/40 backdrop-blur-md border border-white/10 rounded-xl p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-primary mb-1",children:J(m.album_count)}),e.jsx("div",{className:"text-sm text-text-secondary",children:"ä¸åŒå°ˆè¼¯"})]})]})]}),e.jsx("div",{className:"flex gap-2 mb-6 border-b border-white/10",children:[{id:"recent",label:"æœ€è¿‘æ’­æ”¾"},{id:"artists",label:"æœ€æ„›è—è¡“å®¶"},{id:"albums",label:"æœ€æ„›å°ˆè¼¯"},{id:"tracks",label:"æœ€æ„›æ­Œæ›²"},{id:"stats",label:"çµ±è¨ˆ"}].map(r=>e.jsx("button",{onClick:()=>Wt(r.id),className:`px-4 py-2 font-medium transition-colors ${F===r.id?"text-primary border-b-2 border-primary":"text-text-secondary hover:text-primary"}`,children:r.label},r.id))}),(F==="artists"||F==="albums"||F==="tracks")&&e.jsx("div",{className:"flex gap-2 mb-6",children:[{id:"7days",label:"7 å¤©"},{id:"30days",label:"30 å¤©"},{id:"overall",label:"ç¸½è¨ˆ"}].map(r=>e.jsx("button",{onClick:()=>Vt(r.id),className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors ${be===r.id?"bg-primary/20 text-primary border border-primary/30":"bg-surface/40 text-text-secondary hover:text-primary hover:bg-surface/60 border border-white/10"}`,children:r.label},r.id))}),F==="recent"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:A.slice(0,ue).map((r,l)=>{var g,f,p,c,d,i;const o=((g=r["@attr"])==null?void 0:g.nowplaying)==="true";let h=null;return r.image&&Array.isArray(r.image)&&(h=((f=r.image.find(x=>x&&x.size==="large"&&x["#text"]&&x["#text"]!==""))==null?void 0:f["#text"])||((p=r.image.find(x=>x&&x.size==="extralarge"&&x["#text"]&&x["#text"]!==""))==null?void 0:p["#text"])||((c=r.image.find(x=>x&&x.size==="medium"&&x["#text"]&&x["#text"]!==""))==null?void 0:c["#text"])||((d=r.image.find(x=>x&&x.size==="small"&&x["#text"]&&x["#text"]!==""))==null?void 0:d["#text"])||((i=r.image.find(x=>x&&x["#text"]&&x["#text"]!==""))==null?void 0:i["#text"])),h&&(h.includes("2a96cbd8b46e442fc41c2b86b821562f")||h.includes("default")||h.includes("placeholder"))&&(h=null),e.jsx("div",{className:"bg-surface/40 backdrop-blur-md border border-white/10 rounded-xl p-4 hover:border-purple-500/30 transition-colors",children:e.jsxs("div",{className:"flex gap-4",children:[h?e.jsx("img",{src:h,alt:r.name,className:"w-16 h-16 rounded-lg object-cover flex-shrink-0",onError:x=>{x.target.style.display="none";const N=x.target.nextElementSibling;N&&(N.style.display="flex")}}):null,e.jsx("div",{className:`w-16 h-16 rounded-lg bg-gradient-to-br from-purple-500/20 to-pink-500/20 flex items-center justify-center flex-shrink-0 ${h?"hidden":""}`,children:e.jsx(pe,{className:"w-8 h-8 text-purple-400/50"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-primary truncate",children:r.name}),o&&e.jsx("span",{className:"px-2 py-0.5 bg-purple-500/20 text-purple-400 text-xs rounded-full flex-shrink-0",children:"æ’­æ”¾ä¸­"})]}),e.jsx("p",{className:"text-sm text-text-secondary truncate mb-2",children:r.artist["#text"]}),e.jsx("p",{className:"text-xs text-text-secondary",children:Ut(r.date)})]})]})},`${r.artist["#text"]}-${r.name}-${l}`)})}),F==="recent"&&A.length>ue&&(A.length-ue<=10?(ue<A.length&&setTimeout(()=>ye(A.length),0),null):e.jsx("div",{className:"flex justify-center pt-4",children:e.jsxs("button",{onClick:()=>ye(l=>l+50),className:"px-6 py-3 bg-primary/20 border border-primary/30 text-primary rounded-lg hover:bg-primary/30 transition-colors font-medium",children:["è¼‰å…¥æ›´å¤šï¼ˆé¡¯ç¤º ",ue," / ",A.length,"ï¼‰"]})})),F==="recent"&&Gt&&ue>=A.length&&e.jsx("div",{className:"flex justify-center pt-4",children:e.jsx("button",{onClick:async()=>{var r,l;pt(!0);try{const o=Math.ceil(A.length/200)+1,h=await At(200,o),g=((r=h==null?void 0:h.recenttracks)==null?void 0:r.track)||[],f=Array.isArray(g)?g:[g].filter(Boolean);if(f.length>0){k(c=>[...c,...f]),ye(c=>c+f.length);const p=(l=h==null?void 0:h.recenttracks)==null?void 0:l["@attr"];if(p){const c=parseInt(p.totalPages||"1",10),d=parseInt(p.page||"1",10);ve(d<c)}else ve(f.length>=200)}else ve(!1)}catch(o){console.error("è¼‰å…¥æ›´å¤šæ’­æ”¾è¨˜éŒ„å¤±æ•—:",o)}finally{pt(!1)}},disabled:ft,className:"px-6 py-3 bg-primary/20 border border-primary/30 text-primary rounded-lg hover:bg-primary/30 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:ft?e.jsxs(e.Fragment,{children:[e.jsx(tt,{className:"w-5 h-5 animate-spin"}),"è¼‰å…¥ä¸­..."]}):"è¼‰å…¥æ›´å¤šè¨˜éŒ„"})})]}),F==="artists"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:P.map((r,l)=>{var h,g,f,p,c,d;l===0&&(console.log("=== è—è¡“å®¶é¡¯ç¤ºèª¿è©¦ ==="),console.log("Artist:",r.name),console.log("Artist image data:",r.image),console.log("Is array:",Array.isArray(r.image)));let o=null;return r.image&&Array.isArray(r.image)&&(o=((h=r.image.find(i=>i&&i.size==="extralarge"&&i["#text"]&&i["#text"]!==""))==null?void 0:h["#text"])||((g=r.image.find(i=>i&&i.size==="large"&&i["#text"]&&i["#text"]!==""))==null?void 0:g["#text"])||((f=r.image.find(i=>i&&i.size==="medium"&&i["#text"]&&i["#text"]!==""))==null?void 0:f["#text"])||((p=r.image.find(i=>i&&i.size==="small"&&i["#text"]&&i["#text"]!==""))==null?void 0:p["#text"])||((c=r.image.find(i=>i&&i.size==="mega"&&i["#text"]&&i["#text"]!==""))==null?void 0:c["#text"])||((d=r.image.find(i=>i&&i["#text"]&&i["#text"]!==""))==null?void 0:d["#text"])),l===0&&console.log("Found image URL:",o),o&&(o.includes("2a96cbd8b46e442fc41c2b86b821562f")||o.includes("default")||o.includes("placeholder"))&&(l===0&&console.log("âŒ åœ–ç‰‡è¢«éæ¿¾ï¼ˆæ˜¯ä½”ä½ç¬¦ï¼‰"),o=null),l===0&&console.log("Final image URL:",o),e.jsx("div",{className:"bg-surface/40 backdrop-blur-md border border-white/10 rounded-xl p-4 hover:border-purple-500/30 transition-colors",children:e.jsxs("div",{className:"flex gap-4",children:[o?e.jsx("img",{src:o,alt:r.name,className:"w-16 h-16 rounded-lg object-cover flex-shrink-0",onError:i=>{i.target.style.display="none";const x=i.target.nextElementSibling;x&&(x.style.display="flex")}}):null,e.jsx("div",{className:`w-16 h-16 rounded-lg bg-gradient-to-br from-purple-500/20 to-pink-500/20 flex items-center justify-center flex-shrink-0 ${o?"hidden":""}`,children:e.jsx(pe,{className:"w-8 h-8 text-purple-400/50"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("span",{className:"text-xs text-text-secondary w-6",children:["#",l+1]}),e.jsx("h3",{className:"font-semibold text-primary truncate",children:r.name})]}),e.jsxs("p",{className:"text-sm text-text-secondary",children:[J(r.playcount)," æ¬¡æ’­æ”¾"]})]})]})},r.mbid||r.name||l)})}),F==="tracks"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:q.map((r,l)=>{var h,g,f,p,c,d,i,x,N,w;let o=null;if(r.image&&Array.isArray(r.image)){const v=je(r.image);o=((h=v.find(S=>S.size==="large"))==null?void 0:h["#text"])||((g=v.find(S=>S.size==="extralarge"))==null?void 0:g["#text"])||((f=v.find(S=>S.size==="medium"))==null?void 0:f["#text"])||((p=v.find(S=>S.size==="small"))==null?void 0:p["#text"])||((c=v[0])==null?void 0:c["#text"])}if(!o&&((d=r.album)!=null&&d.image)){const v=Array.isArray(r.album.image)?r.album.image:[r.album.image],S=je(v);o=((i=S.find(Z=>Z.size==="large"))==null?void 0:i["#text"])||((x=S.find(Z=>Z.size==="extralarge"))==null?void 0:x["#text"])||((N=S.find(Z=>Z.size==="medium"))==null?void 0:N["#text"])||((w=S[0])==null?void 0:w["#text"])}return e.jsx("div",{className:"bg-surface/40 backdrop-blur-md border border-white/10 rounded-xl p-4 hover:border-purple-500/30 transition-colors",children:e.jsxs("div",{className:"flex gap-4",children:[o?e.jsx("img",{src:o,alt:r.name,className:"w-16 h-16 rounded-lg object-cover flex-shrink-0",onError:v=>{v.target.style.display="none";const S=v.target.nextElementSibling;S&&(S.style.display="flex")}}):null,e.jsx("div",{className:`w-16 h-16 rounded-lg bg-gradient-to-br from-blue-500/20 to-cyan-500/20 flex items-center justify-center flex-shrink-0 ${o?"hidden":""}`,children:e.jsx(pe,{className:"w-8 h-8 text-blue-400/50"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("span",{className:"text-xs text-text-secondary w-6",children:["#",l+1]}),e.jsx("h3",{className:"font-semibold text-primary truncate",children:r.name})]}),e.jsx("p",{className:"text-sm text-text-secondary truncate mb-1",children:r.artist.name}),e.jsxs("p",{className:"text-xs text-text-secondary",children:[J(r.playcount)," æ¬¡æ’­æ”¾"]})]})]})},r.mbid||`${r.artist.name}-${r.name}`||l)})}),F==="albums"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:U.map((r,l)=>{var h,g,f,p,c;let o=null;return r.image&&Array.isArray(r.image)&&(o=((h=r.image.find(d=>d&&d.size==="large"&&d["#text"]&&d["#text"]!==""))==null?void 0:h["#text"])||((g=r.image.find(d=>d&&d.size==="extralarge"&&d["#text"]&&d["#text"]!==""))==null?void 0:g["#text"])||((f=r.image.find(d=>d&&d.size==="medium"&&d["#text"]&&d["#text"]!==""))==null?void 0:f["#text"])||((p=r.image.find(d=>d&&d.size==="small"&&d["#text"]&&d["#text"]!==""))==null?void 0:p["#text"])||((c=r.image.find(d=>d&&d["#text"]&&d["#text"]!==""))==null?void 0:c["#text"])),o&&(o.includes("2a96cbd8b46e442fc41c2b86b821562f")||o.includes("default")||o.includes("placeholder"))&&(o=null),e.jsx("div",{className:"bg-surface/40 backdrop-blur-md border border-white/10 rounded-xl p-4 hover:border-purple-500/30 transition-colors",children:e.jsxs("div",{className:"flex gap-4",children:[o?e.jsx("img",{src:o,alt:r.name,className:"w-16 h-16 rounded-lg object-cover flex-shrink-0",onError:d=>{d.target.style.display="none";const i=d.target.nextElementSibling;i&&(i.style.display="flex")}}):null,e.jsx("div",{className:`w-16 h-16 rounded-lg bg-gradient-to-br from-green-500/20 to-emerald-500/20 flex items-center justify-center flex-shrink-0 ${o?"hidden":""}`,children:e.jsx(pe,{className:"w-8 h-8 text-green-400/50"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("span",{className:"text-xs text-text-secondary w-6",children:["#",l+1]}),e.jsx("h3",{className:"font-semibold text-primary truncate",children:r.name})]}),e.jsx("p",{className:"text-sm text-text-secondary truncate mb-1",children:r.artist.name}),e.jsxs("p",{className:"text-xs text-text-secondary",children:[J(r.playcount)," æ¬¡æ’­æ”¾"]})]})]})},r.mbid||`${r.artist.name}-${r.name}`||l)})}),F==="stats"&&e.jsxs("div",{className:"space-y-8",children:[(Q.length>0||(m==null?void 0:m.playcount))&&e.jsx("div",{className:"bg-gradient-to-br from-pink-500/20 to-rose-500/20 rounded-xl border border-pink-500/30 overflow-hidden",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Scrobbles"}),e.jsxs("div",{className:"flex items-center gap-1 bg-white/10 rounded-lg p-1 border border-white/20",children:[e.jsx("button",{onClick:()=>Le("7days"),className:`px-3 py-1.5 text-xs font-medium rounded-md transition-all ${I==="7days"?"bg-white/20 text-white shadow-sm":"text-pink-200/70 hover:text-white hover:bg-white/5"}`,children:"7 å¤©"}),e.jsx("button",{onClick:()=>Le("30days"),className:`px-3 py-1.5 text-xs font-medium rounded-md transition-all ${I==="30days"?"bg-white/20 text-white shadow-sm":"text-pink-200/70 hover:text-white hover:bg-white/5"}`,children:"30 å¤©"}),e.jsx("button",{onClick:()=>Le("total"),className:`px-3 py-1.5 text-xs font-medium rounded-md transition-all ${I==="total"?"bg-white/20 text-white shadow-sm":"text-pink-200/70 hover:text-white hover:bg-white/5"}`,children:"ç¸½è¨ˆ"})]})]}),e.jsx("div",{className:"text-6xl font-bold text-white mb-2",children:I==="total"?J((m==null?void 0:m.playcount)||0):Se}),e.jsx("div",{className:"text-pink-300 text-sm",children:I==="7days"?"æœ€è¿‘ 7 å¤©":I==="30days"?"æœ€è¿‘ 30 å¤©":"ç¸½æ’­æ”¾æ¬¡æ•¸"})]}),(I==="7days"||I==="30days")&&Q.length>0&&e.jsx("div",{className:"w-64 h-32",children:e.jsx(St,{width:"100%",height:"100%",children:e.jsxs(Ua,{data:Ht,margin:{top:5,right:5,left:5,bottom:5},children:[e.jsx(Ha,{dataKey:"count",fill:"#ec4899",radius:[4,4,0,0],minPointSize:2}),e.jsx(Ya,{dataKey:"day",tick:{fill:"#fff",fontSize:I==="30days"?7:9},axisLine:!1,tickLine:!1,interval:I==="30days"?4:0}),e.jsx(Ja,{hide:!0,domain:[0,"auto"],allowDecimals:!1})]})})}),I==="total"&&e.jsx("div",{className:"w-64 h-32 flex items-center justify-center",children:e.jsx("div",{className:"text-6xl opacity-20",children:"ğŸµ"})})]})})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"TOP MUSIC"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx("div",{className:"bg-purple-500/30 rounded-xl border border-purple-500/40 p-5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm text-purple-200 mb-2 font-medium",children:"Artists"}),e.jsx("div",{className:"text-4xl font-bold text-white mb-2",children:W.artists}),W.artistsChange!==null&&e.jsxs("div",{className:`text-sm font-semibold ${W.artistsChange>=0?"text-green-400":"text-red-400"}`,children:[W.artistsChange>=0?"â†‘":"â†“",Math.abs(W.artistsChange),"%"]})]}),e.jsx("div",{className:"w-12 h-12 flex items-end justify-center",children:e.jsxs("div",{className:"flex gap-0.5 items-end h-full",children:[e.jsx("div",{className:"w-2 bg-purple-300 rounded-t",style:{height:"60%"}}),e.jsx("div",{className:"w-2 bg-purple-300 rounded-t",style:{height:"85%"}}),e.jsx("div",{className:"w-2 bg-purple-300 rounded-t",style:{height:"45%"}})]})})]})}),e.jsx("div",{className:"bg-teal-500/30 rounded-xl border border-teal-500/40 p-5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm text-teal-200 mb-2 font-medium",children:"Albums"}),e.jsx("div",{className:"text-4xl font-bold text-white mb-2",children:W.albums}),W.albumsChange!==null&&e.jsxs("div",{className:`text-sm font-semibold ${W.albumsChange>=0?"text-green-400":"text-red-400"}`,children:[W.albumsChange>=0?"â†‘":"â†“",Math.abs(W.albumsChange),"%"]})]}),e.jsx("div",{className:"w-12 h-12 flex items-end justify-center",children:e.jsxs("div",{className:"flex gap-0.5 items-end h-full",children:[e.jsx("div",{className:"w-2 bg-teal-300 rounded-t",style:{height:"70%"}}),e.jsx("div",{className:"w-2 bg-teal-300 rounded-t",style:{height:"50%"}}),e.jsx("div",{className:"w-2 bg-teal-300 rounded-t",style:{height:"90%"}})]})})]})}),e.jsx("div",{className:"bg-blue-500/30 rounded-xl border border-blue-500/40 p-5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm text-blue-200 mb-2 font-medium",children:"Tracks"}),e.jsx("div",{className:"text-4xl font-bold text-white mb-2",children:W.tracks}),W.tracksChange!==null&&e.jsxs("div",{className:`text-sm font-semibold ${W.tracksChange>=0?"text-green-400":"text-red-400"}`,children:[W.tracksChange>=0?"â†‘":"â†“",Math.abs(W.tracksChange),"%"]})]}),e.jsx("div",{className:"w-12 h-12 flex items-end justify-center",children:e.jsxs("div",{className:"flex gap-0.5 items-end h-full",children:[e.jsx("div",{className:"w-2 bg-blue-300 rounded-t",style:{height:"55%"}}),e.jsx("div",{className:"w-2 bg-blue-300 rounded-t",style:{height:"75%"}}),e.jsx("div",{className:"w-2 bg-blue-300 rounded-t",style:{height:"40%"}})]})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(()=>{var h,g,f,p,c,d;const r=I==="7days"?K:I==="30days"?E:le;if(r.length===0)return null;const l=r[0],o=((g=(h=l.image)==null?void 0:h.find(i=>i.size==="large"))==null?void 0:g["#text"])||((p=(f=l.image)==null?void 0:f.find(i=>i.size==="extralarge"))==null?void 0:p["#text"])||((d=(c=l.image)==null?void 0:c[3])==null?void 0:d["#text"]);return e.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 overflow-hidden",children:[e.jsxs("div",{className:"relative w-full h-48",children:[o?e.jsx("img",{src:o,alt:l.name,className:"w-full h-48 object-cover",onError:i=>{i.target.style.display="none"}}):e.jsx("div",{className:"w-full h-48 bg-gradient-to-br from-purple-500/20 to-pink-500/20"}),e.jsx("div",{className:"absolute bottom-0 left-0 bg-purple-500/90 px-3 py-1.5 rounded-tr-lg",children:e.jsx("span",{className:"text-xs font-bold text-white uppercase tracking-wide",children:"Top Artist"})})]}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"text-xl font-bold text-white mb-1",children:["#1 ",l.name]}),e.jsxs("div",{className:"text-sm text-gray-400 mb-5",children:[J(l.playcount)," scrobbles"]}),e.jsx("div",{className:"space-y-1.5",children:r.slice(1,5).map((i,x)=>e.jsxs("div",{className:"text-sm text-gray-300",children:["#",x+2," ",i.name," ",J(i.playcount)]},i.mbid||i.name||x))})]})]})})(),(()=>{var h,g,f,p,c,d,i,x;const r=I==="7days"?C:I==="30days"?_:ie;if(r.length===0)return null;const l=r[0],o=((g=(h=l.image)==null?void 0:h.find(N=>N.size==="large"))==null?void 0:g["#text"])||((p=(f=l.image)==null?void 0:f.find(N=>N.size==="extralarge"))==null?void 0:p["#text"])||((d=(c=l.image)==null?void 0:c[3])==null?void 0:d["#text"]);return e.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 overflow-hidden",children:[e.jsxs("div",{className:"relative w-full h-48",children:[o?e.jsx("img",{src:o,alt:l.name,className:"w-full h-48 object-cover",onError:N=>{N.target.style.display="none"}}):e.jsx("div",{className:"w-full h-48 bg-gradient-to-br from-green-500/20 to-emerald-500/20"}),e.jsx("div",{className:"absolute bottom-0 left-0 bg-green-500/90 px-3 py-1.5 rounded-tr-lg",children:e.jsx("span",{className:"text-xs font-bold text-white uppercase tracking-wide",children:"Top Album"})})]}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"text-xl font-bold text-white mb-1",children:["#1 ",l.name]}),e.jsxs("div",{className:"text-sm text-gray-400 mb-5",children:[((i=l.artist)==null?void 0:i.name)||((x=l.artist)==null?void 0:x["#text"])," â€¢ ",J(l.playcount)," scrobbles"]}),e.jsx("div",{className:"space-y-1.5",children:r.slice(1,5).map((N,w)=>{var v;return e.jsxs("div",{className:"text-sm text-gray-300",children:["#",w+2," ",N.name," ",J(N.playcount)]},N.mbid||`${((v=N.artist)==null?void 0:v.name)||""}-${N.name}`||w)})})]})]})})(),(()=>{var g,f,p,c,d,i,x,N;const r=I==="7days"?R:I==="30days"?te:_e,l=Array.isArray(r)?r:[r].filter(Boolean);if(l.length===0)return null;const o=l[0],h=((f=(g=o.image)==null?void 0:g.find(w=>w.size==="large"))==null?void 0:f["#text"])||((c=(p=o.image)==null?void 0:p.find(w=>w.size==="extralarge"))==null?void 0:c["#text"])||((i=(d=o.image)==null?void 0:d[3])==null?void 0:i["#text"]);return e.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 overflow-hidden",children:[e.jsxs("div",{className:"relative w-full h-48",children:[h?e.jsx("img",{src:h,alt:o.name,className:"w-full h-48 object-cover",onError:w=>{w.target.style.display="none";const v=w.target.nextElementSibling;v&&(v.style.display="flex")}}):null,e.jsx("div",{className:`w-full h-48 bg-gradient-to-br from-blue-500/20 to-purple-500/20 ${h?"hidden":"flex"} items-center justify-center`,children:e.jsx(pe,{className:"w-24 h-24 text-blue-400/50"})}),e.jsx("div",{className:"absolute bottom-0 left-0 bg-blue-500/90 px-3 py-1.5 rounded-tr-lg",children:e.jsx("span",{className:"text-xs font-bold text-white uppercase tracking-wide",children:"Top Track"})})]}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"text-xl font-bold text-white mb-1",children:["#1 ",o.name]}),e.jsxs("div",{className:"text-sm text-gray-400 mb-5",children:[((x=o.artist)==null?void 0:x.name)||((N=o.artist)==null?void 0:N["#text"])||"Unknown Artist"," â€¢ ",J(o.playcount)," scrobbles"]}),e.jsx("div",{className:"space-y-1.5",children:l.slice(1,5).map((w,v)=>{var S,Z;return e.jsxs("div",{className:"text-sm text-gray-300",children:["#",v+2," ",w.name," ",J(w.playcount)]},w.mbid||`${((S=w.artist)==null?void 0:S.name)||((Z=w.artist)==null?void 0:Z["#text"])}-${w.name}`||v)})})]})]})})()]})]}),gt.length>0&&me&&e.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Listening Clock"}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-400",children:"Busiest hour"}),e.jsxs("div",{className:"text-lg font-bold text-white",children:[me.hour.toString().padStart(2,"0"),":00 (",me.count," scrobbles)"]})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(St,{width:"100%",height:400,children:e.jsxs(Hs,{cx:"50%",cy:"50%",innerRadius:"30%",outerRadius:"90%",data:gt,startAngle:90,endAngle:-270,children:[e.jsx(rs,{type:"number",domain:[0,23],angleAxisId:0,tick:!1}),e.jsx(ht,{dataKey:"count",cornerRadius:4,fill:"#06b6d4"}),e.jsx(qa,{formatter:r=>[`${r} scrobbles`],labelFormatter:r=>`${r.toString().padStart(2,"0")}:00`,contentStyle:{backgroundColor:"#1a1a1a",border:"1px solid #ffffff20",borderRadius:"8px",color:"#fff"}})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[Se>0&&e.jsxs("div",{className:"bg-white/5 rounded-lg border border-white/10 p-6",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"ç¸½æ’­æ”¾æ¬¡æ•¸"}),e.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:Se}),e.jsx("div",{className:"text-xs text-gray-500",children:"æœ€è¿‘ 7 å¤©"})]}),Q.length>0&&e.jsxs("div",{className:"bg-white/5 rounded-lg border border-white/10 p-6",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"å¹³å‡æ¯æ—¥æ’­æ”¾"}),e.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:Math.round(Se/Q.length)}),e.jsx("div",{className:"text-xs text-gray-500",children:"æ¬¡/å¤©"})]}),me&&e.jsxs("div",{className:"bg-white/5 rounded-lg border border-white/10 p-6",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"æœ€æ´»èºæ™‚æ®µ"}),e.jsxs("div",{className:"text-3xl font-bold text-white mb-1",children:[me.hour.toString().padStart(2,"0"),":00"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[me.count," scrobbles"]})]})]}),Q.length===0&&P.length===0&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-text-secondary",children:"æ²’æœ‰è¶³å¤ çš„æ•¸æ“šä¾†é¡¯ç¤ºçµ±è¨ˆ"})})]}),F==="recent"&&A.length===0&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-text-secondary",children:"æ²’æœ‰æœ€è¿‘çš„æ’­æ”¾è¨˜éŒ„"})}),F==="artists"&&P.length===0&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-text-secondary",children:"æ²’æœ‰è—è¡“å®¶è³‡æ–™"})}),F==="albums"&&U.length===0&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-text-secondary",children:"æ²’æœ‰å°ˆè¼¯è³‡æ–™"})}),F==="tracks"&&q.length===0&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-text-secondary",children:"æ²’æœ‰æ­Œæ›²è³‡æ–™"})})]})})}export{qs as default};
