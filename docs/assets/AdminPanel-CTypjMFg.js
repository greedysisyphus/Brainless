const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CMqf4Yce.js","assets/index-BUSimLPm.css"])))=>i.map(i=>d[i]);
import{j as e,r as x,g as te,f as Fe,c as Re,p as Se,a as ae,d as V,b as P,e as Ee,h as qe,v as Ie,i as Le,k as Ae,l as Oe,u as _e,m as de,n as Pe,o as We,_ as Be,s as He,q as Ve}from"./index-CMqf4Yce.js";const Ue=({children:c,className:o="",maxWidth:h="container-custom",padding:f="py-4 sm:py-6 lg:py-8",center:r=!0})=>e.jsx("div",{className:`${h} ${f} ${r?"mx-auto":""} ${o}`,children:c}),Xe=({children:c,className:o="",padding:h="p-4 sm:p-6",hover:f=!0})=>e.jsx("div",{className:`
      bg-surface rounded-xl shadow-lg border border-white/5 
      ${h} 
      ${f?"hover:shadow-xl hover:border-white/10 transition-all duration-200":""} 
      ${o}
    `,children:c}),y=({children:c,onClick:o,variant:h="primary",size:f="md",disabled:r=!1,loading:k=!1,className:b="",...$})=>{const q=()=>{switch(h){case"primary":return"bg-primary text-white hover:bg-primary/80 disabled:bg-primary/50";case"secondary":return"bg-white/10 text-white hover:bg-white/20 disabled:bg-white/5";case"danger":return"bg-red-500/20 text-red-400 hover:bg-red-500/30 border border-red-500/30 disabled:bg-red-500/10";case"ghost":return"text-text-secondary hover:text-text-primary hover:bg-white/5 disabled:text-gray-500";default:return"bg-primary text-white hover:bg-primary/80 disabled:bg-primary/50"}},I=()=>{switch(f){case"sm":return"px-3 py-2 text-sm";case"md":return"px-4 py-2";case"lg":return"px-6 py-3 text-lg";default:return"px-4 py-2"}};return e.jsx("button",{onClick:o,disabled:r||k,className:`
        ${q()}
        ${I()}
        rounded-lg transition-all duration-200
        disabled:opacity-50 disabled:cursor-not-allowed
        focus:outline-none focus:ring-2 focus:ring-primary/50
        ${b}
      `,...$,children:k?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}),"è¼‰å…¥ä¸­..."]}):c})},D=({value:c,onChange:o,placeholder:h="",type:f="text",disabled:r=!1,error:k=!1,className:b="",...$})=>e.jsx("input",{type:f,value:c,onChange:o,placeholder:h,disabled:r,className:`
        w-full p-3 sm:p-4
        bg-white/10 border rounded-lg
        text-white placeholder-gray-400
        focus:outline-none focus:ring-2 focus:ring-primary/50
        disabled:opacity-50 disabled:cursor-not-allowed
        ${k?"border-red-500/50 focus:ring-red-500/50":"border-white/20"}
        ${b}
      `,...$}),m=({children:c,htmlFor:o,className:h="",required:f=!1})=>e.jsx("label",{htmlFor:o,className:`
        block text-sm sm:text-base text-white mb-2
        ${f?'after:content-["*"] after:text-red-400 after:ml-1':""}
        ${h}
      `,children:c}),C=({children:c,level:o=1,className:h="",gradient:f=!1})=>{const r=()=>{switch(o){case 1:return"text-2xl sm:text-3xl lg:text-4xl";case 2:return"text-xl sm:text-2xl lg:text-3xl";case 3:return"text-lg sm:text-xl lg:text-2xl";case 4:return"text-base sm:text-lg lg:text-xl";case 5:return"text-sm sm:text-base lg:text-lg";case 6:return"text-xs sm:text-sm lg:text-base";default:return"text-xl sm:text-2xl lg:text-3xl"}},k=()=>f?"bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent":"text-white",b=`h${o}`;return e.jsx(b,{className:`font-bold ${r()} ${k()} ${h}`,children:c})},l=({children:c,size:o="base",color:h="white",className:f="",...r})=>{const k=()=>{switch(o){case"xs":return"text-xs";case"sm":return"text-sm";case"base":return"text-base";case"lg":return"text-lg";case"xl":return"text-xl";default:return"text-base"}},b=()=>{switch(h){case"white":return"text-white";case"secondary":return"text-text-secondary";case"primary":return"text-primary";case"danger":return"text-red-400";case"success":return"text-green-400";default:return"text-white"}};return e.jsx("p",{className:`${k()} ${b()} ${f}`,...r,children:c})},Ge=({customRules:c=[],scheduleTemplates:o=[],onRulesChange:h,onTemplatesChange:f,isSaving:r=!1,scheduleData:k=null,speechTexts:b=[],onSpeechTextsChange:$,showBubble:q=!1,onShowBubbleChange:I,intervalSeconds:U=4,onIntervalSecondsChange:X,smartMode:G=!1,onSmartModeChange:F})=>{const[Y,R]=x.useState(!1),[L,Q]=x.useState(null),[z,K]=x.useState("custom"),[M,Z]=x.useState(!1),[n,E]=x.useState({name:"",type:"timeRange",startTime:"08:00",endTime:"10:00",day:"ä¸€",month:1,date:1,allDay:!1,messages:[""],enabled:!0}),[g,ee]=x.useState(null),[v,re]=x.useState({}),[J,u]=x.useState(!1),[p,j]=x.useState(!1);x.useEffect(()=>{k?ee(k):(async()=>{try{u(!0);const a=await ae(V(P,"schedule","currentMonth")),t=await ae(V(P,"schedule","nextMonth"));let i=null;a.exists()?i=a.data():t.exists()&&(i=t.data()),ee(i)}catch(a){console.error("è¼‰å…¥ç­è¡¨è³‡æ–™å¤±æ•—:",a)}finally{u(!1)}})()},[k]),x.useEffect(()=>{(async()=>{try{j(!0);const a=await Ee(qe(P,"names")),t={};a.forEach(i=>{const N=i.data();N.name&&(t[i.id]=N.name)}),re(t)}catch(a){console.error("è¼‰å…¥åŒäº‹å§“åè³‡æ–™å¤±æ•—:",a)}finally{j(!1)}})()},[]);const W=s=>{if(!s||typeof s!="object")return[];const a=[],t=new Date,i=t.getFullYear(),N=t.getMonth()+1,w=t.getDate();for(const[d,A]of Object.entries(s))if(d!=="_lastUpdated"&&A&&typeof A=="object"){for(const[ie,O]of Object.entries(A))if(O&&O.trim()&&O!=="ä¼‘å‡"&&O!=="ç‰¹ä¼‘"&&O!=="æœˆä¼‘"){const _=parseInt(ie);_===w&&a.push({id:`${d}_${_}`,date:`${i}-${String(N).padStart(2,"0")}-${String(_).padStart(2,"0")}`,shift:O,employee:d})}}return a},[S,le]=x.useState({name:"",message:"",enabled:!0,timeRestriction:!1,startTime:"08:00",endTime:"10:00"}),[B,ce]=x.useState(null),[se,oe]=x.useState(""),me=async()=>{if(se.trim()&&$){const s=[...b,se.trim()];try{await $(s),oe("")}catch(a){console.error("æ·»åŠ å°è©±å¤±æ•—:",a)}}},ue=async s=>{if($){const a=b.filter((t,i)=>i!==s);try{await $(a)}catch(t){console.error("åˆªé™¤å°è©±å¤±æ•—:",t)}}},xe=()=>{le({name:"",message:"",enabled:!0,timeRestriction:!1,startTime:"08:00",endTime:"10:00"}),ce(null),R(!1)},H=(s,a)=>{le(t=>({...t,[s]:a}))},be=(s,a)=>{const t=new Date,i=t.getHours(),N=t.getMinutes(),w=i*60+N,[d,A]=s.split(":").map(Number),[ie,O]=a.split(":").map(Number),_=d*60+A,ne=ie*60+O;return ne<_?w>=_||w<=ne:w>=_&&w<=ne},he=()=>{E({name:"",type:"timeRange",startTime:"08:00",endTime:"10:00",day:"ä¸€",month:1,date:1,allDay:!1,messages:[""],enabled:!0}),Q(null),R(!1)},T=(s,a)=>{E(t=>({...t,[s]:a}))},ge=(s,a)=>{const t=[...n.messages];t[s]=a,E(i=>({...i,messages:t}))},je=()=>{E(s=>({...s,messages:[...s.messages,""]}))},pe=s=>{if(n.messages.length>1){const a=n.messages.filter((t,i)=>i!==s);E(t=>({...t,messages:a}))}},ye=()=>{if(!n.name.trim()){alert("è«‹å¡«å¯«è¦å‰‡åç¨±");return}const s=n.messages.filter(i=>i&&typeof i=="string"&&i.trim()!=="");if(s.length===0){alert("è«‹è‡³å°‘æ·»åŠ ä¸€å€‹å°è©±å…§å®¹");return}const a={id:L?L.id:Date.now().toString(),...n,messages:s};if(!Ie(a)){alert("è¦å‰‡è¨­å®šæœ‰èª¤ï¼Œè«‹æª¢æŸ¥æ™‚é–“æ ¼å¼");return}let t;L?t=c.map(i=>i.id===L.id?a:i):t=[...c,a],h(t),he()},fe=s=>{if(window.confirm("ç¢ºå®šè¦åˆªé™¤é€™å€‹è¦å‰‡å—Žï¼Ÿ")){const a=c.filter(t=>t.id!==s);h(a)}},Ne=s=>{const a=c.map(t=>t.id===s?{...t,enabled:!t.enabled}:t);h(a)},ve=s=>{E({name:s.name,type:s.type,startTime:s.startTime||"08:00",endTime:s.endTime||"10:00",day:s.day||"ä¸€",month:s.month||1,date:s.date||1,allDay:s.allDay||!1,messages:s.messages||[""],enabled:s.enabled}),Q(s),R(!0)},we=()=>{window.confirm("ç¢ºå®šè¦è¼‰å…¥é è¨­è¦å‰‡å—Žï¼Ÿé€™æœƒè¦†è“‹ç¾æœ‰çš„è‡ªå®šç¾©è¦å‰‡ã€‚")&&h(Le())},Te=()=>{if(!S.name.trim()){alert("è«‹å¡«å¯«æ¨¡æ¿åç¨±");return}if(!S.message.trim()){alert("è«‹å¡«å¯«å•å€™èªžå…§å®¹");return}const s={id:B?B.id:Date.now().toString(),...S};if(!Ae(s)){alert("æ¨¡æ¿è¨­å®šæœ‰èª¤ï¼Œè«‹æª¢æŸ¥å…§å®¹");return}let a;B?a=o.map(t=>t.id===B.id?s:t):a=[...o,s],f(a),xe()},De=s=>{if(window.confirm("ç¢ºå®šè¦åˆªé™¤é€™å€‹æ¨¡æ¿å—Žï¼Ÿ")){const a=o.filter(t=>t.id!==s);f(a)}},ke=s=>{const a=o.map(t=>t.id===s?{...t,enabled:!t.enabled}:t);f(a)},ze=s=>{le({name:s.name,message:s.message,enabled:s.enabled,timeRestriction:s.timeRestriction||!1,startTime:s.startTime||"08:00",endTime:s.endTime||"10:00"}),ce(s),R(!0)},Ce=()=>{const s=Oe();f(s)},$e=()=>{if(J){alert("è«‹ç¨å€™ï¼Œæ­£åœ¨è¼‰å…¥ç­è¡¨è³‡æ–™...");return}if(p){alert("è«‹ç¨å€™ï¼Œæ­£åœ¨è¼‰å…¥å§“åè³‡æ–™...");return}if(!g){alert("ç„¡ç­è¡¨è³‡æ–™ï¼Œç„¡æ³•é è¦½æ‰€æœ‰æ™ºèƒ½å°è©±ã€‚");return}Object.keys(v).length===0&&alert("ç„¡å§“åè³‡æ–™ï¼Œå°‡é¡¯ç¤ºè·å“¡ç·¨è™Ÿã€‚");const s=te(g,c,o,v),a=s.map((t,i)=>`${i+1}. [${t.source}] ${t.message}`).join(`

`);s.length===0?alert(`ç›®å‰æ²’æœ‰è§¸ç™¼çš„æ™ºèƒ½å°è©±ã€‚

åªæœƒæ’­æ”¾æ‚¨è¨­å®šçš„æ™®é€šå°è©±ã€‚`):alert(`æ™ºèƒ½å°è©±é è¦½ (å…±${s.length}æ¢)ï¼š

${a}

æ³¨æ„ï¼šé€™äº›å°è©±æœƒèˆ‡æ‚¨è¨­å®šçš„æ™®é€šå°è©±ä¸€èµ·è¼ªæµæ’­æ”¾ã€‚`)},Me=()=>{switch(n.type){case"timeRange":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"allDay",checked:n.allDay,onChange:s=>T("allDay",s.target.checked),disabled:r,className:"w-5 h-5 disabled:opacity-50"}),e.jsx(m,{htmlFor:"allDay",className:"!mb-0",children:"å…¨å¤©ï¼ˆ24å°æ™‚ï¼‰"})]}),!n.allDay&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"startTime",required:!0,children:"é–‹å§‹æ™‚é–“"}),e.jsx(D,{id:"startTime",type:"time",value:n.startTime,onChange:s=>T("startTime",s.target.value),disabled:r})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"endTime",required:!0,children:"çµæŸæ™‚é–“"}),e.jsx(D,{id:"endTime",type:"time",value:n.endTime,onChange:s=>T("endTime",s.target.value),disabled:r})]})]})]});case"dayOfWeek":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"daySelect",required:!0,children:"æ˜ŸæœŸå¹¾"}),e.jsxs("select",{id:"daySelect",value:n.day,onChange:s=>T("day",s.target.value),disabled:r,className:"w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary/50 disabled:opacity-50",children:[e.jsx("option",{value:"ä¸€",children:"æ˜ŸæœŸä¸€"}),e.jsx("option",{value:"äºŒ",children:"æ˜ŸæœŸäºŒ"}),e.jsx("option",{value:"ä¸‰",children:"æ˜ŸæœŸä¸‰"}),e.jsx("option",{value:"å››",children:"æ˜ŸæœŸå››"}),e.jsx("option",{value:"äº”",children:"æ˜ŸæœŸäº”"}),e.jsx("option",{value:"å…­",children:"æ˜ŸæœŸå…­"}),e.jsx("option",{value:"æ—¥",children:"æ˜ŸæœŸæ—¥"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"allDay",checked:n.allDay,onChange:s=>T("allDay",s.target.checked),disabled:r,className:"w-5 h-5 disabled:opacity-50"}),e.jsx(m,{htmlFor:"allDay",className:"!mb-0",children:"å…¨å¤©ï¼ˆ24å°æ™‚ï¼‰"})]}),!n.allDay&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"startTime",required:!0,children:"é–‹å§‹æ™‚é–“"}),e.jsx(D,{id:"startTime",type:"time",value:n.startTime,onChange:s=>T("startTime",s.target.value),disabled:r})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"endTime",required:!0,children:"çµæŸæ™‚é–“"}),e.jsx(D,{id:"endTime",type:"time",value:n.endTime,onChange:s=>T("endTime",s.target.value),disabled:r})]})]})]});case"specificDate":return e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"month",required:!0,children:"æœˆä»½"}),e.jsx(D,{id:"month",type:"number",min:"1",max:"12",value:n.month||"",onChange:s=>{const a=s.target.value,t=a===""?1:parseInt(a);T("month",isNaN(t)?1:t)},disabled:r})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"date",required:!0,children:"æ—¥æœŸ"}),e.jsx(D,{id:"date",type:"number",min:"1",max:"31",value:n.date||"",onChange:s=>{const a=s.target.value,t=a===""?1:parseInt(a);T("date",isNaN(t)?1:t)},disabled:r})]})]});case"monthlyDate":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"monthlyDate",required:!0,children:"æ¯æœˆå¹¾è™Ÿ"}),e.jsx("div",{className:"grid grid-cols-7 gap-1 bg-white/5 rounded-lg p-3 border border-white/10",children:Array.from({length:31},(s,a)=>a+1).map(s=>e.jsx("button",{type:"button",onClick:()=>T("date",s),disabled:r,className:`p-2 text-sm rounded transition-colors ${n.date===s?"bg-primary text-white":"bg-white/10 text-gray-300 hover:bg-white/20"} disabled:opacity-50`,children:s},s))})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"allDay",checked:n.allDay,onChange:s=>T("allDay",s.target.checked),disabled:r,className:"w-5 h-5 disabled:opacity-50"}),e.jsx(m,{htmlFor:"allDay",className:"!mb-0",children:"å…¨å¤©ï¼ˆ24å°æ™‚ï¼‰"})]}),!n.allDay&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"startTime",required:!0,children:"é–‹å§‹æ™‚é–“"}),e.jsx(D,{id:"startTime",type:"time",value:n.startTime,onChange:s=>T("startTime",s.target.value),disabled:r})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"endTime",required:!0,children:"çµæŸæ™‚é–“"}),e.jsx(D,{id:"endTime",type:"time",value:n.endTime,onChange:s=>T("endTime",s.target.value),disabled:r})]})]})]});default:return null}};return e.jsxs(Xe,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx(C,{level:2,gradient:!0,children:"æ™ºèƒ½å°è©±è¦å‰‡ç®¡ç†"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{onClick:$e,variant:"secondary",size:"sm",disabled:r||J||p,children:"é è¦½æ‰€æœ‰å°è©±"}),e.jsx(y,{onClick:()=>R(!0),variant:"primary",size:"sm",disabled:r,children:"æ·»åŠ è¦å‰‡"})]})]}),e.jsxs("div",{className:"bg-orange-500/10 border border-orange-500/20 rounded-lg p-4 mb-6",children:[e.jsx(C,{level:3,className:"text-orange-400 mb-4",children:"åŸºæœ¬è¨­å®š"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"bubbleToggle",checked:q,disabled:r,onChange:s=>I&&I(s.target.checked),className:"w-5 h-5 disabled:opacity-50"}),e.jsx(m,{htmlFor:"bubbleToggle",className:"!mb-0",children:"é¡¯ç¤ºå°è©±è¼ªæ’­"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"smartModeToggle",checked:G,disabled:r,onChange:()=>F&&F(!G),className:"w-5 h-5 disabled:opacity-50"}),e.jsx(m,{htmlFor:"smartModeToggle",className:"!mb-0",children:"æ™ºèƒ½æ¨¡å¼ï¼ˆæ ¹æ“šè‡ªå®šç¾©è¦å‰‡å’Œç­è¡¨å•å€™è‡ªå‹•é¡¯ç¤ºå°è©±ï¼‰"})]}),e.jsxs("div",{children:[e.jsxs(m,{htmlFor:"intervalSlider",children:["è¼ªæ’­é–“éš” (",U,"ç§’)"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"range",id:"intervalSlider",min:"1",max:"10",value:U,disabled:r,onChange:s=>X&&X(parseInt(s.target.value)),className:"flex-1 h-2 bg-white/10 rounded-lg appearance-none cursor-pointer slider disabled:opacity-50"}),e.jsxs("span",{className:"text-white min-w-[3rem] text-center",children:[U,"s"]})]}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[e.jsx("span",{children:"1ç§’"}),e.jsx("span",{children:"10ç§’"})]})]})]})]}),e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-4 mb-6",children:[e.jsx(C,{level:3,className:"text-blue-400 mb-2",children:"è³‡æ–™è¼‰å…¥ç‹€æ…‹"}),e.jsx(l,{size:"sm",className:"text-blue-300",children:J?"è¼‰å…¥ç­è¡¨ä¸­...":g?`ç­è¡¨è³‡æ–™ï¼š${Object.keys(g).filter(s=>s!=="_lastUpdated").length} ä½åŒäº‹`:"ç­è¡¨è³‡æ–™ï¼šæœªè¼‰å…¥"}),g&&g._lastUpdated&&e.jsxs(l,{size:"sm",className:"text-blue-300 mt-1",children:["æœ€å¾Œæ›´æ–°ï¼š",new Date(g._lastUpdated).toLocaleString()]}),e.jsx(l,{size:"sm",className:"text-blue-300 mt-1",children:p?"è¼‰å…¥å§“åä¸­...":Object.keys(v).length>0?`å§“åå°æ‡‰ï¼š${Object.keys(v).length} ä½åŒäº‹`:"å§“åå°æ‡‰ï¼šæœªè¼‰å…¥"})]}),e.jsxs("div",{className:"flex border-b border-white/10 mb-6",children:[e.jsxs("button",{onClick:()=>K("custom"),className:`px-4 py-2 text-sm font-medium transition-colors ${z==="custom"?"text-primary border-b-2 border-primary":"text-text-secondary hover:text-text-primary"}`,children:["è‡ªå®šç¾©è¦å‰‡ (",c.length,")"]}),e.jsxs("button",{onClick:()=>K("schedule"),className:`px-4 py-2 text-sm font-medium transition-colors ${z==="schedule"?"text-primary border-b-2 border-primary":"text-text-secondary hover:text-text-primary"}`,children:["ç­è¡¨å•å€™æ¨¡æ¿ (",o.length,")"]}),e.jsxs("button",{onClick:()=>K("dialogue"),className:`px-4 py-2 text-sm font-medium transition-colors ${z==="dialogue"?"text-primary border-b-2 border-primary":"text-text-secondary hover:text-text-primary"}`,children:["å°è©±ç®¡ç† (",b.length,")"]})]}),z==="custom"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-purple-500/10 border border-purple-500/20 rounded-lg p-4 mb-6",children:[e.jsx(C,{level:3,className:"text-purple-400 mb-2",children:"è‡ªå®šç¾©è¦å‰‡èªªæ˜Ž"}),e.jsx(l,{size:"sm",className:"text-purple-300",children:"å¯ä»¥è¨­å®šç‰¹å®šæ™‚é–“ç¯„åœã€æ˜ŸæœŸå¹¾æˆ–ç‰¹å®šæ—¥æœŸçš„å°è©±è¦å‰‡ï¼Œç³»çµ±æœƒæ ¹æ“šæ¢ä»¶è‡ªå‹•é¡¯ç¤ºå°è©±ã€‚"})]}),Y&&e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-lg p-4 mb-6",children:[e.jsx(C,{level:3,className:"mb-4",children:L?"ç·¨è¼¯è¦å‰‡":"æ·»åŠ æ–°è¦å‰‡"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"ruleName",required:!0,children:"è¦å‰‡åç¨±"}),e.jsx(D,{id:"ruleName",value:n.name,onChange:s=>T("name",s.target.value),placeholder:"ä¾‹å¦‚ï¼šæ—©ä¸Šå•å€™",disabled:r})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"ruleType",required:!0,children:"è¦å‰‡é¡žåž‹"}),e.jsxs("select",{id:"ruleType",value:n.type,onChange:s=>T("type",s.target.value),disabled:r,className:"w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary/50 disabled:opacity-50",children:[e.jsx("option",{value:"timeRange",children:"æ™‚é–“ç¯„åœ"}),e.jsx("option",{value:"dayOfWeek",children:"æ˜ŸæœŸå¹¾"}),e.jsx("option",{value:"specificDate",children:"ç‰¹å®šæ—¥æœŸ"}),e.jsx("option",{value:"monthlyDate",children:"æ¯æœˆå¹¾è™Ÿ"})]})]}),Me(),e.jsxs("div",{children:[e.jsxs(m,{required:!0,children:["å°è©±å…§å®¹ (",n.messages.length,"æ¢)"]}),e.jsxs("div",{className:"space-y-2",children:[n.messages.map((s,a)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{value:s,onChange:t=>ge(a,t.target.value),placeholder:`å°è©± ${a+1}...`,disabled:r}),e.jsx(y,{onClick:()=>pe(a),variant:"danger",size:"sm",disabled:r||n.messages.length<=1,className:"px-3",children:"åˆªé™¤"})]},a)),e.jsx(y,{onClick:je,variant:"secondary",size:"sm",disabled:r,className:"w-full",children:"æ·»åŠ å°è©±"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"ruleEnabled",checked:n.enabled,onChange:s=>T("enabled",s.target.checked),disabled:r,className:"w-5 h-5 disabled:opacity-50"}),e.jsx(m,{htmlFor:"ruleEnabled",className:"!mb-0",children:"å•Ÿç”¨æ­¤è¦å‰‡"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{onClick:ye,variant:"primary",disabled:r,loading:r,children:L?"æ›´æ–°è¦å‰‡":"æ·»åŠ è¦å‰‡"}),e.jsx(y,{onClick:he,variant:"secondary",disabled:r,children:"å–æ¶ˆ"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(m,{children:["ç¾æœ‰è¦å‰‡ (",c.length,"æ¢)"]}),e.jsx(y,{onClick:we,variant:"secondary",size:"sm",disabled:r,children:"è¼‰å…¥é è¨­"})]}),c.length===0?e.jsx(l,{color:"secondary",className:"text-center py-8",children:"æš«ç„¡è‡ªå®šç¾©è¦å‰‡"}):c.map(s=>{var a,t;return e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:s.enabled,onChange:()=>Ne(s.id),disabled:r,className:"w-4 h-4 disabled:opacity-50"}),e.jsx(C,{level:4,className:"!mb-0",children:s.name}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.enabled?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"}`,children:s.enabled?"å•Ÿç”¨":"åœç”¨"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{onClick:()=>ve(s),variant:"ghost",size:"sm",disabled:r,children:"ç·¨è¼¯"}),e.jsx(y,{onClick:()=>fe(s.id),variant:"danger",size:"sm",disabled:r,children:"åˆªé™¤"})]})]}),e.jsxs(l,{size:"sm",color:"secondary",className:"mb-2",children:["é¡žåž‹ï¼š",s.type==="timeRange"?"æ™‚é–“ç¯„åœ":s.type==="dayOfWeek"?"æ˜ŸæœŸå¹¾":s.type==="specificDate"?"ç‰¹å®šæ—¥æœŸ":s.type==="monthlyDate"?"æ¯æœˆå¹¾è™Ÿ":"æœªçŸ¥é¡žåž‹"]}),s.type==="timeRange"&&e.jsxs(l,{size:"sm",color:"secondary",className:"mb-2",children:["æ™‚é–“ï¼š",s.allDay?"å…¨å¤©":`${s.startTime} - ${s.endTime}`]}),s.type==="dayOfWeek"&&e.jsxs(l,{size:"sm",color:"secondary",className:"mb-2",children:["æ˜ŸæœŸ",s.day," ",s.allDay?"å…¨å¤©":`${s.startTime} - ${s.endTime}`]}),s.type==="specificDate"&&e.jsxs(l,{size:"sm",color:"secondary",className:"mb-2",children:[s.month,"æœˆ",s.date,"æ—¥"]}),s.type==="monthlyDate"&&e.jsxs(l,{size:"sm",color:"secondary",className:"mb-2",children:["æ¯æœˆ",s.date,"æ—¥ ",s.allDay?"å…¨å¤©":`${s.startTime} - ${s.endTime}`]}),e.jsxs(l,{size:"sm",color:"secondary",className:"mb-2",children:["å°è©±æ•¸é‡ï¼š",((a=s.messages)==null?void 0:a.length)||0," æ¢"]}),e.jsx("div",{className:"space-y-1",children:(t=s.messages)==null?void 0:t.map((i,N)=>e.jsx(l,{className:"bg-white/5 rounded p-2 text-sm",children:i},N))})]},s.id)})]})]}),z==="schedule"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(C,{level:3,className:"text-blue-400",children:"å¯ç”¨è®Šæ•¸èªªæ˜Ž"}),e.jsxs(y,{onClick:()=>Z(!M),variant:"secondary",size:"sm",className:"flex items-center gap-2",children:[M?"éš±è—èªªæ˜Ž":"é¡¯ç¤ºèªªæ˜Ž",e.jsx("span",{className:"text-xs",children:M?"â–¼":"â–¶"})]})]}),M&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[e.jsx(l,{size:"sm",className:"text-blue-300 font-bold mb-3 text-center",children:"ðŸ“‹ ç­æ¬¡è®Šæ•¸"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{size:"sm",className:"text-blue-300",children:["â€¢ ","{æ—©ç­åŒäº‹}"," - æ—©ç­åŒäº‹åå­—"]}),e.jsxs(l,{size:"sm",className:"text-blue-300",children:["â€¢ ","{ä¸­ç­åŒäº‹}"," - ä¸­ç­åŒäº‹åå­—"]}),e.jsxs(l,{size:"sm",className:"text-blue-300",children:["â€¢ ","{æ™šç­åŒäº‹}"," - æ™šç­åŒäº‹åå­—"]}),e.jsxs(l,{size:"sm",className:"text-blue-300",children:["â€¢ ","{æ‰€æœ‰åŒäº‹}"," - æ‰€æœ‰ä¸Šç­åŒäº‹åå­—"]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-white/10",children:[e.jsx(l,{size:"sm",className:"text-blue-300 font-semibold mb-2",children:"ðŸ’¡ ä½¿ç”¨ç¯„ä¾‹ï¼š"}),e.jsxs(l,{size:"sm",className:"text-blue-300",children:["â€¢ ","{æ—©ç­åŒäº‹}ï¼Œæ—©å®‰ï¼"," â†’ å°æ˜Žã€å°è¯ï¼Œæ—©å®‰ï¼"]}),e.jsxs(l,{size:"sm",className:"text-blue-300",children:["â€¢ ","{æ‰€æœ‰åŒäº‹}ï¼Œå·¥ä½œè¾›è‹¦äº†ï¼"," â†’ å°æ˜Žã€å°è¯ã€å°ç¾Žï¼Œå·¥ä½œè¾›è‹¦äº†ï¼"]})]})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[e.jsx(l,{size:"sm",className:"text-blue-300 font-bold mb-3 text-center",children:"ðŸ‘¥ äººæ•¸è®Šæ•¸"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{size:"sm",className:"text-blue-300",children:["â€¢ ","{æ—©ç­äººæ•¸}"," - æ—©ç­äººæ•¸"]}),e.jsxs(l,{size:"sm",className:"text-blue-300",children:["â€¢ ","{ä¸­ç­äººæ•¸}"," - ä¸­ç­äººæ•¸"]}),e.jsxs(l,{size:"sm",className:"text-blue-300",children:["â€¢ ","{æ™šç­äººæ•¸}"," - æ™šç­äººæ•¸"]}),e.jsxs(l,{size:"sm",className:"text-blue-300",children:["â€¢ ","{ç¸½äººæ•¸}"," - ç¸½ä¸Šç­äººæ•¸"]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-white/10",children:[e.jsx(l,{size:"sm",className:"text-blue-300 font-semibold mb-2",children:"ðŸ’¡ ä½¿ç”¨ç¯„ä¾‹ï¼š"}),e.jsxs(l,{size:"sm",className:"text-blue-300",children:["â€¢ ","ä»Šå¤©æœ‰{ç¸½äººæ•¸}ä½åŒäº‹ä¸Šç­"," â†’ ä»Šå¤©æœ‰5ä½åŒäº‹ä¸Šç­"]}),e.jsxs(l,{size:"sm",className:"text-blue-300",children:["â€¢ ","æ—©ç­{æ—©ç­äººæ•¸}äººï¼Œæ™šç­{æ™šç­äººæ•¸}äºº"," â†’ æ—©ç­2äººï¼Œæ™šç­3äºº"]})]})]})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[e.jsx(l,{size:"sm",className:"text-blue-300 font-bold mb-4 text-center",children:"â° é€£çºŒä¸Šç­è®Šæ•¸"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx(l,{size:"sm",className:"text-blue-300 font-semibold mb-2",children:"ðŸ”§ åŸºæœ¬è®Šæ•¸"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{size:"sm",className:"text-blue-300",children:["â€¢ ","{é€£çºŒä¸Šç­åŒäº‹}"," - é€£çºŒä¸Šç­4-6å¤©çš„åŒäº‹ï¼ˆé¡¯ç¤ºåå­—+å¤©æ•¸ï¼‰"]}),e.jsxs(l,{size:"sm",className:"text-blue-300",children:["â€¢ ","{é€£çºŒä¸Šç­åŒäº‹æ•¸é‡}"," - é€£çºŒä¸Šç­4-6å¤©çš„åŒäº‹æ•¸é‡"]})]})]}),e.jsxs("div",{children:[e.jsx(l,{size:"sm",className:"text-blue-300 font-semibold mb-2",children:"ðŸŽ¯ æŒ‡å®šå¤©æ•¸è®Šæ•¸"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{size:"sm",className:"text-blue-300",children:["â€¢ ","{é€£çºŒä¸Šç­Xå¤©åŒäº‹}"," - æŒ‡å®šå¤©æ•¸çš„åŒäº‹åå­—ï¼ˆXç‚ºæ•¸å­—ï¼Œåªé¡¯ç¤ºåå­—ï¼‰"]}),e.jsxs(l,{size:"sm",className:"text-blue-300",children:["â€¢ ","{é€£çºŒä¸Šç­Xå¤©åŒäº‹æ•¸é‡}"," - æŒ‡å®šå¤©æ•¸çš„åŒäº‹æ•¸é‡"]})]})]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-white/10",children:[e.jsx(l,{size:"sm",className:"text-blue-300 font-semibold mb-2",children:"ðŸ’¡ ä½¿ç”¨ç¯„ä¾‹"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(l,{size:"sm",className:"text-blue-300",children:["â€¢ ","{é€£çºŒä¸Šç­åŒäº‹}ï¼Œè¾›è‹¦äº†ï¼"]}),e.jsx(l,{size:"sm",className:"text-gray-400 text-xs",children:"â†’ å°æ˜Žé€£çºŒä¸Šç­5å¤©ã€å°è¯é€£çºŒä¸Šç­4å¤©ï¼Œè¾›è‹¦äº†ï¼"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs(l,{size:"sm",className:"text-blue-300",children:["â€¢ ","{é€£çºŒä¸Šç­6å¤©åŒäº‹}ï¼Œè«‹å‹™å¿…ä¼‘æ¯"]}),e.jsx(l,{size:"sm",className:"text-gray-400 text-xs",children:"â†’ ç´…è‘‰ï¼Œè«‹å‹™å¿…ä¼‘æ¯"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs(l,{size:"sm",className:"text-blue-300",children:["â€¢ ","ä»Šå¤©æœ‰{é€£çºŒä¸Šç­åŒäº‹æ•¸é‡}ä½åŒäº‹éœ€è¦é—œå¿ƒ"]}),e.jsx(l,{size:"sm",className:"text-gray-400 text-xs",children:"â†’ ä»Šå¤©æœ‰2ä½åŒäº‹éœ€è¦é—œå¿ƒ"})]})]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-white/10",children:[e.jsx(l,{size:"sm",className:"text-blue-300 font-semibold mb-2",children:"âš™ï¸ åŠŸèƒ½èªªæ˜Ž"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{size:"sm",className:"text-blue-300",children:"â€¢ è‡ªå‹•è¨ˆç®—ï¼šå¾žä»Šå¤©é–‹å§‹å¾€å‰è¨ˆç®—ï¼Œé‡åˆ°ä¼‘å‡ç‚ºæ­¢"}),e.jsx(l,{size:"sm",className:"text-blue-300",children:"â€¢ æ™ºèƒ½é¡¯ç¤ºï¼šæ²’æœ‰ç¬¦åˆæ¢ä»¶çš„åŒäº‹æ™‚ï¼Œæ¨¡æ¿ä¸æœƒé¡¯ç¤º"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{size:"sm",className:"text-blue-300",children:"â€¢ é©ç”¨å ´æ™¯ï¼šé—œå¿ƒåŒäº‹ã€æé†’ä¼‘æ¯ã€è¡¨æšå‹¤å¥®"}),e.jsx(l,{size:"sm",className:"text-blue-300",children:"â€¢ æ³¨æ„äº‹é …ï¼šéœ€è¦å…ˆåœ¨å§“åç®¡ç†ä¸­è¨­å®šåŒäº‹å§“åå°æ‡‰"})]})]})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(y,{onClick:()=>R(!0),variant:"primary",size:"sm",disabled:r,children:"æ·»åŠ è¦å‰‡"})})]})]}),Y&&e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-lg p-4 mb-6",children:[e.jsx(C,{level:3,className:"mb-4",children:B?"ç·¨è¼¯æ¨¡æ¿":"æ·»åŠ æ–°æ¨¡æ¿"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"templateName",required:!0,children:"æ¨¡æ¿åç¨±"}),e.jsx(D,{id:"templateName",value:S.name,onChange:s=>H("name",s.target.value),placeholder:"ä¾‹å¦‚ï¼šæ—©ç­å•å€™",disabled:r})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"templateMessage",required:!0,children:"å•å€™èªžå…§å®¹"}),e.jsx(D,{id:"templateMessage",value:S.message,onChange:s=>H("message",s.target.value),placeholder:"ä¾‹å¦‚ï¼š{æ—©ç­åŒäº‹}ï¼Œæ—©å®‰ï¼ä»Šå¤©ä¹Ÿè¦åŠ æ²¹å–”ï¼",disabled:r})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"templateEnabled",checked:S.enabled,onChange:s=>H("enabled",s.target.checked),disabled:r,className:"w-5 h-5 disabled:opacity-50"}),e.jsx(m,{htmlFor:"templateEnabled",className:"!mb-0",children:"å•Ÿç”¨æ­¤æ¨¡æ¿"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"timeRestriction",checked:S.timeRestriction,onChange:s=>H("timeRestriction",s.target.checked),disabled:r,className:"w-5 h-5 disabled:opacity-50"}),e.jsx(m,{htmlFor:"timeRestriction",className:"!mb-0",children:"å•Ÿç”¨æ™‚é–“é™åˆ¶"})]}),S.timeRestriction&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"startTime",required:!0,children:"é™åˆ¶é–‹å§‹æ™‚é–“"}),e.jsx(D,{id:"startTime",type:"time",value:S.startTime,onChange:s=>H("startTime",s.target.value),disabled:r})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"endTime",required:!0,children:"é™åˆ¶çµæŸæ™‚é–“"}),e.jsx(D,{id:"endTime",type:"time",value:S.endTime,onChange:s=>H("endTime",s.target.value),disabled:r})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{onClick:Te,variant:"primary",disabled:r,loading:r,children:B?"æ›´æ–°æ¨¡æ¿":"æ·»åŠ æ¨¡æ¿"}),e.jsx(y,{onClick:xe,variant:"secondary",disabled:r,children:"å–æ¶ˆ"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(m,{children:["ç¾æœ‰æ¨¡æ¿ (",o.length,"æ¢)"]}),e.jsx(y,{onClick:Ce,variant:"secondary",size:"sm",disabled:r,children:"è¼‰å…¥é è¨­"})]}),o.length===0?e.jsx(l,{color:"secondary",className:"text-center py-8",children:"æš«ç„¡ç­è¡¨å•å€™æ¨¡æ¿"}):o.map(s=>e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:s.enabled,onChange:()=>ke(s.id),disabled:r,className:"w-4 h-4 disabled:opacity-50"}),e.jsx(C,{level:4,className:"!mb-0",children:s.name}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.enabled?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"}`,children:s.enabled?"å•Ÿç”¨":"åœç”¨"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{onClick:()=>ze(s),variant:"ghost",size:"sm",disabled:r,children:"ç·¨è¼¯"}),e.jsx(y,{onClick:()=>De(s.id),variant:"danger",size:"sm",disabled:r,children:"åˆªé™¤"})]})]}),e.jsxs(l,{size:"sm",color:"secondary",className:"mb-2",children:["åŽŸå§‹æ¨¡æ¿ï¼š",s.message]}),s.timeRestriction&&e.jsxs(l,{size:"sm",color:"secondary",className:"mb-2",children:["æ™‚é–“é™åˆ¶ï¼š",s.startTime," - ",s.endTime]})]},s.id))]})]}),z==="dialogue"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsx(m,{htmlFor:"newMessage",children:"æ·»åŠ æ–°å°è©±"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{id:"newMessage",type:"text",value:se,onChange:s=>oe(s.target.value),disabled:r,placeholder:"è¼¸å…¥æ–°å°è©±å…§å®¹...",onKeyPress:s=>s.key==="Enter"&&!r&&me()}),e.jsx(y,{onClick:()=>me(),disabled:r||!se.trim(),loading:r,children:r?"æ·»åŠ ä¸­...":"æ·»åŠ "})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(m,{children:["å°è©±åˆ—è¡¨ (",b.length,"æ¢)"]}),e.jsx("div",{className:"max-h-64 overflow-y-auto space-y-2 border border-white/10 rounded-lg p-3",children:b.length===0?e.jsx(l,{color:"secondary",className:"text-center py-4",children:"æš«ç„¡å°è©±å…§å®¹"}):b.map((s,a)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/5 rounded-lg",children:[e.jsx(l,{className:"flex-1",children:s}),e.jsx(y,{onClick:()=>ue(a),variant:"ghost",size:"sm",disabled:r,className:"p-1 text-red-400 hover:text-red-300",title:"åˆªé™¤",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},a))})]})]}),e.jsxs("div",{className:"mt-8 bg-gradient-to-r from-purple-500/10 to-blue-500/10 border border-purple-500/20 rounded-lg p-6",children:[e.jsx(C,{level:3,className:"text-purple-400 mb-4 text-center",children:"æ‰€æœ‰å°è©±åˆ—è¡¨"}),e.jsx("div",{className:"space-y-3",children:(()=>{const s=te(g,c,o,v),a=s.map(d=>d.message).filter(d=>d&&typeof d=="string"&&d.trim()!==""),t=b.filter(d=>d&&typeof d=="string"&&d.trim()!==""&&!a.includes(d)),i=[...s.map(d=>({...d,isNormal:!1})),...t.map(d=>({type:"normal",priority:999,message:d,source:"æ™®é€šå°è©±",isNormal:!0}))],N=[],w=new Set;for(const d of i)w.has(d.message)||(N.push(d),w.add(d.message));return N.length===0?e.jsx(l,{size:"sm",className:"text-gray-400 text-center py-4",children:"ç›®å‰æ²’æœ‰ä»»ä½•å°è©±"}):N.map((d,A)=>e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs(l,{size:"sm",className:"text-green-400 font-bold",children:[A+1,". ",d.source]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${d.type==="custom"?"bg-purple-500/20 text-purple-400":d.type==="schedule"?"bg-blue-500/20 text-blue-400":d.type==="normal"?"bg-orange-500/20 text-orange-400":"bg-gray-500/20 text-gray-400"}`,children:d.type==="custom"?"è‡ªå®šç¾©è¦å‰‡":d.type==="schedule"?"ç­è¡¨æ¨¡æ¿":d.type==="normal"?"æ™®é€šå°è©±":"å…¶ä»–"})]}),e.jsx(l,{className:"text-white",children:d.message})]},A))})()}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-white/10",children:[e.jsx(l,{size:"sm",className:"text-blue-300 font-bold mb-2",children:"è©³ç´°èª¿è©¦è³‡è¨Šï¼š"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-xs text-gray-400",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{children:["ç­è¡¨è³‡æ–™ï¼š",g?"å·²è¼‰å…¥":"æœªè¼‰å…¥"]}),e.jsxs("div",{children:["å§“åè³‡æ–™ï¼š",Object.keys(v).length>0?`å·²è¼‰å…¥ ${Object.keys(v).length} å€‹`:"æœªè¼‰å…¥"]}),e.jsxs("div",{children:["ä»Šå¤©ä¸Šç­åŒäº‹ï¼š",g?W(g).length:0," äºº"]}),e.jsxs("div",{children:["è‡ªå®šç¾©è¦å‰‡ï¼š",c.filter(s=>s.enabled).length," å€‹å•Ÿç”¨"]}),e.jsxs("div",{children:["ç­è¡¨æ¨¡æ¿ï¼š",o.filter(s=>s.enabled).length," å€‹å•Ÿç”¨"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{children:["æ™ºèƒ½å°è©±ï¼š",te(g,c,o,v).length," æ¢"]}),e.jsxs("div",{children:["æ™®é€šå°è©±ï¼š",b.length," æ¢"]}),e.jsxs("div",{children:["ç¸½å°è©±æ•¸ï¼š",te(g,c,o,v).length+b.length," æ¢"]}),e.jsxs("div",{children:["ç•¶å‰æ™‚é–“ï¼š",new Date().toLocaleString()]}),e.jsxs("div",{children:["æ˜ŸæœŸï¼š",new Date().toLocaleDateString("zh-TW",{weekday:"long"})]})]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-white/10",children:[e.jsx(l,{size:"sm",className:"text-blue-300 font-bold mb-2",children:"é€£çºŒä¸Šç­å¤©æ•¸ï¼š"}),e.jsx("div",{className:"space-y-1 text-xs text-gray-400",children:(()=>{const s=Fe(g,v,1,30);if(s.length===0)return e.jsx("div",{className:"text-gray-500",children:"ç„¡é€£çºŒä¸Šç­åŒäº‹"});const a={};return s.forEach(t=>{a[t.consecutiveDays]||(a[t.consecutiveDays]=[]),a[t.consecutiveDays].push(t.name)}),Object.entries(a).sort(([t],[i])=>parseInt(i)-parseInt(t)).map(([t,i])=>{const N=parseInt(t);let w="text-gray-300";return N>=6?w="text-red-400":N>=4&&(w="text-yellow-400"),e.jsxs("div",{className:"bg-white/5 rounded p-2 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs("span",{className:`font-semibold ${w}`,children:[t,"å¤©ï¼š"]}),e.jsx("span",{className:"text-gray-300 ml-1",children:i.join("ã€")})]}),N>=4&&e.jsx("span",{className:`text-xs px-2 py-1 rounded ${N>=6?"bg-red-500/20 text-red-300":"bg-yellow-500/20 text-yellow-300"}`,children:N>=6?"é«˜é¢¨éšª":"æ³¨æ„"})]},t)})})()})]}),o.filter(s=>s.enabled).length>0&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-white/10",children:[e.jsx(l,{size:"sm",className:"text-blue-300 font-bold mb-2",children:"ç­è¡¨æ¨¡æ¿èª¿è©¦ï¼š"}),e.jsx("div",{className:"space-y-1 text-xs text-gray-400",children:o.filter(s=>s.enabled).map((s,a)=>{const t=W(g),i=Re(t,v),N=s.timeRestriction?be(s.startTime,s.endTime):!0,w=Se(s,g,v),d=w&&typeof w=="string"&&w.trim()!=="";return e.jsxs("div",{className:"bg-white/5 rounded p-2",children:[e.jsxs("div",{children:["æ¨¡æ¿ï¼š",s.name]}),e.jsxs("div",{children:["æ™‚é–“é™åˆ¶ï¼š",s.timeRestriction?`${s.startTime}-${s.endTime}`:"ç„¡"]}),e.jsxs("div",{children:["æ™‚é–“æª¢æŸ¥ï¼š",N?"é€šéŽ":"ä¸é€šéŽ"]}),e.jsxs("div",{children:["æœƒé¡¯ç¤ºï¼š",d?"æ˜¯":"å¦"]}),d&&e.jsxs("div",{children:["è™•ç†å¾Œï¼š",w]}),e.jsxs("div",{children:["æ—©ç­åŒäº‹ï¼š",i.morning.join("ã€")||"ç„¡"]}),e.jsxs("div",{children:["ä¸­ç­åŒäº‹ï¼š",i.afternoon.join("ã€")||"ç„¡"]}),e.jsxs("div",{children:["æ™šç­åŒäº‹ï¼š",i.evening.join("ã€")||"ç„¡"]})]},a)})})]})]})]})]})},Ke=()=>{const[c,o]=x.useState(!1),[h,f]=x.useState([]),[r,k]=x.useState(4),[b,$]=x.useState(!1),[q,I]=x.useState(!0),[U,X]=x.useState(!1),[G,F]=x.useState(""),[Y,R]=x.useState(""),[L,Q]=x.useState(null),[z,K]=x.useState(!1),[M,Z]=x.useState([]),[n,E]=x.useState([]),g=_e();x.useEffect(()=>de.onAuthStateChanged(async p=>{if(p)try{const j=await Pe(p.uid);$(j),j||(F("æ‚¨æ²’æœ‰ç®¡ç†å“¡æ¬Šé™"),setTimeout(()=>g("/"),3e3))}catch(j){F("æª¢æŸ¥æ¬Šé™æ™‚ç™¼ç”ŸéŒ¯èª¤"),console.error("æ¬Šé™æª¢æŸ¥å¤±æ•—:",j)}else $(!1),F("è«‹å…ˆç™»å…¥"),setTimeout(()=>g("/"),2e3);I(!1)}),[g]),x.useEffect(()=>{b&&(async()=>{try{console.log("AdminPanel: é–‹å§‹è¼‰å…¥ç­è¡¨è³‡æ–™...");const p=await ae(V(P,"schedule","currentMonth")),j=await ae(V(P,"schedule","nextMonth"));console.log("AdminPanel: currentMonthDoc.exists():",p.exists()),console.log("AdminPanel: nextMonthDoc.exists():",j.exists());let W=null;p.exists()?W=p.data():j.exists()&&(W=j.data()),Q(W)}catch{}})()},[b]),x.useEffect(()=>b?We(V(P,"catSpeech","global"),p=>{if(p.exists()){const j=p.data();o(j.enabled||!1),f(j.texts||[]),k(j.intervalSeconds||4),K(j.smartMode||!1),Z(j.customRules||[]),E(j.scheduleTemplates||[])}},p=>{console.error("ç›£è½è¨­å®šå¤±æ•—:",p),F("è¼‰å…¥è¨­å®šå¤±æ•—")}):void 0,[b]);const ee=async()=>{try{I(!0);const{signOut:u}=await Be(async()=>{const{signOut:p}=await import("./index-CMqf4Yce.js").then(j=>j.x);return{signOut:p}},__vite__mapDeps([0,1]));await u(de),g("/")}catch(u){console.error("ç™»å‡ºå¤±æ•—:",u),F("ç™»å‡ºå¤±æ•—"),I(!1)}},v=async u=>{var p;if(b)try{X(!0),F(""),R(""),await He(V(P,"catSpeech","global"),{...u,lastUpdated:Ve(),updatedBy:(p=de.currentUser)==null?void 0:p.uid}),R("è¨­å®šå·²æ›´æ–°"),setTimeout(()=>R(""),3e3)}catch(j){console.error("æ›´æ–°è¨­å®šå¤±æ•—:",j),F("æ›´æ–°è¨­å®šå¤±æ•—")}finally{X(!1)}},re=async u=>{Z(u),await v({texts:h,enabled:c,intervalSeconds:r,smartMode:z,customRules:u,scheduleTemplates:n})},J=async u=>{E(u),await v({texts:h,enabled:c,intervalSeconds:r,smartMode:z,customRules:M,scheduleTemplates:u})};return q?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx(l,{size:"lg",className:"mb-2",children:"è¼‰å…¥ä¸­..."}),e.jsx(l,{size:"sm",color:"secondary",children:"æ­£åœ¨æª¢æŸ¥ç®¡ç†å“¡æ¬Šé™"})]})}):G?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center max-w-md mx-auto",children:[e.jsx("div",{className:"text-red-400 text-4xl mb-4",children:"âš ï¸"}),e.jsx(C,{level:2,className:"mb-4",children:"ç™¼ç”ŸéŒ¯èª¤"}),e.jsx(l,{className:"mb-6",children:G}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(y,{onClick:()=>g("/"),variant:"primary",size:"lg",className:"w-full",children:"è¿”å›žé¦–é "}),e.jsx(y,{onClick:()=>window.location.reload(),variant:"secondary",size:"lg",className:"w-full",children:"é‡æ–°è¼‰å…¥"})]})]})}):b?e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs(Ue,{children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx(C,{level:1,gradient:!0,className:"mb-2",children:"ç®¡ç†å“¡è¨­å®š"}),e.jsx(l,{color:"secondary",children:"ç®¡ç†è²“å’ªå°è©±å’Œç³»çµ±è¨­å®š"})]}),Y&&e.jsx("div",{className:"mb-6 bg-green-500/10 border border-green-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-green-400",children:"âœ“"}),e.jsx(l,{color:"success",children:Y})]})}),e.jsx("div",{className:"flex justify-end mb-6",children:e.jsx(y,{onClick:ee,variant:"danger",disabled:q,loading:q,children:q?"ç™»å‡ºä¸­...":"ç™»å‡ºç®¡ç†å“¡"})}),e.jsx(Ge,{customRules:M,scheduleTemplates:n,onRulesChange:re,onTemplatesChange:J,isSaving:U,scheduleData:L,speechTexts:h,onSpeechTextsChange:u=>v({texts:u,enabled:c,intervalSeconds:r,smartMode:z,customRules:M,scheduleTemplates:n}),showBubble:c,onShowBubbleChange:u=>v({texts:h,enabled:u,intervalSeconds:r,smartMode:z,customRules:M,scheduleTemplates:n}),intervalSeconds:r,onIntervalSecondsChange:u=>v({texts:h,enabled:c,intervalSeconds:u,smartMode:z,customRules:M,scheduleTemplates:n}),smartMode:z,onSmartModeChange:u=>v({texts:h,enabled:c,intervalSeconds:r,smartMode:u,customRules:M,scheduleTemplates:n})})]})}):null};export{Ke as default};
