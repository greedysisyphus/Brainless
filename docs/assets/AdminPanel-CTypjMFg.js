const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CMqf4Yce.js","assets/index-BUSimLPm.css"])))=>i.map(i=>d[i]);
import{j as e,r as x,g as te,f as Fe,c as Re,p as Se,a as ae,d as V,b as P,e as Ee,h as qe,v as Ie,i as Le,k as Ae,l as Oe,u as _e,m as de,n as Pe,o as We,_ as Be,s as He,q as Ve}from"./index-CMqf4Yce.js";const Ue=({children:c,className:o="",maxWidth:h="container-custom",padding:f="py-4 sm:py-6 lg:py-8",center:r=!0})=>e.jsx("div",{className:`${h} ${f} ${r?"mx-auto":""} ${o}`,children:c}),Xe=({children:c,className:o="",padding:h="p-4 sm:p-6",hover:f=!0})=>e.jsx("div",{className:`
      bg-surface rounded-xl shadow-lg border border-white/5 
      ${h} 
      ${f?"hover:shadow-xl hover:border-white/10 transition-all duration-200":""} 
      ${o}
    `,children:c}),y=({children:c,onClick:o,variant:h="primary",size:f="md",disabled:r=!1,loading:k=!1,className:b="",...$})=>{const q=()=>{switch(h){case"primary":return"bg-primary text-white hover:bg-primary/80 disabled:bg-primary/50";case"secondary":return"bg-white/10 text-white hover:bg-white/20 disabled:bg-white/5";case"danger":return"bg-red-500/20 text-red-400 hover:bg-red-500/30 border border-red-500/30 disabled:bg-red-500/10";case"ghost":return"text-text-secondary hover:text-text-primary hover:bg-white/5 disabled:text-gray-500";default:return"bg-primary text-white hover:bg-primary/80 disabled:bg-primary/50"}},I=()=>{switch(f){case"sm":return"px-3 py-2 text-sm";case"md":return"px-4 py-2";case"lg":return"px-6 py-3 text-lg";default:return"px-4 py-2"}};return e.jsx("button",{onClick:o,disabled:r||k,className:`
        ${q()}
        ${I()}
        rounded-lg transition-all duration-200
        disabled:opacity-50 disabled:cursor-not-allowed
        focus:outline-none focus:ring-2 focus:ring-primary/50
        ${b}
      `,...$,children:k?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}),"載入中..."]}):c})},D=({value:c,onChange:o,placeholder:h="",type:f="text",disabled:r=!1,error:k=!1,className:b="",...$})=>e.jsx("input",{type:f,value:c,onChange:o,placeholder:h,disabled:r,className:`
        w-full p-3 sm:p-4
        bg-white/10 border rounded-lg
        text-white placeholder-gray-400
        focus:outline-none focus:ring-2 focus:ring-primary/50
        disabled:opacity-50 disabled:cursor-not-allowed
        ${k?"border-red-500/50 focus:ring-red-500/50":"border-white/20"}
        ${b}
      `,...$}),m=({children:c,htmlFor:o,className:h="",required:f=!1})=>e.jsx("label",{htmlFor:o,className:`
        block text-sm sm:text-base text-white mb-2
        ${f?'after:content-["*"] after:text-red-400 after:ml-1':""}
        ${h}
      `,children:c}),C=({children:c,level:o=1,className:h="",gradient:f=!1})=>{const r=()=>{switch(o){case 1:return"text-2xl sm:text-3xl lg:text-4xl";case 2:return"text-xl sm:text-2xl lg:text-3xl";case 3:return"text-lg sm:text-xl lg:text-2xl";case 4:return"text-base sm:text-lg lg:text-xl";case 5:return"text-sm sm:text-base lg:text-lg";case 6:return"text-xs sm:text-sm lg:text-base";default:return"text-xl sm:text-2xl lg:text-3xl"}},k=()=>f?"bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent":"text-white",b=`h${o}`;return e.jsx(b,{className:`font-bold ${r()} ${k()} ${h}`,children:c})},l=({children:c,size:o="base",color:h="white",className:f="",...r})=>{const k=()=>{switch(o){case"xs":return"text-xs";case"sm":return"text-sm";case"base":return"text-base";case"lg":return"text-lg";case"xl":return"text-xl";default:return"text-base"}},b=()=>{switch(h){case"white":return"text-white";case"secondary":return"text-text-secondary";case"primary":return"text-primary";case"danger":return"text-red-400";case"success":return"text-green-400";default:return"text-white"}};return e.jsx("p",{className:`${k()} ${b()} ${f}`,...r,children:c})},Ge=({customRules:c=[],scheduleTemplates:o=[],onRulesChange:h,onTemplatesChange:f,isSaving:r=!1,scheduleData:k=null,speechTexts:b=[],onSpeechTextsChange:$,showBubble:q=!1,onShowBubbleChange:I,intervalSeconds:U=4,onIntervalSecondsChange:X,smartMode:G=!1,onSmartModeChange:F})=>{const[Y,R]=x.useState(!1),[L,Q]=x.useState(null),[z,K]=x.useState("custom"),[M,Z]=x.useState(!1),[n,E]=x.useState({name:"",type:"timeRange",startTime:"08:00",endTime:"10:00",day:"一",month:1,date:1,allDay:!1,messages:[""],enabled:!0}),[g,ee]=x.useState(null),[v,re]=x.useState({}),[J,u]=x.useState(!1),[p,j]=x.useState(!1);x.useEffect(()=>{k?ee(k):(async()=>{try{u(!0);const a=await ae(V(P,"schedule","currentMonth")),t=await ae(V(P,"schedule","nextMonth"));let i=null;a.exists()?i=a.data():t.exists()&&(i=t.data()),ee(i)}catch(a){console.error("載入班表資料失敗:",a)}finally{u(!1)}})()},[k]),x.useEffect(()=>{(async()=>{try{j(!0);const a=await Ee(qe(P,"names")),t={};a.forEach(i=>{const N=i.data();N.name&&(t[i.id]=N.name)}),re(t)}catch(a){console.error("載入同事姓名資料失敗:",a)}finally{j(!1)}})()},[]);const W=s=>{if(!s||typeof s!="object")return[];const a=[],t=new Date,i=t.getFullYear(),N=t.getMonth()+1,w=t.getDate();for(const[d,A]of Object.entries(s))if(d!=="_lastUpdated"&&A&&typeof A=="object"){for(const[ie,O]of Object.entries(A))if(O&&O.trim()&&O!=="休假"&&O!=="特休"&&O!=="月休"){const _=parseInt(ie);_===w&&a.push({id:`${d}_${_}`,date:`${i}-${String(N).padStart(2,"0")}-${String(_).padStart(2,"0")}`,shift:O,employee:d})}}return a},[S,le]=x.useState({name:"",message:"",enabled:!0,timeRestriction:!1,startTime:"08:00",endTime:"10:00"}),[B,ce]=x.useState(null),[se,oe]=x.useState(""),me=async()=>{if(se.trim()&&$){const s=[...b,se.trim()];try{await $(s),oe("")}catch(a){console.error("添加對話失敗:",a)}}},ue=async s=>{if($){const a=b.filter((t,i)=>i!==s);try{await $(a)}catch(t){console.error("刪除對話失敗:",t)}}},xe=()=>{le({name:"",message:"",enabled:!0,timeRestriction:!1,startTime:"08:00",endTime:"10:00"}),ce(null),R(!1)},H=(s,a)=>{le(t=>({...t,[s]:a}))},be=(s,a)=>{const t=new Date,i=t.getHours(),N=t.getMinutes(),w=i*60+N,[d,A]=s.split(":").map(Number),[ie,O]=a.split(":").map(Number),_=d*60+A,ne=ie*60+O;return ne<_?w>=_||w<=ne:w>=_&&w<=ne},he=()=>{E({name:"",type:"timeRange",startTime:"08:00",endTime:"10:00",day:"一",month:1,date:1,allDay:!1,messages:[""],enabled:!0}),Q(null),R(!1)},T=(s,a)=>{E(t=>({...t,[s]:a}))},ge=(s,a)=>{const t=[...n.messages];t[s]=a,E(i=>({...i,messages:t}))},je=()=>{E(s=>({...s,messages:[...s.messages,""]}))},pe=s=>{if(n.messages.length>1){const a=n.messages.filter((t,i)=>i!==s);E(t=>({...t,messages:a}))}},ye=()=>{if(!n.name.trim()){alert("請填寫規則名稱");return}const s=n.messages.filter(i=>i&&typeof i=="string"&&i.trim()!=="");if(s.length===0){alert("請至少添加一個對話內容");return}const a={id:L?L.id:Date.now().toString(),...n,messages:s};if(!Ie(a)){alert("規則設定有誤，請檢查時間格式");return}let t;L?t=c.map(i=>i.id===L.id?a:i):t=[...c,a],h(t),he()},fe=s=>{if(window.confirm("確定要刪除這個規則嗎？")){const a=c.filter(t=>t.id!==s);h(a)}},Ne=s=>{const a=c.map(t=>t.id===s?{...t,enabled:!t.enabled}:t);h(a)},ve=s=>{E({name:s.name,type:s.type,startTime:s.startTime||"08:00",endTime:s.endTime||"10:00",day:s.day||"一",month:s.month||1,date:s.date||1,allDay:s.allDay||!1,messages:s.messages||[""],enabled:s.enabled}),Q(s),R(!0)},we=()=>{window.confirm("確定要載入預設規則嗎？這會覆蓋現有的自定義規則。")&&h(Le())},Te=()=>{if(!S.name.trim()){alert("請填寫模板名稱");return}if(!S.message.trim()){alert("請填寫問候語內容");return}const s={id:B?B.id:Date.now().toString(),...S};if(!Ae(s)){alert("模板設定有誤，請檢查內容");return}let a;B?a=o.map(t=>t.id===B.id?s:t):a=[...o,s],f(a),xe()},De=s=>{if(window.confirm("確定要刪除這個模板嗎？")){const a=o.filter(t=>t.id!==s);f(a)}},ke=s=>{const a=o.map(t=>t.id===s?{...t,enabled:!t.enabled}:t);f(a)},ze=s=>{le({name:s.name,message:s.message,enabled:s.enabled,timeRestriction:s.timeRestriction||!1,startTime:s.startTime||"08:00",endTime:s.endTime||"10:00"}),ce(s),R(!0)},Ce=()=>{const s=Oe();f(s)},$e=()=>{if(J){alert("請稍候，正在載入班表資料...");return}if(p){alert("請稍候，正在載入姓名資料...");return}if(!g){alert("無班表資料，無法預覽所有智能對話。");return}Object.keys(v).length===0&&alert("無姓名資料，將顯示職員編號。");const s=te(g,c,o,v),a=s.map((t,i)=>`${i+1}. [${t.source}] ${t.message}`).join(`

`);s.length===0?alert(`目前沒有觸發的智能對話。

只會播放您設定的普通對話。`):alert(`智能對話預覽 (共${s.length}條)：

${a}

注意：這些對話會與您設定的普通對話一起輪流播放。`)},Me=()=>{switch(n.type){case"timeRange":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"allDay",checked:n.allDay,onChange:s=>T("allDay",s.target.checked),disabled:r,className:"w-5 h-5 disabled:opacity-50"}),e.jsx(m,{htmlFor:"allDay",className:"!mb-0",children:"全天（24小時）"})]}),!n.allDay&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"startTime",required:!0,children:"開始時間"}),e.jsx(D,{id:"startTime",type:"time",value:n.startTime,onChange:s=>T("startTime",s.target.value),disabled:r})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"endTime",required:!0,children:"結束時間"}),e.jsx(D,{id:"endTime",type:"time",value:n.endTime,onChange:s=>T("endTime",s.target.value),disabled:r})]})]})]});case"dayOfWeek":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"daySelect",required:!0,children:"星期幾"}),e.jsxs("select",{id:"daySelect",value:n.day,onChange:s=>T("day",s.target.value),disabled:r,className:"w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary/50 disabled:opacity-50",children:[e.jsx("option",{value:"一",children:"星期一"}),e.jsx("option",{value:"二",children:"星期二"}),e.jsx("option",{value:"三",children:"星期三"}),e.jsx("option",{value:"四",children:"星期四"}),e.jsx("option",{value:"五",children:"星期五"}),e.jsx("option",{value:"六",children:"星期六"}),e.jsx("option",{value:"日",children:"星期日"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"allDay",checked:n.allDay,onChange:s=>T("allDay",s.target.checked),disabled:r,className:"w-5 h-5 disabled:opacity-50"}),e.jsx(m,{htmlFor:"allDay",className:"!mb-0",children:"全天（24小時）"})]}),!n.allDay&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"startTime",required:!0,children:"開始時間"}),e.jsx(D,{id:"startTime",type:"time",value:n.startTime,onChange:s=>T("startTime",s.target.value),disabled:r})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"endTime",required:!0,children:"結束時間"}),e.jsx(D,{id:"endTime",type:"time",value:n.endTime,onChange:s=>T("endTime",s.target.value),disabled:r})]})]})]});case"specificDate":return e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"month",required:!0,children:"月份"}),e.jsx(D,{id:"month",type:"number",min:"1",max:"12",value:n.month||"",onChange:s=>{const a=s.target.value,t=a===""?1:parseInt(a);T("month",isNaN(t)?1:t)},disabled:r})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"date",required:!0,children:"日期"}),e.jsx(D,{id:"date",type:"number",min:"1",max:"31",value:n.date||"",onChange:s=>{const a=s.target.value,t=a===""?1:parseInt(a);T("date",isNaN(t)?1:t)},disabled:r})]})]});case"monthlyDate":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"monthlyDate",required:!0,children:"每月幾號"}),e.jsx("div",{className:"grid grid-cols-7 gap-1 bg-white/5 rounded-lg p-3 border border-white/10",children:Array.from({length:31},(s,a)=>a+1).map(s=>e.jsx("button",{type:"button",onClick:()=>T("date",s),disabled:r,className:`p-2 text-sm rounded transition-colors ${n.date===s?"bg-primary text-white":"bg-white/10 text-gray-300 hover:bg-white/20"} disabled:opacity-50`,children:s},s))})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"allDay",checked:n.allDay,onChange:s=>T("allDay",s.target.checked),disabled:r,className:"w-5 h-5 disabled:opacity-50"}),e.jsx(m,{htmlFor:"allDay",className:"!mb-0",children:"全天（24小時）"})]}),!n.allDay&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"startTime",required:!0,children:"開始時間"}),e.jsx(D,{id:"startTime",type:"time",value:n.startTime,onChange:s=>T("startTime",s.target.value),disabled:r})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"endTime",required:!0,children:"結束時間"}),e.jsx(D,{id:"endTime",type:"time",value:n.endTime,onChange:s=>T("endTime",s.target.value),disabled:r})]})]})]});default:return null}};return e.jsxs(Xe,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx(C,{level:2,gradient:!0,children:"智能對話規則管理"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{onClick:$e,variant:"secondary",size:"sm",disabled:r||J||p,children:"預覽所有對話"}),e.jsx(y,{onClick:()=>R(!0),variant:"primary",size:"sm",disabled:r,children:"添加規則"})]})]}),e.jsxs("div",{className:"bg-orange-500/10 border border-orange-500/20 rounded-lg p-4 mb-6",children:[e.jsx(C,{level:3,className:"text-orange-400 mb-4",children:"基本設定"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"bubbleToggle",checked:q,disabled:r,onChange:s=>I&&I(s.target.checked),className:"w-5 h-5 disabled:opacity-50"}),e.jsx(m,{htmlFor:"bubbleToggle",className:"!mb-0",children:"顯示對話輪播"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"smartModeToggle",checked:G,disabled:r,onChange:()=>F&&F(!G),className:"w-5 h-5 disabled:opacity-50"}),e.jsx(m,{htmlFor:"smartModeToggle",className:"!mb-0",children:"智能模式（根據自定義規則和班表問候自動顯示對話）"})]}),e.jsxs("div",{children:[e.jsxs(m,{htmlFor:"intervalSlider",children:["輪播間隔 (",U,"秒)"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"range",id:"intervalSlider",min:"1",max:"10",value:U,disabled:r,onChange:s=>X&&X(parseInt(s.target.value)),className:"flex-1 h-2 bg-white/10 rounded-lg appearance-none cursor-pointer slider disabled:opacity-50"}),e.jsxs("span",{className:"text-white min-w-[3rem] text-center",children:[U,"s"]})]}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[e.jsx("span",{children:"1秒"}),e.jsx("span",{children:"10秒"})]})]})]})]}),e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-4 mb-6",children:[e.jsx(C,{level:3,className:"text-blue-400 mb-2",children:"資料載入狀態"}),e.jsx(l,{size:"sm",className:"text-blue-300",children:J?"載入班表中...":g?`班表資料：${Object.keys(g).filter(s=>s!=="_lastUpdated").length} 位同事`:"班表資料：未載入"}),g&&g._lastUpdated&&e.jsxs(l,{size:"sm",className:"text-blue-300 mt-1",children:["最後更新：",new Date(g._lastUpdated).toLocaleString()]}),e.jsx(l,{size:"sm",className:"text-blue-300 mt-1",children:p?"載入姓名中...":Object.keys(v).length>0?`姓名對應：${Object.keys(v).length} 位同事`:"姓名對應：未載入"})]}),e.jsxs("div",{className:"flex border-b border-white/10 mb-6",children:[e.jsxs("button",{onClick:()=>K("custom"),className:`px-4 py-2 text-sm font-medium transition-colors ${z==="custom"?"text-primary border-b-2 border-primary":"text-text-secondary hover:text-text-primary"}`,children:["自定義規則 (",c.length,")"]}),e.jsxs("button",{onClick:()=>K("schedule"),className:`px-4 py-2 text-sm font-medium transition-colors ${z==="schedule"?"text-primary border-b-2 border-primary":"text-text-secondary hover:text-text-primary"}`,children:["班表問候模板 (",o.length,")"]}),e.jsxs("button",{onClick:()=>K("dialogue"),className:`px-4 py-2 text-sm font-medium transition-colors ${z==="dialogue"?"text-primary border-b-2 border-primary":"text-text-secondary hover:text-text-primary"}`,children:["對話管理 (",b.length,")"]})]}),z==="custom"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-purple-500/10 border border-purple-500/20 rounded-lg p-4 mb-6",children:[e.jsx(C,{level:3,className:"text-purple-400 mb-2",children:"自定義規則說明"}),e.jsx(l,{size:"sm",className:"text-purple-300",children:"可以設定特定時間範圍、星期幾或特定日期的對話規則，系統會根據條件自動顯示對話。"})]}),Y&&e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-lg p-4 mb-6",children:[e.jsx(C,{level:3,className:"mb-4",children:L?"編輯規則":"添加新規則"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"ruleName",required:!0,children:"規則名稱"}),e.jsx(D,{id:"ruleName",value:n.name,onChange:s=>T("name",s.target.value),placeholder:"例如：早上問候",disabled:r})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"ruleType",required:!0,children:"規則類型"}),e.jsxs("select",{id:"ruleType",value:n.type,onChange:s=>T("type",s.target.value),disabled:r,className:"w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary/50 disabled:opacity-50",children:[e.jsx("option",{value:"timeRange",children:"時間範圍"}),e.jsx("option",{value:"dayOfWeek",children:"星期幾"}),e.jsx("option",{value:"specificDate",children:"特定日期"}),e.jsx("option",{value:"monthlyDate",children:"每月幾號"})]})]}),Me(),e.jsxs("div",{children:[e.jsxs(m,{required:!0,children:["對話內容 (",n.messages.length,"條)"]}),e.jsxs("div",{className:"space-y-2",children:[n.messages.map((s,a)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{value:s,onChange:t=>ge(a,t.target.value),placeholder:`對話 ${a+1}...`,disabled:r}),e.jsx(y,{onClick:()=>pe(a),variant:"danger",size:"sm",disabled:r||n.messages.length<=1,className:"px-3",children:"刪除"})]},a)),e.jsx(y,{onClick:je,variant:"secondary",size:"sm",disabled:r,className:"w-full",children:"添加對話"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"ruleEnabled",checked:n.enabled,onChange:s=>T("enabled",s.target.checked),disabled:r,className:"w-5 h-5 disabled:opacity-50"}),e.jsx(m,{htmlFor:"ruleEnabled",className:"!mb-0",children:"啟用此規則"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{onClick:ye,variant:"primary",disabled:r,loading:r,children:L?"更新規則":"添加規則"}),e.jsx(y,{onClick:he,variant:"secondary",disabled:r,children:"取消"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(m,{children:["現有規則 (",c.length,"條)"]}),e.jsx(y,{onClick:we,variant:"secondary",size:"sm",disabled:r,children:"載入預設"})]}),c.length===0?e.jsx(l,{color:"secondary",className:"text-center py-8",children:"暫無自定義規則"}):c.map(s=>{var a,t;return e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:s.enabled,onChange:()=>Ne(s.id),disabled:r,className:"w-4 h-4 disabled:opacity-50"}),e.jsx(C,{level:4,className:"!mb-0",children:s.name}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.enabled?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"}`,children:s.enabled?"啟用":"停用"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{onClick:()=>ve(s),variant:"ghost",size:"sm",disabled:r,children:"編輯"}),e.jsx(y,{onClick:()=>fe(s.id),variant:"danger",size:"sm",disabled:r,children:"刪除"})]})]}),e.jsxs(l,{size:"sm",color:"secondary",className:"mb-2",children:["類型：",s.type==="timeRange"?"時間範圍":s.type==="dayOfWeek"?"星期幾":s.type==="specificDate"?"特定日期":s.type==="monthlyDate"?"每月幾號":"未知類型"]}),s.type==="timeRange"&&e.jsxs(l,{size:"sm",color:"secondary",className:"mb-2",children:["時間：",s.allDay?"全天":`${s.startTime} - ${s.endTime}`]}),s.type==="dayOfWeek"&&e.jsxs(l,{size:"sm",color:"secondary",className:"mb-2",children:["星期",s.day," ",s.allDay?"全天":`${s.startTime} - ${s.endTime}`]}),s.type==="specificDate"&&e.jsxs(l,{size:"sm",color:"secondary",className:"mb-2",children:[s.month,"月",s.date,"日"]}),s.type==="monthlyDate"&&e.jsxs(l,{size:"sm",color:"secondary",className:"mb-2",children:["每月",s.date,"日 ",s.allDay?"全天":`${s.startTime} - ${s.endTime}`]}),e.jsxs(l,{size:"sm",color:"secondary",className:"mb-2",children:["對話數量：",((a=s.messages)==null?void 0:a.length)||0," 條"]}),e.jsx("div",{className:"space-y-1",children:(t=s.messages)==null?void 0:t.map((i,N)=>e.jsx(l,{className:"bg-white/5 rounded p-2 text-sm",children:i},N))})]},s.id)})]})]}),z==="schedule"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(C,{level:3,className:"text-blue-400",children:"可用變數說明"}),e.jsxs(y,{onClick:()=>Z(!M),variant:"secondary",size:"sm",className:"flex items-center gap-2",children:[M?"隱藏說明":"顯示說明",e.jsx("span",{className:"text-xs",children:M?"▼":"▶"})]})]}),M&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[e.jsx(l,{size:"sm",className:"text-blue-300 font-bold mb-3 text-center",children:"📋 班次變數"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{size:"sm",className:"text-blue-300",children:["• ","{早班同事}"," - 早班同事名字"]}),e.jsxs(l,{size:"sm",className:"text-blue-300",children:["• ","{中班同事}"," - 中班同事名字"]}),e.jsxs(l,{size:"sm",className:"text-blue-300",children:["• ","{晚班同事}"," - 晚班同事名字"]}),e.jsxs(l,{size:"sm",className:"text-blue-300",children:["• ","{所有同事}"," - 所有上班同事名字"]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-white/10",children:[e.jsx(l,{size:"sm",className:"text-blue-300 font-semibold mb-2",children:"💡 使用範例："}),e.jsxs(l,{size:"sm",className:"text-blue-300",children:["• ","{早班同事}，早安！"," → 小明、小華，早安！"]}),e.jsxs(l,{size:"sm",className:"text-blue-300",children:["• ","{所有同事}，工作辛苦了！"," → 小明、小華、小美，工作辛苦了！"]})]})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[e.jsx(l,{size:"sm",className:"text-blue-300 font-bold mb-3 text-center",children:"👥 人數變數"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{size:"sm",className:"text-blue-300",children:["• ","{早班人數}"," - 早班人數"]}),e.jsxs(l,{size:"sm",className:"text-blue-300",children:["• ","{中班人數}"," - 中班人數"]}),e.jsxs(l,{size:"sm",className:"text-blue-300",children:["• ","{晚班人數}"," - 晚班人數"]}),e.jsxs(l,{size:"sm",className:"text-blue-300",children:["• ","{總人數}"," - 總上班人數"]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-white/10",children:[e.jsx(l,{size:"sm",className:"text-blue-300 font-semibold mb-2",children:"💡 使用範例："}),e.jsxs(l,{size:"sm",className:"text-blue-300",children:["• ","今天有{總人數}位同事上班"," → 今天有5位同事上班"]}),e.jsxs(l,{size:"sm",className:"text-blue-300",children:["• ","早班{早班人數}人，晚班{晚班人數}人"," → 早班2人，晚班3人"]})]})]})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[e.jsx(l,{size:"sm",className:"text-blue-300 font-bold mb-4 text-center",children:"⏰ 連續上班變數"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx(l,{size:"sm",className:"text-blue-300 font-semibold mb-2",children:"🔧 基本變數"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{size:"sm",className:"text-blue-300",children:["• ","{連續上班同事}"," - 連續上班4-6天的同事（顯示名字+天數）"]}),e.jsxs(l,{size:"sm",className:"text-blue-300",children:["• ","{連續上班同事數量}"," - 連續上班4-6天的同事數量"]})]})]}),e.jsxs("div",{children:[e.jsx(l,{size:"sm",className:"text-blue-300 font-semibold mb-2",children:"🎯 指定天數變數"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{size:"sm",className:"text-blue-300",children:["• ","{連續上班X天同事}"," - 指定天數的同事名字（X為數字，只顯示名字）"]}),e.jsxs(l,{size:"sm",className:"text-blue-300",children:["• ","{連續上班X天同事數量}"," - 指定天數的同事數量"]})]})]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-white/10",children:[e.jsx(l,{size:"sm",className:"text-blue-300 font-semibold mb-2",children:"💡 使用範例"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(l,{size:"sm",className:"text-blue-300",children:["• ","{連續上班同事}，辛苦了！"]}),e.jsx(l,{size:"sm",className:"text-gray-400 text-xs",children:"→ 小明連續上班5天、小華連續上班4天，辛苦了！"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs(l,{size:"sm",className:"text-blue-300",children:["• ","{連續上班6天同事}，請務必休息"]}),e.jsx(l,{size:"sm",className:"text-gray-400 text-xs",children:"→ 紅葉，請務必休息"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs(l,{size:"sm",className:"text-blue-300",children:["• ","今天有{連續上班同事數量}位同事需要關心"]}),e.jsx(l,{size:"sm",className:"text-gray-400 text-xs",children:"→ 今天有2位同事需要關心"})]})]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-white/10",children:[e.jsx(l,{size:"sm",className:"text-blue-300 font-semibold mb-2",children:"⚙️ 功能說明"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{size:"sm",className:"text-blue-300",children:"• 自動計算：從今天開始往前計算，遇到休假為止"}),e.jsx(l,{size:"sm",className:"text-blue-300",children:"• 智能顯示：沒有符合條件的同事時，模板不會顯示"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{size:"sm",className:"text-blue-300",children:"• 適用場景：關心同事、提醒休息、表揚勤奮"}),e.jsx(l,{size:"sm",className:"text-blue-300",children:"• 注意事項：需要先在姓名管理中設定同事姓名對應"})]})]})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(y,{onClick:()=>R(!0),variant:"primary",size:"sm",disabled:r,children:"添加規則"})})]})]}),Y&&e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-lg p-4 mb-6",children:[e.jsx(C,{level:3,className:"mb-4",children:B?"編輯模板":"添加新模板"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"templateName",required:!0,children:"模板名稱"}),e.jsx(D,{id:"templateName",value:S.name,onChange:s=>H("name",s.target.value),placeholder:"例如：早班問候",disabled:r})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"templateMessage",required:!0,children:"問候語內容"}),e.jsx(D,{id:"templateMessage",value:S.message,onChange:s=>H("message",s.target.value),placeholder:"例如：{早班同事}，早安！今天也要加油喔！",disabled:r})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"templateEnabled",checked:S.enabled,onChange:s=>H("enabled",s.target.checked),disabled:r,className:"w-5 h-5 disabled:opacity-50"}),e.jsx(m,{htmlFor:"templateEnabled",className:"!mb-0",children:"啟用此模板"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"timeRestriction",checked:S.timeRestriction,onChange:s=>H("timeRestriction",s.target.checked),disabled:r,className:"w-5 h-5 disabled:opacity-50"}),e.jsx(m,{htmlFor:"timeRestriction",className:"!mb-0",children:"啟用時間限制"})]}),S.timeRestriction&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"startTime",required:!0,children:"限制開始時間"}),e.jsx(D,{id:"startTime",type:"time",value:S.startTime,onChange:s=>H("startTime",s.target.value),disabled:r})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"endTime",required:!0,children:"限制結束時間"}),e.jsx(D,{id:"endTime",type:"time",value:S.endTime,onChange:s=>H("endTime",s.target.value),disabled:r})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{onClick:Te,variant:"primary",disabled:r,loading:r,children:B?"更新模板":"添加模板"}),e.jsx(y,{onClick:xe,variant:"secondary",disabled:r,children:"取消"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(m,{children:["現有模板 (",o.length,"條)"]}),e.jsx(y,{onClick:Ce,variant:"secondary",size:"sm",disabled:r,children:"載入預設"})]}),o.length===0?e.jsx(l,{color:"secondary",className:"text-center py-8",children:"暫無班表問候模板"}):o.map(s=>e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:s.enabled,onChange:()=>ke(s.id),disabled:r,className:"w-4 h-4 disabled:opacity-50"}),e.jsx(C,{level:4,className:"!mb-0",children:s.name}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.enabled?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"}`,children:s.enabled?"啟用":"停用"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{onClick:()=>ze(s),variant:"ghost",size:"sm",disabled:r,children:"編輯"}),e.jsx(y,{onClick:()=>De(s.id),variant:"danger",size:"sm",disabled:r,children:"刪除"})]})]}),e.jsxs(l,{size:"sm",color:"secondary",className:"mb-2",children:["原始模板：",s.message]}),s.timeRestriction&&e.jsxs(l,{size:"sm",color:"secondary",className:"mb-2",children:["時間限制：",s.startTime," - ",s.endTime]})]},s.id))]})]}),z==="dialogue"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsx(m,{htmlFor:"newMessage",children:"添加新對話"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{id:"newMessage",type:"text",value:se,onChange:s=>oe(s.target.value),disabled:r,placeholder:"輸入新對話內容...",onKeyPress:s=>s.key==="Enter"&&!r&&me()}),e.jsx(y,{onClick:()=>me(),disabled:r||!se.trim(),loading:r,children:r?"添加中...":"添加"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(m,{children:["對話列表 (",b.length,"條)"]}),e.jsx("div",{className:"max-h-64 overflow-y-auto space-y-2 border border-white/10 rounded-lg p-3",children:b.length===0?e.jsx(l,{color:"secondary",className:"text-center py-4",children:"暫無對話內容"}):b.map((s,a)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/5 rounded-lg",children:[e.jsx(l,{className:"flex-1",children:s}),e.jsx(y,{onClick:()=>ue(a),variant:"ghost",size:"sm",disabled:r,className:"p-1 text-red-400 hover:text-red-300",title:"刪除",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},a))})]})]}),e.jsxs("div",{className:"mt-8 bg-gradient-to-r from-purple-500/10 to-blue-500/10 border border-purple-500/20 rounded-lg p-6",children:[e.jsx(C,{level:3,className:"text-purple-400 mb-4 text-center",children:"所有對話列表"}),e.jsx("div",{className:"space-y-3",children:(()=>{const s=te(g,c,o,v),a=s.map(d=>d.message).filter(d=>d&&typeof d=="string"&&d.trim()!==""),t=b.filter(d=>d&&typeof d=="string"&&d.trim()!==""&&!a.includes(d)),i=[...s.map(d=>({...d,isNormal:!1})),...t.map(d=>({type:"normal",priority:999,message:d,source:"普通對話",isNormal:!0}))],N=[],w=new Set;for(const d of i)w.has(d.message)||(N.push(d),w.add(d.message));return N.length===0?e.jsx(l,{size:"sm",className:"text-gray-400 text-center py-4",children:"目前沒有任何對話"}):N.map((d,A)=>e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs(l,{size:"sm",className:"text-green-400 font-bold",children:[A+1,". ",d.source]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${d.type==="custom"?"bg-purple-500/20 text-purple-400":d.type==="schedule"?"bg-blue-500/20 text-blue-400":d.type==="normal"?"bg-orange-500/20 text-orange-400":"bg-gray-500/20 text-gray-400"}`,children:d.type==="custom"?"自定義規則":d.type==="schedule"?"班表模板":d.type==="normal"?"普通對話":"其他"})]}),e.jsx(l,{className:"text-white",children:d.message})]},A))})()}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-white/10",children:[e.jsx(l,{size:"sm",className:"text-blue-300 font-bold mb-2",children:"詳細調試資訊："}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-xs text-gray-400",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{children:["班表資料：",g?"已載入":"未載入"]}),e.jsxs("div",{children:["姓名資料：",Object.keys(v).length>0?`已載入 ${Object.keys(v).length} 個`:"未載入"]}),e.jsxs("div",{children:["今天上班同事：",g?W(g).length:0," 人"]}),e.jsxs("div",{children:["自定義規則：",c.filter(s=>s.enabled).length," 個啟用"]}),e.jsxs("div",{children:["班表模板：",o.filter(s=>s.enabled).length," 個啟用"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{children:["智能對話：",te(g,c,o,v).length," 條"]}),e.jsxs("div",{children:["普通對話：",b.length," 條"]}),e.jsxs("div",{children:["總對話數：",te(g,c,o,v).length+b.length," 條"]}),e.jsxs("div",{children:["當前時間：",new Date().toLocaleString()]}),e.jsxs("div",{children:["星期：",new Date().toLocaleDateString("zh-TW",{weekday:"long"})]})]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-white/10",children:[e.jsx(l,{size:"sm",className:"text-blue-300 font-bold mb-2",children:"連續上班天數："}),e.jsx("div",{className:"space-y-1 text-xs text-gray-400",children:(()=>{const s=Fe(g,v,1,30);if(s.length===0)return e.jsx("div",{className:"text-gray-500",children:"無連續上班同事"});const a={};return s.forEach(t=>{a[t.consecutiveDays]||(a[t.consecutiveDays]=[]),a[t.consecutiveDays].push(t.name)}),Object.entries(a).sort(([t],[i])=>parseInt(i)-parseInt(t)).map(([t,i])=>{const N=parseInt(t);let w="text-gray-300";return N>=6?w="text-red-400":N>=4&&(w="text-yellow-400"),e.jsxs("div",{className:"bg-white/5 rounded p-2 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs("span",{className:`font-semibold ${w}`,children:[t,"天："]}),e.jsx("span",{className:"text-gray-300 ml-1",children:i.join("、")})]}),N>=4&&e.jsx("span",{className:`text-xs px-2 py-1 rounded ${N>=6?"bg-red-500/20 text-red-300":"bg-yellow-500/20 text-yellow-300"}`,children:N>=6?"高風險":"注意"})]},t)})})()})]}),o.filter(s=>s.enabled).length>0&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-white/10",children:[e.jsx(l,{size:"sm",className:"text-blue-300 font-bold mb-2",children:"班表模板調試："}),e.jsx("div",{className:"space-y-1 text-xs text-gray-400",children:o.filter(s=>s.enabled).map((s,a)=>{const t=W(g),i=Re(t,v),N=s.timeRestriction?be(s.startTime,s.endTime):!0,w=Se(s,g,v),d=w&&typeof w=="string"&&w.trim()!=="";return e.jsxs("div",{className:"bg-white/5 rounded p-2",children:[e.jsxs("div",{children:["模板：",s.name]}),e.jsxs("div",{children:["時間限制：",s.timeRestriction?`${s.startTime}-${s.endTime}`:"無"]}),e.jsxs("div",{children:["時間檢查：",N?"通過":"不通過"]}),e.jsxs("div",{children:["會顯示：",d?"是":"否"]}),d&&e.jsxs("div",{children:["處理後：",w]}),e.jsxs("div",{children:["早班同事：",i.morning.join("、")||"無"]}),e.jsxs("div",{children:["中班同事：",i.afternoon.join("、")||"無"]}),e.jsxs("div",{children:["晚班同事：",i.evening.join("、")||"無"]})]},a)})})]})]})]})]})},Ke=()=>{const[c,o]=x.useState(!1),[h,f]=x.useState([]),[r,k]=x.useState(4),[b,$]=x.useState(!1),[q,I]=x.useState(!0),[U,X]=x.useState(!1),[G,F]=x.useState(""),[Y,R]=x.useState(""),[L,Q]=x.useState(null),[z,K]=x.useState(!1),[M,Z]=x.useState([]),[n,E]=x.useState([]),g=_e();x.useEffect(()=>de.onAuthStateChanged(async p=>{if(p)try{const j=await Pe(p.uid);$(j),j||(F("您沒有管理員權限"),setTimeout(()=>g("/"),3e3))}catch(j){F("檢查權限時發生錯誤"),console.error("權限檢查失敗:",j)}else $(!1),F("請先登入"),setTimeout(()=>g("/"),2e3);I(!1)}),[g]),x.useEffect(()=>{b&&(async()=>{try{console.log("AdminPanel: 開始載入班表資料...");const p=await ae(V(P,"schedule","currentMonth")),j=await ae(V(P,"schedule","nextMonth"));console.log("AdminPanel: currentMonthDoc.exists():",p.exists()),console.log("AdminPanel: nextMonthDoc.exists():",j.exists());let W=null;p.exists()?W=p.data():j.exists()&&(W=j.data()),Q(W)}catch{}})()},[b]),x.useEffect(()=>b?We(V(P,"catSpeech","global"),p=>{if(p.exists()){const j=p.data();o(j.enabled||!1),f(j.texts||[]),k(j.intervalSeconds||4),K(j.smartMode||!1),Z(j.customRules||[]),E(j.scheduleTemplates||[])}},p=>{console.error("監聽設定失敗:",p),F("載入設定失敗")}):void 0,[b]);const ee=async()=>{try{I(!0);const{signOut:u}=await Be(async()=>{const{signOut:p}=await import("./index-CMqf4Yce.js").then(j=>j.x);return{signOut:p}},__vite__mapDeps([0,1]));await u(de),g("/")}catch(u){console.error("登出失敗:",u),F("登出失敗"),I(!1)}},v=async u=>{var p;if(b)try{X(!0),F(""),R(""),await He(V(P,"catSpeech","global"),{...u,lastUpdated:Ve(),updatedBy:(p=de.currentUser)==null?void 0:p.uid}),R("設定已更新"),setTimeout(()=>R(""),3e3)}catch(j){console.error("更新設定失敗:",j),F("更新設定失敗")}finally{X(!1)}},re=async u=>{Z(u),await v({texts:h,enabled:c,intervalSeconds:r,smartMode:z,customRules:u,scheduleTemplates:n})},J=async u=>{E(u),await v({texts:h,enabled:c,intervalSeconds:r,smartMode:z,customRules:M,scheduleTemplates:u})};return q?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx(l,{size:"lg",className:"mb-2",children:"載入中..."}),e.jsx(l,{size:"sm",color:"secondary",children:"正在檢查管理員權限"})]})}):G?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center max-w-md mx-auto",children:[e.jsx("div",{className:"text-red-400 text-4xl mb-4",children:"⚠️"}),e.jsx(C,{level:2,className:"mb-4",children:"發生錯誤"}),e.jsx(l,{className:"mb-6",children:G}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(y,{onClick:()=>g("/"),variant:"primary",size:"lg",className:"w-full",children:"返回首頁"}),e.jsx(y,{onClick:()=>window.location.reload(),variant:"secondary",size:"lg",className:"w-full",children:"重新載入"})]})]})}):b?e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs(Ue,{children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx(C,{level:1,gradient:!0,className:"mb-2",children:"管理員設定"}),e.jsx(l,{color:"secondary",children:"管理貓咪對話和系統設定"})]}),Y&&e.jsx("div",{className:"mb-6 bg-green-500/10 border border-green-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-green-400",children:"✓"}),e.jsx(l,{color:"success",children:Y})]})}),e.jsx("div",{className:"flex justify-end mb-6",children:e.jsx(y,{onClick:ee,variant:"danger",disabled:q,loading:q,children:q?"登出中...":"登出管理員"})}),e.jsx(Ge,{customRules:M,scheduleTemplates:n,onRulesChange:re,onTemplatesChange:J,isSaving:U,scheduleData:L,speechTexts:h,onSpeechTextsChange:u=>v({texts:u,enabled:c,intervalSeconds:r,smartMode:z,customRules:M,scheduleTemplates:n}),showBubble:c,onShowBubbleChange:u=>v({texts:h,enabled:u,intervalSeconds:r,smartMode:z,customRules:M,scheduleTemplates:n}),intervalSeconds:r,onIntervalSecondsChange:u=>v({texts:h,enabled:c,intervalSeconds:u,smartMode:z,customRules:M,scheduleTemplates:n}),smartMode:z,onSmartModeChange:u=>v({texts:h,enabled:c,intervalSeconds:r,smartMode:u,customRules:M,scheduleTemplates:n})})]})}):null};export{Ke as default};
