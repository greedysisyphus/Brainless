import{r as s,j as e,F as V,a as Z,b as B}from"./index-BL6-aDu_.js";function z({title:i,titleId:o,...d},m){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:m,"aria-labelledby":o},d),i?s.createElement("title",{id:o},i):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Y=s.forwardRef(z),K=[{value:1e3,label:"$1000"},{value:500,label:"$500"},{value:100,label:"$100"},{value:50,label:"$50"},{value:10,label:"$10"},{value:5,label:"$5"},{value:1,label:"$1"}];function O({title:i,onTotalChange:o,savedKey:d,resetKey:m=0}){const[x,c]=s.useState(()=>{const t=localStorage.getItem(d);return t?JSON.parse(t):{}}),[g,v]=s.useState(0);s.useEffect(()=>{m>0&&(c({}),v(0),o(0))},[m,o]),s.useEffect(()=>{const t=Object.entries(x).reduce((a,[u,p])=>a+parseInt(u)*(parseInt(p)||0),0);v(t),o(t)},[x,o]),s.useEffect(()=>{localStorage.setItem(d,JSON.stringify(x))},[x,d]);const f=(t,a)=>{a<0&&(a=0),c(u=>({...u,[t]:a}))},j=()=>{c({}),localStorage.removeItem(d)};return e.jsxs("div",{className:"bg-surface rounded-xl p-6 shadow-lg",role:"region","aria-label":i,children:[e.jsx("h2",{className:"text-xl font-bold mb-6 bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent",children:i}),e.jsx("div",{className:"grid gap-2",children:K.map(({value:t,label:a})=>e.jsxs("div",{className:"bg-white/5 rounded-lg p-3 border border-white/10 hover:border-white/20 transition-all duration-200 hover:bg-white/10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-semibold text-white",children:a}),e.jsx("span",{className:"text-xs text-gray-300",children:"小計"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",min:"0",value:x[t]||"",onChange:u=>f(t,parseInt(u.target.value)),className:"flex-1 px-3 py-2.5 bg-white/10 border border-white/20 rounded-lg text-center text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary/50 transition-all duration-200 text-sm font-medium",placeholder:"0",inputMode:"decimal","aria-label":`${a} 數量`,role:"spinbutton","aria-valuemin":"0","aria-valuenow":x[t]||0}),e.jsx("div",{className:"w-24 px-2 py-1.5 bg-primary/20 rounded-lg border border-primary/30",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-gray-300",children:"金額"}),e.jsxs("div",{className:"text-sm font-bold text-primary",children:["$",((x[t]||0)*t).toLocaleString()]})]})})]})]},t))}),e.jsx("div",{className:"mt-4 bg-gradient-to-r from-primary/10 to-secondary/10 rounded-lg p-3 border border-primary/20",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-300",children:"總計金額"}),e.jsxs("div",{className:"text-lg font-bold text-white",children:["$",g.toLocaleString()]})]}),e.jsx("button",{onClick:j,className:`px-3 py-1.5 bg-white/10 hover:bg-white/20 
                       text-gray-300 hover:text-white rounded-lg transition-all duration-200
                       border border-white/20 hover:border-white/30 text-sm
                       focus:outline-none focus:ring-2 focus:ring-red-500/50`,"aria-label":"清除所有數據",children:"清除全部"})]})})]})}function X({title:i,titleId:o,...d},m){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:m,"aria-labelledby":o},d),i?s.createElement("title",{id:o},i):null,s.createElement("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z",clipRule:"evenodd"}))}const q=s.forwardRef(X);function G({title:i,titleId:o,...d},m){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:m,"aria-labelledby":o},d),i?s.createElement("title",{id:o},i):null,s.createElement("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm-1.72 6.97a.75.75 0 1 0-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 1 0 1.06 1.06L12 13.06l1.72 1.72a.75.75 0 1 0 1.06-1.06L13.06 12l1.72-1.72a.75.75 0 1 0-1.06-1.06L12 10.94l-1.72-1.72Z",clipRule:"evenodd"}))}const E=s.forwardRef(G),Q=[{code:"USD",name:"美元"},{code:"EUR",name:"歐元"},{code:"JPY",name:"日圓"},{code:"CNY",name:"人民幣"},{code:"HKD",name:"港幣"}];function _({onTotalChange:i,savedKey:o,resetKey:d=0}){const[m,x]=s.useState(()=>{const t=localStorage.getItem(o);return t?JSON.parse(t):[]}),[c,g]=s.useState({currency:"USD",amount:"",rate:""});s.useEffect(()=>{d>0&&(x([]),g({currency:"USD",amount:"",rate:""}),i(0))},[d,i]),s.useEffect(()=>{localStorage.setItem(o,JSON.stringify(m))},[m,o]),s.useEffect(()=>{const t=m.reduce((a,u)=>a+u.localValue,0);i(t)},[m,i]);const v=t=>{if(t.preventDefault(),!c.amount||!c.rate)return;const a=Math.floor(c.amount*c.rate),u={...c,localValue:a,id:Date.now()};x(p=>[...p,u]),g(p=>({...p,amount:"",rate:""}))},f=t=>{x(a=>a.filter(u=>u.id!==t))},j=()=>{x([]),localStorage.removeItem(o)};return e.jsxs("div",{className:"bg-surface rounded-xl p-6 shadow-lg",role:"region","aria-label":"外幣交易管理",children:[e.jsx("h2",{className:"text-xl font-bold mb-6 bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent",children:"外幣交易"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("form",{onSubmit:v,className:"space-y-3",children:[e.jsx("select",{value:c.currency,onChange:t=>g(a=>({...a,currency:t.target.value})),className:"w-full px-3 py-2.5 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary/50 transition-all duration-200","aria-label":"選擇幣種",children:Q.map(t=>e.jsxs("option",{value:t.code,className:"bg-surface",children:[t.code," (",t.name,")"]},t.code))}),e.jsx("input",{type:"number",value:c.amount,onChange:t=>g(a=>({...a,amount:parseFloat(t.target.value)})),className:"w-full px-3 py-2.5 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary/50 transition-all duration-200",placeholder:"金額",step:"0.01",inputMode:"decimal",pattern:"[0-9]*[.,]?[0-9]*","aria-label":"外幣金額"}),e.jsx("input",{type:"number",value:c.rate,onChange:t=>g(a=>({...a,rate:parseFloat(t.target.value)})),className:"w-full px-3 py-2.5 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary/50 transition-all duration-200",placeholder:"匯率",step:"0.01",inputMode:"decimal",pattern:"[0-9]*[.,]?[0-9]*","aria-label":"匯率"}),e.jsx("button",{type:"submit",className:"w-full px-4 py-2.5 bg-primary/20 hover:bg-primary/30 text-primary border border-primary/30 hover:border-primary/50 rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50","aria-label":"新增外幣交易",children:"新增"})]}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:m.map(t=>e.jsxs("div",{className:"bg-white/5 rounded-lg p-3 flex justify-between items-center group border border-white/10 hover:border-white/20 transition-all duration-200 hover:bg-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm text-white",children:[t.currency," ",t.amount.toFixed(2)," @ ",t.rate]}),e.jsx("button",{onClick:()=>f(t.id),className:"text-gray-300 hover:text-red-400 transition-colors duration-200 opacity-0 group-hover:opacity-100","aria-label":`刪除 ${t.currency} 交易`,children:e.jsx(E,{className:"w-4 h-4"})})]}),e.jsxs("span",{className:"text-sm text-gray-200 font-medium",children:["$",t.localValue.toLocaleString()]})]},t.id))})]}),e.jsx("div",{className:"mt-4 bg-gradient-to-r from-primary/10 to-secondary/10 rounded-lg p-3 border border-primary/20",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-300",children:"總計"}),e.jsxs("div",{className:"text-lg font-bold text-white",children:["$",m.reduce((t,a)=>t+a.localValue,0).toLocaleString()]})]}),e.jsx("button",{onClick:j,className:`px-3 py-1.5 bg-white/10 hover:bg-white/20 
                       text-gray-300 hover:text-white rounded-lg transition-all duration-200
                       border border-white/20 hover:border-white/30 text-sm
                       focus:outline-none focus:ring-2 focus:ring-red-500/50`,"aria-label":"清除所有外幣交易",children:"清除全部"})]})})]})}function ee({cashierTotal:i,drawerTotal:o,foreignTotal:d,posAmount:m,onPosAmountChange:x,foreignTransactions:c,resetKey:g=0}){const[v,f]=s.useState(!1),[j,t]=s.useState(!1);s.useEffect(()=>{g>0&&(f(!1),t(!1),x(0))},[g,x]);const a=i+o+d-2e4,u=a-m,p=i+o-2e4-d,I=()=>u===0?{containerClass:"bg-gradient-to-r from-green-500/10 to-emerald-500/10 border-green-500/20",textClass:"text-green-400",icon:e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"w-6 h-6 text-green-400 animate-pulse"}),e.jsx("div",{className:"absolute inset-0 bg-green-400/20 rounded-full blur-lg animate-pulse"})]}),message:"金額正確"}:u>0?{containerClass:"bg-yellow-500/10 border border-yellow-500/20",textClass:"text-yellow-400",icon:e.jsx(E,{className:"w-6 h-6 text-yellow-400"}),message:"金額過多"}:{containerClass:"bg-red-500/10 border border-red-500/20",textClass:"text-red-400",icon:e.jsx(E,{className:"w-6 h-6 text-red-400"}),message:"金額不足"},P=()=>{f(!0)},w=I();return e.jsxs("div",{className:"bg-surface rounded-xl p-6 shadow-lg",role:"region","aria-label":"日結匯總管理",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent",children:"日結匯總"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-300",children:"晚班模式"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:j,onChange:N=>t(N.target.checked),"aria-label":"切換晚班模式"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-white/5 rounded-lg p-3 border border-white/10",children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-2",children:"POS機金額"}),e.jsx("input",{type:"number",value:m||"",onChange:N=>{x(parseFloat(N.target.value)||0),f(!1)},className:"w-full px-3 py-2.5 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary/50 transition-all duration-200 mb-3",placeholder:"請輸入POS機金額",inputMode:"decimal","aria-label":"POS機金額"}),e.jsx("button",{onClick:P,className:"w-full px-4 py-2.5 bg-primary/20 hover:bg-primary/30 text-primary border border-primary/30 hover:border-primary/50 rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50","aria-label":"計算日結差異",children:"計算"})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg border border-white/10 overflow-hidden",children:[e.jsx("div",{className:"p-3 border-b border-white/10",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-300",children:"收銀機現金"}),e.jsxs("span",{className:"text-sm text-white font-medium",children:["$",i.toLocaleString()]})]})}),e.jsx("div",{className:"p-3 border-b border-white/10",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-300",children:"抽屜現金"}),e.jsxs("span",{className:"text-sm text-white font-medium",children:["$",o.toLocaleString()]})]})}),e.jsx("div",{className:"p-3 border-b border-white/10",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-300",children:"外幣總額"}),e.jsxs("span",{className:"text-sm text-white font-medium",children:["$",d.toLocaleString()]})]})}),e.jsx("div",{className:"p-3 border-b border-white/10",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-red-400",children:"基本金額"}),e.jsx("span",{className:"text-sm text-red-400 font-medium",children:"-$20,000"})]})}),e.jsx("div",{className:"p-3 bg-primary/10",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-semibold text-white",children:"實際現金收入"}),e.jsxs("span",{className:"text-lg font-bold text-primary",children:["$",a.toLocaleString()]})]})})]}),v&&e.jsx("div",{className:`rounded-lg p-3 border transition-all duration-300 ${u===0?"bg-green-500/10 border-green-500/20":u>0?"bg-yellow-500/10 border-yellow-500/20":"bg-red-500/10 border-red-500/20"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-semibold text-white",children:"差額"}),w.icon,e.jsx("span",{className:`text-sm ${w.textClass}`,children:w.message})]}),e.jsxs("span",{className:`text-lg font-bold ${w.textClass}`,children:["$",u.toLocaleString()]})]})}),j&&e.jsxs("div",{className:"bg-background/50 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-surface/50 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg font-semibold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent",children:"需上繳金額"}),e.jsx("div",{className:"h-4 w-4 rounded-full bg-gradient-to-r from-primary to-secondary animate-pulse opacity-75"})]}),e.jsx("div",{className:"text-xs px-2 py-1 rounded-full bg-primary/10 text-primary",children:"晚班結算"})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"relative bg-surface/30 rounded-xl p-4 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/5 to-secondary/5"}),e.jsxs("div",{className:"relative flex justify-between items-center",children:[e.jsx("span",{className:"text-text-secondary font-medium",children:"台幣"}),e.jsxs("span",{className:"text-xl font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent",children:["$",p.toLocaleString()]})]})]}),e.jsxs("div",{className:"bg-surface/30 rounded-xl p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("span",{className:"text-text-secondary font-medium",children:"外幣"}),!(c!=null&&c.length)&&e.jsx("span",{className:"text-sm text-text-secondary",children:"無外幣紀錄"})]}),(c==null?void 0:c.length)>0&&e.jsx("div",{className:"bg-background/30 rounded-lg p-2 space-y-2",children:c.map((N,h)=>e.jsxs("div",{className:"flex justify-between items-center px-3 py-2 rounded-lg hover:bg-surface/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-primary/50"}),e.jsx("span",{className:"font-medium text-text-secondary",children:N.currency})]}),e.jsxs("span",{className:"text-lg font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent",children:["$",N.amount.toLocaleString()]})]},h))})]})]})]})]})]})}function ae(){const[i,o]=s.useState(()=>{const r=localStorage.getItem("cashierTotal");return r?parseFloat(r):0}),[d,m]=s.useState(()=>{const r=localStorage.getItem("drawerTotal");return r?parseFloat(r):0}),[x,c]=s.useState(()=>{const r=localStorage.getItem("foreignTotal");return r?parseFloat(r):0}),[g,v]=s.useState(()=>{const r=localStorage.getItem("posAmount");return r?parseFloat(r):0}),[f,j]=s.useState(!1),t=()=>{try{return JSON.parse(localStorage.getItem("rateHistory")||"[]")}catch{return[]}},a=r=>{if(!r||parseFloat(r)<=0)return;const n=t(),b=r.toString(),y=n.filter(D=>D!==b),k=[b,...y].slice(0,10);localStorage.setItem("rateHistory",JSON.stringify(k))},[u,p]=s.useState(0),[I,P]=s.useState(!1),w=r=>{const b=t().filter(y=>y!==r);localStorage.setItem("rateHistory",JSON.stringify(b)),p(y=>y+1)},N=()=>{localStorage.removeItem("rateHistory"),p(r=>r+1)},[h,S]=s.useState({rate:localStorage.getItem("lastExchangeRate")||"",foreignAmount:"",productPrice:""}),[C,J]=s.useState(0);s.useEffect(()=>{localStorage.setItem("cashierTotal",i),localStorage.setItem("drawerTotal",d),localStorage.setItem("foreignTotal",x),localStorage.setItem("posAmount",g)},[i,d,x,g]);const U=()=>{o(0),m(0),c(0),v(0),localStorage.removeItem("cashierTotal"),localStorage.removeItem("drawerTotal"),localStorage.removeItem("foreignTotal"),localStorage.removeItem("posAmount"),localStorage.removeItem("cashierDenominations"),localStorage.removeItem("drawerDenominations"),localStorage.removeItem("foreignTransactions"),localStorage.removeItem("lastExchangeRate"),localStorage.removeItem("rateHistory"),S({rate:"",foreignAmount:"",productPrice:""}),p(r=>r+1),J(r=>r+1)},l=(()=>{const{rate:r,foreignAmount:n,productPrice:b}=h;if(!r||!n||!b)return null;const y=parseFloat(r),k=parseFloat(n),D=parseFloat(b),T=D/y,L=Math.ceil(T),M=Math.ceil(L*y),H=Math.floor(k*y),W=H-M;return{changeInForeign:W/y,changeInTWD:W,foreignAmount:k,rate:y,productPrice:D,productPriceInForeign:T,roundedProductPriceInForeign:L,roundedProductPriceInTWD:M,foreignAmountInTWD:H}})(),F=l&&l.foreignAmount===l.roundedProductPriceInForeign,$=l&&l.changeInTWD<0&&!F,R=l&&l.changeInTWD>0,A=l&&l.rate>0&&l.foreignAmount>0&&l.productPrice>0;return s.useEffect(()=>{const r=n=>{n.key==="Escape"&&f&&j(!1),n.key};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[f,A]),e.jsxs("div",{className:"container-custom py-6",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-white mb-2",children:"收銀管理系統"}),e.jsxs("p",{className:"text-text-secondary",children:["討厭算錢的第",e.jsx("span",{className:"inline-block px-2 py-1 bg-primary/20 border border-primary/30 rounded-lg text-primary font-semibold mx-1",children:Math.floor((new Date-new Date("2024-05-01"))/(1e3*60*60*24))}),"天"]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>j(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-green-500/20 to-emerald-500/20 border border-green-400/30 text-green-400 hover:from-green-500/30 hover:to-emerald-500/30 hover:border-green-500/50 transition-all duration-200 rounded-xl shadow-lg hover:shadow-xl",children:[e.jsx(V,{className:"w-5 h-5"}),e.jsx("span",{className:"hidden sm:inline",children:"外幣找零"})]}),e.jsxs("button",{onClick:U,className:"inline-flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-red-500/20 to-pink-500/20 border border-red-400/30 text-red-400 hover:from-red-500/30 hover:to-pink-500/30 hover:border-red-500/50 transition-all duration-200 rounded-xl shadow-lg hover:shadow-xl",children:[e.jsx(Z,{className:"w-5 h-5"}),e.jsx("span",{className:"hidden sm:inline",children:"重置數據"})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(O,{title:"收銀機現金",onTotalChange:o,savedKey:"cashierDenominations",resetKey:C}),e.jsx(O,{title:"抽屜現金",onTotalChange:m,savedKey:"drawerDenominations",resetKey:C}),e.jsx(_,{onTotalChange:c,savedKey:"foreignTransactions",resetKey:C}),e.jsx(ee,{cashierTotal:i,drawerTotal:d,foreignTotal:x,posAmount:g,onPosAmountChange:v,foreignTransactions:C>0?[]:JSON.parse(localStorage.getItem("foreignTransactions")||"[]"),resetKey:C})]}),e.jsx("button",{onClick:()=>j(!0),className:"fixed bottom-6 right-6 p-4 bg-gradient-to-r from-green-500/20 to-emerald-500/20 border border-green-400/30 text-green-400 hover:from-green-500/30 hover:to-emerald-500/30 hover:border-green-500/50 transition-all duration-200 rounded-full shadow-lg hover:shadow-xl z-50 hover:scale-110 transform touch-manipulation active:scale-95",style:{minWidth:"64px",minHeight:"64px"},"aria-label":"開啟外幣找零計算器",children:e.jsx(Y,{className:"w-7 h-7"})}),f&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-start justify-center p-4 touch-manipulation overflow-y-auto",onClick:()=>j(!1),children:e.jsxs("div",{className:"bg-surface/95 backdrop-blur-md border border-white/20 rounded-2xl w-full max-w-md shadow-2xl touch-manipulation my-8",onClick:r=>r.stopPropagation(),children:[e.jsx("div",{className:"sticky top-0 bg-surface/95 backdrop-blur-md border-b border-white/10 rounded-t-2xl p-6 pb-4 z-10",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-green-400 mb-1",children:"外幣找零計算器"}),e.jsx("p",{className:"text-sm text-text-secondary",children:"計算外幣找零金額 • 按 ESC 關閉"})]}),e.jsx("button",{onClick:()=>j(!1),className:"p-4 rounded-xl hover:bg-red-500/20 text-red-400 transition-all duration-200 touch-manipulation active:scale-95",style:{minWidth:"56px",minHeight:"56px"},"aria-label":"關閉外幣找零計算器",children:e.jsx(B,{className:"w-7 h-7"})})]})}),e.jsxs("div",{className:"p-6 pt-4 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-surface/40 to-surface/20 rounded-xl p-4 border border-white/10",children:[e.jsxs("label",{className:"block text-sm font-semibold mb-3 text-blue-400 flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-blue-400"}),"匯率 (1 外幣 = ? TWD)"]}),e.jsx("input",{type:"number",value:h.rate,onChange:r=>{const n=r.target.value;S(b=>({...b,rate:n})),n&&parseFloat(n)>0&&localStorage.setItem("lastExchangeRate",n)},onBlur:r=>{const n=r.target.value;n&&parseFloat(n)>0&&(a(n),p(b=>b+1))},onKeyDown:r=>{if(r.key==="Enter"){const n=r.target.value;n&&parseFloat(n)>0&&(a(n),p(b=>b+1))}},className:`input-field w-full text-sm py-4 px-4 rounded-lg bg-white/5 border transition-all touch-manipulation min-h-[52px] ${h.rate&&parseFloat(h.rate)<=0?"border-red-400/50 focus:border-red-400/70":"border-white/10 focus:border-blue-400/50 hover:border-blue-400/30"} focus:bg-white/10`,placeholder:"輸入匯率",step:"0.01",inputMode:"decimal",min:"0.01"}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("button",{onClick:()=>P(!I),className:"inline-flex items-center gap-2 px-3 py-2 text-sm text-text-secondary hover:text-blue-400 transition-colors rounded-lg hover:bg-blue-500/10",children:[e.jsx("span",{children:"歷史匯率"}),t().length>0&&e.jsx("span",{className:"text-xs bg-blue-500/20 text-blue-400 px-2 py-0.5 rounded-full",children:t().length}),e.jsx("span",{className:`text-xs transition-transform duration-200 ${I?"rotate-180":""}`,children:"▼"})]}),I&&e.jsxs("div",{className:"mt-2 p-4 bg-gradient-to-br from-blue-500/5 to-cyan-500/5 rounded-xl border border-blue-400/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"text-sm font-medium text-blue-400",children:"已儲存的匯率"}),t().length>0&&e.jsx("button",{onClick:N,className:"text-xs text-red-400/60 hover:text-red-400 transition-colors px-2 py-1 rounded hover:bg-red-500/10",title:"清除所有歷史記錄",children:"清除全部"})]}),t().length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:t().map((r,n)=>e.jsxs("div",{className:"flex items-center gap-1 bg-white/5 border border-white/10 rounded-lg px-3 py-2 hover:bg-white/10 transition-colors",children:[e.jsx("button",{onClick:()=>{S(b=>({...b,rate:r})),localStorage.setItem("lastExchangeRate",r)},className:"text-sm text-white hover:text-blue-400 transition-colors font-medium",children:r}),e.jsx("button",{onClick:()=>w(r),className:"text-xs text-text-secondary hover:text-red-400 transition-colors ml-1 w-4 h-4 flex items-center justify-center rounded hover:bg-red-500/10",title:"刪除此匯率",children:"×"})]},`${r}-${n}`))}):e.jsx("div",{className:"text-sm text-text-secondary/60 text-center py-2",children:"尚無歷史記錄"})]},u)]}),h.rate&&parseFloat(h.rate)<=0&&e.jsxs("div",{className:"text-red-400 text-xs mt-2 flex items-center gap-1",children:[e.jsx("span",{children:"⚠️"}),e.jsx("span",{children:"匯率必須大於 0"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-surface/40 to-surface/20 rounded-xl p-4 border border-white/10",children:[e.jsxs("label",{className:"block text-sm font-semibold mb-3 text-orange-400 flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-orange-400"}),"商品價格 (TWD)"]}),e.jsx("input",{type:"number",value:h.productPrice,onChange:r=>S(n=>({...n,productPrice:r.target.value})),className:`input-field w-full text-sm py-4 px-4 rounded-lg bg-white/5 border transition-all touch-manipulation min-h-[52px] ${h.productPrice&&parseFloat(h.productPrice)<0?"border-red-400/50 focus:border-red-400/70":"border-white/10 focus:border-orange-400/50 hover:border-orange-400/30"} focus:bg-white/10`,placeholder:"輸入商品價格",step:"0.01",inputMode:"decimal",min:"0"}),h.productPrice&&parseFloat(h.productPrice)<0&&e.jsxs("div",{className:"text-red-400 text-xs mt-2 flex items-center gap-1",children:[e.jsx("span",{children:"⚠️"}),e.jsx("span",{children:"商品價格不能為負數"})]})]}),e.jsxs("div",{className:"sm:col-span-2 bg-gradient-to-br from-surface/40 to-surface/20 rounded-xl p-4 border border-white/10",children:[e.jsxs("label",{className:"block text-sm font-semibold mb-3 text-purple-400 flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-purple-400"}),"客人付的外幣金額"]}),e.jsx("input",{type:"number",value:h.foreignAmount,onChange:r=>S(n=>({...n,foreignAmount:r.target.value})),className:`input-field w-full text-sm py-4 px-4 rounded-lg bg-white/5 border transition-all touch-manipulation min-h-[52px] ${h.foreignAmount&&parseFloat(h.foreignAmount)<0?"border-red-400/50 focus:border-red-400/70":"border-white/10 focus:border-purple-400/50 hover:border-purple-400/30"} focus:bg-white/10`,placeholder:"輸入外幣金額",step:"0.01",inputMode:"decimal",min:"0"}),h.foreignAmount&&parseFloat(h.foreignAmount)<0&&e.jsxs("div",{className:"text-red-400 text-xs mt-2 flex items-center gap-1",children:[e.jsx("span",{children:"⚠️"}),e.jsx("span",{children:"外幣金額不能為負數"})]})]})]}),l&&e.jsxs("div",{className:`rounded-xl p-6 border shadow-lg animate-fadeIn ${F?"bg-gradient-to-br from-green-500/20 to-emerald-500/20 border-green-400/40 shadow-green-500/20":$?"bg-gradient-to-br from-red-500/20 to-pink-500/20 border-red-400/40 shadow-red-500/20":R?"bg-gradient-to-br from-blue-500/20 to-cyan-500/20 border-blue-400/40 shadow-blue-500/20":"bg-gradient-to-br from-green-500/10 to-emerald-500/10 border-green-400/20 shadow-green-500/10"}`,children:[F&&e.jsxs("div",{className:"flex items-center gap-3 mb-6 p-4 bg-green-500/20 rounded-xl border border-green-400/30",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-400 animate-pulse"}),e.jsx("span",{className:"text-base font-semibold text-green-400",children:"金額剛好，無需找零"})]}),$&&e.jsxs("div",{className:"flex items-center gap-3 mb-6 p-4 bg-red-500/20 rounded-xl border border-red-400/30",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-400"}),e.jsx("span",{className:"text-base font-semibold text-red-400",children:"金額不足，需補差額"})]}),R&&e.jsxs("div",{className:"flex items-center gap-3 mb-6 p-4 bg-blue-500/20 rounded-xl border border-blue-400/30",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-400"}),e.jsx("span",{className:"text-base font-semibold text-blue-400",children:"需要找零"})]}),!F&&e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"text-sm text-text-secondary mb-2",children:"最終找零金額"}),e.jsxs("div",{className:`text-4xl font-bold mb-2 ${$?"text-red-400":"text-blue-400"}`,children:["$",l.changeInTWD.toFixed(0)]}),e.jsxs("div",{className:"text-base text-text-secondary mb-4",children:["外幣等值：",l.changeInForeign.toFixed(2)]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm text-text-secondary",children:"付款金額"}),e.jsxs("span",{className:"text-sm font-semibold text-purple-400",children:["$",l.foreignAmountInTWD.toFixed(0)]})]}),e.jsx("div",{className:"w-full bg-white/10 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${$?"bg-red-400":"bg-blue-400"}`,style:{width:`${Math.min(100,Math.max(0,l.foreignAmountInTWD/l.roundedProductPriceInTWD*100))}%`}})}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsx("span",{className:"text-sm text-text-secondary",children:"商品價格"}),e.jsxs("span",{className:"text-sm font-semibold text-orange-400",children:["$",l.roundedProductPriceInTWD.toFixed(0)]})]})]})]}),e.jsxs("details",{className:"mt-6",children:[e.jsx("summary",{className:"text-sm font-semibold text-text-secondary cursor-pointer hover:text-white transition-colors flex items-center gap-2 min-h-[44px]",children:"查看詳細計算步驟"}),e.jsxs("div",{className:"mt-4 space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-text-secondary",children:"原始商品價格："}),e.jsxs("span",{className:"font-semibold text-orange-400",children:["$",l.productPrice.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-text-secondary",children:"商品價格（外幣等值）："}),e.jsx("span",{className:"font-semibold text-yellow-400",children:l.productPriceInForeign.toFixed(4)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-text-secondary",children:"進位後商品價格（外幣）："}),e.jsx("span",{className:"font-semibold text-cyan-400",children:l.roundedProductPriceInForeign.toFixed(0)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-text-secondary",children:"進位後商品價格（台幣）："}),e.jsxs("span",{className:"font-semibold text-cyan-400",children:["$",l.roundedProductPriceInTWD.toFixed(0)]})]}),e.jsxs("div",{className:"border-t border-white/10 pt-2 mt-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-text-secondary",children:"客人付的外幣："}),e.jsx("span",{className:"font-semibold text-purple-400",children:l.foreignAmount.toFixed(0)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-text-secondary",children:"客人付的台幣等值："}),e.jsxs("span",{className:"font-semibold text-purple-400",children:["$",l.foreignAmountInTWD.toFixed(0)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-text-secondary",children:"減去商品價格（台幣）："}),e.jsxs("span",{className:"font-semibold text-red-400",children:["-$",l.roundedProductPriceInTWD.toFixed(0)]})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("button",{onClick:()=>S({rate:"",foreignAmount:"",productPrice:""}),className:`px-6 py-4 bg-white/5 hover:bg-white/10 
                            text-text-secondary rounded-xl transition-all duration-200 touch-manipulation active:scale-95
                            min-h-[56px] text-base font-medium`,children:"清除輸入"}),l&&e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(`找零金額：$${l.changeInTWD.toFixed(0)}`)},className:`px-6 py-4 bg-blue-500/20 hover:bg-blue-500/30 
                              text-blue-400 rounded-xl transition-all duration-200 touch-manipulation active:scale-95 
                              border border-blue-400/30 min-h-[56px] text-base font-medium`,children:"複製結果"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-500/10 to-cyan-500/10 rounded-xl p-4 border border-blue-400/20",children:[e.jsx("h3",{className:"text-sm font-semibold text-blue-400 mb-3",children:"計算公式"}),e.jsxs("div",{className:"text-sm text-text-secondary space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-5 h-5 rounded-full bg-blue-400/20 text-blue-400 text-xs flex items-center justify-center font-bold",children:"1"}),e.jsx("span",{children:"商品價格 ÷ 匯率 = 外幣等值（進位）"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-5 h-5 rounded-full bg-blue-400/20 text-blue-400 text-xs flex items-center justify-center font-bold",children:"2"}),e.jsx("span",{children:"外幣等值 × 匯率 = 台幣價格（進位）"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-5 h-5 rounded-full bg-blue-400/20 text-blue-400 text-xs flex items-center justify-center font-bold",children:"3"}),e.jsx("span",{children:"客人外幣 × 匯率 = 台幣等值（捨去）"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-5 h-5 rounded-full bg-blue-400/20 text-blue-400 text-xs flex items-center justify-center font-bold",children:"4"}),e.jsx("span",{children:"台幣等值 - 台幣價格 = 找零金額"})]})]})]})]})]})})]})}export{ae as default};
