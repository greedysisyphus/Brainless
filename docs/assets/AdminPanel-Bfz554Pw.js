const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BpFX72zA.js","assets/index-Bn0cTHbW.css"])))=>i.map(i=>d[i]);
import{j as e,r as o,g as te,c as Fe,p as Se,a as ae,d as U,b as P,e as Re,f as Ee,v as Le,h as Ae,i as qe,k as Ie,u as Oe,l as de,m as _e,o as Pe,_ as He,s as We,n as Be}from"./index-BpFX72zA.js";const Ue=({children:n,className:c="",maxWidth:x="container-custom",padding:f="py-4 sm:py-6 lg:py-8",center:t=!0})=>e.jsx("div",{className:`${x} ${f} ${t?"mx-auto":""} ${c}`,children:n}),Ve=({children:n,className:c="",padding:x="p-4 sm:p-6",hover:f=!0})=>e.jsx("div",{className:`
      bg-surface rounded-xl shadow-lg border border-white/5 
      ${x} 
      ${f?"hover:shadow-xl hover:border-white/10 transition-all duration-200":""} 
      ${c}
    `,children:n}),y=({children:n,onClick:c,variant:x="primary",size:f="md",disabled:t=!1,loading:v=!1,className:u="",...M})=>{const L=()=>{switch(x){case"primary":return"bg-primary text-white hover:bg-primary/80 disabled:bg-primary/50";case"secondary":return"bg-white/10 text-white hover:bg-white/20 disabled:bg-white/5";case"danger":return"bg-red-500/20 text-red-400 hover:bg-red-500/30 border border-red-500/30 disabled:bg-red-500/10";case"ghost":return"text-text-secondary hover:text-text-primary hover:bg-white/5 disabled:text-gray-500";default:return"bg-primary text-white hover:bg-primary/80 disabled:bg-primary/50"}},A=()=>{switch(f){case"sm":return"px-3 py-2 text-sm";case"md":return"px-4 py-2";case"lg":return"px-6 py-3 text-lg";default:return"px-4 py-2"}};return e.jsx("button",{onClick:c,disabled:t||v,className:`
        ${L()}
        ${A()}
        rounded-lg transition-all duration-200
        disabled:opacity-50 disabled:cursor-not-allowed
        focus:outline-none focus:ring-2 focus:ring-primary/50
        ${u}
      `,...M,children:v?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}),"è¼‰å…¥ä¸­..."]}):n})},k=({value:n,onChange:c,placeholder:x="",type:f="text",disabled:t=!1,error:v=!1,className:u="",...M})=>e.jsx("input",{type:f,value:n,onChange:c,placeholder:x,disabled:t,className:`
        w-full p-3 sm:p-4
        bg-white/10 border rounded-lg
        text-white placeholder-gray-400
        focus:outline-none focus:ring-2 focus:ring-primary/50
        disabled:opacity-50 disabled:cursor-not-allowed
        ${v?"border-red-500/50 focus:ring-red-500/50":"border-white/20"}
        ${u}
      `,...M}),b=({children:n,htmlFor:c,className:x="",required:f=!1})=>e.jsx("label",{htmlFor:c,className:`
        block text-sm sm:text-base text-white mb-2
        ${f?'after:content-["*"] after:text-red-400 after:ml-1':""}
        ${x}
      `,children:n}),C=({children:n,level:c=1,className:x="",gradient:f=!1})=>{const t=()=>{switch(c){case 1:return"text-2xl sm:text-3xl lg:text-4xl";case 2:return"text-xl sm:text-2xl lg:text-3xl";case 3:return"text-lg sm:text-xl lg:text-2xl";case 4:return"text-base sm:text-lg lg:text-xl";case 5:return"text-sm sm:text-base lg:text-lg";case 6:return"text-xs sm:text-sm lg:text-base";default:return"text-xl sm:text-2xl lg:text-3xl"}},v=()=>f?"bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent":"text-white",u=`h${c}`;return e.jsx(u,{className:`font-bold ${t()} ${v()} ${x}`,children:n})},a=({children:n,size:c="base",color:x="white",className:f="",...t})=>{const v=()=>{switch(c){case"xs":return"text-xs";case"sm":return"text-sm";case"base":return"text-base";case"lg":return"text-lg";case"xl":return"text-xl";default:return"text-base"}},u=()=>{switch(x){case"white":return"text-white";case"secondary":return"text-text-secondary";case"primary":return"text-primary";case"danger":return"text-red-400";case"success":return"text-green-400";default:return"text-white"}};return e.jsx("p",{className:`${v()} ${u()} ${f}`,...t,children:n})},Xe=({customRules:n=[],scheduleTemplates:c=[],onRulesChange:x,onTemplatesChange:f,isSaving:t=!1,scheduleData:v=null,speechTexts:u=[],onSpeechTextsChange:M,showBubble:L=!1,onShowBubbleChange:A,intervalSeconds:V=4,onIntervalSecondsChange:X,smartMode:G=!1,onSmartModeChange:$})=>{const[Y,F]=o.useState(!1),[q,Q]=o.useState(null),[z,K]=o.useState("custom"),[D,Z]=o.useState(!1),[m,E]=o.useState({name:"",type:"timeRange",startTime:"08:00",endTime:"10:00",day:"ä¸€",month:1,date:1,messages:[""],enabled:!0}),[j,ee]=o.useState(null),[N,re]=o.useState({}),[J,h]=o.useState(!1),[p,g]=o.useState(!1);o.useEffect(()=>{v?ee(v):(async()=>{try{h(!0);const r=await ae(U(P,"schedule","currentMonth")),l=await ae(U(P,"schedule","nextMonth"));let d=null;r.exists()?d=r.data():l.exists()&&(d=l.data()),ee(d)}catch(r){console.error("è¼‰å…¥ç­è¡¨è³‡æ–™å¤±æ•—:",r)}finally{h(!1)}})()},[v]),o.useEffect(()=>{(async()=>{try{g(!0);const r=await Re(Ee(P,"names")),l={};r.forEach(d=>{const w=d.data();w.name&&(l[d.id]=w.name)}),re(l)}catch(r){console.error("è¼‰å…¥åŒäº‹å§“åè³‡æ–™å¤±æ•—:",r)}finally{g(!1)}})()},[]);const H=s=>{if(!s||typeof s!="object")return[];const r=[],l=new Date,d=l.getFullYear(),w=l.getMonth()+1,T=l.getDate();for(const[i,I]of Object.entries(s))if(i!=="_lastUpdated"&&I&&typeof I=="object"){for(const[ie,O]of Object.entries(I))if(O&&O.trim()&&O!=="ä¼‘å‡"&&O!=="ç‰¹ä¼‘"&&O!=="æœˆä¼‘"){const _=parseInt(ie);_===T&&r.push({id:`${i}_${_}`,date:`${d}-${String(w).padStart(2,"0")}-${String(_).padStart(2,"0")}`,shift:O,employee:i})}}return r},[S,le]=o.useState({name:"",message:"",enabled:!0,timeRestriction:!1,startTime:"08:00",endTime:"10:00"}),[W,ce]=o.useState(null),[se,oe]=o.useState(""),me=async()=>{if(se.trim()&&M){const s=[...u,se.trim()];try{await M(s),oe("")}catch(r){console.error("æ·»åŠ å°è©±å¤±æ•—:",r)}}},ue=async s=>{if(M){const r=u.filter((l,d)=>d!==s);try{await M(r)}catch(l){console.error("åˆªé™¤å°è©±å¤±æ•—:",l)}}},xe=()=>{le({name:"",message:"",enabled:!0,timeRestriction:!1,startTime:"08:00",endTime:"10:00"}),ce(null),F(!1)},B=(s,r)=>{le(l=>({...l,[s]:r}))},be=(s,r)=>{const l=new Date,d=l.getHours(),w=l.getMinutes(),T=d*60+w,[i,I]=s.split(":").map(Number),[ie,O]=r.split(":").map(Number),_=i*60+I,ne=ie*60+O;return ne<_?T>=_||T<=ne:T>=_&&T<=ne},he=()=>{E({name:"",type:"timeRange",startTime:"08:00",endTime:"10:00",day:"ä¸€",month:1,date:1,messages:[""],enabled:!0}),Q(null),F(!1)},R=(s,r)=>{E(l=>({...l,[s]:r}))},ge=(s,r)=>{const l=[...m.messages];l[s]=r,E(d=>({...d,messages:l}))},je=()=>{E(s=>({...s,messages:[...s.messages,""]}))},pe=s=>{if(m.messages.length>1){const r=m.messages.filter((l,d)=>d!==s);E(l=>({...l,messages:r}))}},ye=()=>{if(!m.name.trim()){alert("è«‹å¡«å¯«è¦å‰‡åç¨±");return}const s=m.messages.filter(d=>d&&typeof d=="string"&&d.trim()!=="");if(s.length===0){alert("è«‹è‡³å°‘æ·»åŠ ä¸€å€‹å°è©±å…§å®¹");return}const r={id:q?q.id:Date.now().toString(),...m,messages:s};if(!Le(r)){alert("è¦å‰‡è¨­å®šæœ‰èª¤ï¼Œè«‹æª¢æŸ¥æ™‚é–“æ ¼å¼");return}let l;q?l=n.map(d=>d.id===q.id?r:d):l=[...n,r],x(l),he()},fe=s=>{if(window.confirm("ç¢ºå®šè¦åˆªé™¤é€™å€‹è¦å‰‡å—Žï¼Ÿ")){const r=n.filter(l=>l.id!==s);x(r)}},Ne=s=>{const r=n.map(l=>l.id===s?{...l,enabled:!l.enabled}:l);x(r)},ve=s=>{E({name:s.name,type:s.type,startTime:s.startTime||"08:00",endTime:s.endTime||"10:00",day:s.day||"ä¸€",month:s.month||1,date:s.date||1,messages:s.messages||[""],enabled:s.enabled}),Q(s),F(!0)},we=()=>{window.confirm("ç¢ºå®šè¦è¼‰å…¥é è¨­è¦å‰‡å—Žï¼Ÿé€™æœƒè¦†è“‹ç¾æœ‰çš„è‡ªå®šç¾©è¦å‰‡ã€‚")&&x(Ae())},Te=()=>{if(!S.name.trim()){alert("è«‹å¡«å¯«æ¨¡æ¿åç¨±");return}if(!S.message.trim()){alert("è«‹å¡«å¯«å•å€™èªžå…§å®¹");return}const s={id:W?W.id:Date.now().toString(),...S};if(!qe(s)){alert("æ¨¡æ¿è¨­å®šæœ‰èª¤ï¼Œè«‹æª¢æŸ¥å…§å®¹");return}let r;W?r=c.map(l=>l.id===W.id?s:l):r=[...c,s],f(r),xe()},ze=s=>{if(window.confirm("ç¢ºå®šè¦åˆªé™¤é€™å€‹æ¨¡æ¿å—Žï¼Ÿ")){const r=c.filter(l=>l.id!==s);f(r)}},ke=s=>{const r=c.map(l=>l.id===s?{...l,enabled:!l.enabled}:l);f(r)},Ce=s=>{le({name:s.name,message:s.message,enabled:s.enabled,timeRestriction:s.timeRestriction||!1,startTime:s.startTime||"08:00",endTime:s.endTime||"10:00"}),ce(s),F(!0)},Me=()=>{const s=Ie();f(s)},De=()=>{if(J){alert("è«‹ç¨å€™ï¼Œæ­£åœ¨è¼‰å…¥ç­è¡¨è³‡æ–™...");return}if(p){alert("è«‹ç¨å€™ï¼Œæ­£åœ¨è¼‰å…¥å§“åè³‡æ–™...");return}if(!j){alert("ç„¡ç­è¡¨è³‡æ–™ï¼Œç„¡æ³•é è¦½æ‰€æœ‰æ™ºèƒ½å°è©±ã€‚");return}Object.keys(N).length===0&&alert("ç„¡å§“åè³‡æ–™ï¼Œå°‡é¡¯ç¤ºè·å“¡ç·¨è™Ÿã€‚");const s=te(j,n,c,N),r=s.map((l,d)=>`${d+1}. [${l.source}] ${l.message}`).join(`

`);s.length===0?alert(`ç›®å‰æ²’æœ‰è§¸ç™¼çš„æ™ºèƒ½å°è©±ã€‚

åªæœƒæ’­æ”¾æ‚¨è¨­å®šçš„æ™®é€šå°è©±ã€‚`):alert(`æ™ºèƒ½å°è©±é è¦½ (å…±${s.length}æ¢)ï¼š

${r}

æ³¨æ„ï¼šé€™äº›å°è©±æœƒèˆ‡æ‚¨è¨­å®šçš„æ™®é€šå°è©±ä¸€èµ·è¼ªæµæ’­æ”¾ã€‚`)},$e=()=>{switch(m.type){case"timeRange":return e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(b,{htmlFor:"startTime",required:!0,children:"é–‹å§‹æ™‚é–“"}),e.jsx(k,{id:"startTime",type:"time",value:m.startTime,onChange:s=>R("startTime",s.target.value),disabled:t})]}),e.jsxs("div",{children:[e.jsx(b,{htmlFor:"endTime",required:!0,children:"çµæŸæ™‚é–“"}),e.jsx(k,{id:"endTime",type:"time",value:m.endTime,onChange:s=>R("endTime",s.target.value),disabled:t})]})]});case"dayOfWeek":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(b,{htmlFor:"daySelect",required:!0,children:"æ˜ŸæœŸå¹¾"}),e.jsxs("select",{id:"daySelect",value:m.day,onChange:s=>R("day",s.target.value),disabled:t,className:"w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary/50 disabled:opacity-50",children:[e.jsx("option",{value:"ä¸€",children:"æ˜ŸæœŸä¸€"}),e.jsx("option",{value:"äºŒ",children:"æ˜ŸæœŸäºŒ"}),e.jsx("option",{value:"ä¸‰",children:"æ˜ŸæœŸä¸‰"}),e.jsx("option",{value:"å››",children:"æ˜ŸæœŸå››"}),e.jsx("option",{value:"äº”",children:"æ˜ŸæœŸäº”"}),e.jsx("option",{value:"å…­",children:"æ˜ŸæœŸå…­"}),e.jsx("option",{value:"æ—¥",children:"æ˜ŸæœŸæ—¥"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(b,{htmlFor:"startTime",required:!0,children:"é–‹å§‹æ™‚é–“"}),e.jsx(k,{id:"startTime",type:"time",value:m.startTime,onChange:s=>R("startTime",s.target.value),disabled:t})]}),e.jsxs("div",{children:[e.jsx(b,{htmlFor:"endTime",required:!0,children:"çµæŸæ™‚é–“"}),e.jsx(k,{id:"endTime",type:"time",value:m.endTime,onChange:s=>R("endTime",s.target.value),disabled:t})]})]})]});case"specificDate":return e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(b,{htmlFor:"month",required:!0,children:"æœˆä»½"}),e.jsx(k,{id:"month",type:"number",min:"1",max:"12",value:m.month,onChange:s=>R("month",parseInt(s.target.value)),disabled:t})]}),e.jsxs("div",{children:[e.jsx(b,{htmlFor:"date",required:!0,children:"æ—¥æœŸ"}),e.jsx(k,{id:"date",type:"number",min:"1",max:"31",value:m.date,onChange:s=>R("date",parseInt(s.target.value)),disabled:t})]})]});default:return null}};return e.jsxs(Ve,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx(C,{level:2,gradient:!0,children:"æ™ºèƒ½å°è©±è¦å‰‡ç®¡ç†"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{onClick:De,variant:"secondary",size:"sm",disabled:t||J||p,children:"é è¦½æ‰€æœ‰å°è©±"}),e.jsx(y,{onClick:()=>F(!0),variant:"primary",size:"sm",disabled:t,children:"æ·»åŠ è¦å‰‡"})]})]}),e.jsxs("div",{className:"bg-orange-500/10 border border-orange-500/20 rounded-lg p-4 mb-6",children:[e.jsx(C,{level:3,className:"text-orange-400 mb-4",children:"åŸºæœ¬è¨­å®š"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"bubbleToggle",checked:L,disabled:t,onChange:s=>A&&A(s.target.checked),className:"w-5 h-5 disabled:opacity-50"}),e.jsx(b,{htmlFor:"bubbleToggle",className:"!mb-0",children:"é¡¯ç¤ºå°è©±è¼ªæ’­"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"smartModeToggle",checked:G,disabled:t,onChange:()=>$&&$(!G),className:"w-5 h-5 disabled:opacity-50"}),e.jsx(b,{htmlFor:"smartModeToggle",className:"!mb-0",children:"æ™ºèƒ½æ¨¡å¼ï¼ˆæ ¹æ“šè‡ªå®šç¾©è¦å‰‡å’Œç­è¡¨å•å€™è‡ªå‹•é¡¯ç¤ºå°è©±ï¼‰"})]}),e.jsxs("div",{children:[e.jsxs(b,{htmlFor:"intervalSlider",children:["è¼ªæ’­é–“éš” (",V,"ç§’)"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"range",id:"intervalSlider",min:"1",max:"10",value:V,disabled:t,onChange:s=>X&&X(parseInt(s.target.value)),className:"flex-1 h-2 bg-white/10 rounded-lg appearance-none cursor-pointer slider disabled:opacity-50"}),e.jsxs("span",{className:"text-white min-w-[3rem] text-center",children:[V,"s"]})]}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[e.jsx("span",{children:"1ç§’"}),e.jsx("span",{children:"10ç§’"})]})]})]})]}),e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-4 mb-6",children:[e.jsx(C,{level:3,className:"text-blue-400 mb-2",children:"è³‡æ–™è¼‰å…¥ç‹€æ…‹"}),e.jsx(a,{size:"sm",className:"text-blue-300",children:J?"è¼‰å…¥ç­è¡¨ä¸­...":j?`ç­è¡¨è³‡æ–™ï¼š${Object.keys(j).filter(s=>s!=="_lastUpdated").length} ä½åŒäº‹`:"ç­è¡¨è³‡æ–™ï¼šæœªè¼‰å…¥"}),j&&j._lastUpdated&&e.jsxs(a,{size:"sm",className:"text-blue-300 mt-1",children:["æœ€å¾Œæ›´æ–°ï¼š",new Date(j._lastUpdated).toLocaleString()]}),e.jsx(a,{size:"sm",className:"text-blue-300 mt-1",children:p?"è¼‰å…¥å§“åä¸­...":Object.keys(N).length>0?`å§“åå°æ‡‰ï¼š${Object.keys(N).length} ä½åŒäº‹`:"å§“åå°æ‡‰ï¼šæœªè¼‰å…¥"})]}),e.jsxs("div",{className:"flex border-b border-white/10 mb-6",children:[e.jsxs("button",{onClick:()=>K("custom"),className:`px-4 py-2 text-sm font-medium transition-colors ${z==="custom"?"text-primary border-b-2 border-primary":"text-text-secondary hover:text-text-primary"}`,children:["è‡ªå®šç¾©è¦å‰‡ (",n.length,")"]}),e.jsxs("button",{onClick:()=>K("schedule"),className:`px-4 py-2 text-sm font-medium transition-colors ${z==="schedule"?"text-primary border-b-2 border-primary":"text-text-secondary hover:text-text-primary"}`,children:["ç­è¡¨å•å€™æ¨¡æ¿ (",c.length,")"]}),e.jsxs("button",{onClick:()=>K("dialogue"),className:`px-4 py-2 text-sm font-medium transition-colors ${z==="dialogue"?"text-primary border-b-2 border-primary":"text-text-secondary hover:text-text-primary"}`,children:["å°è©±ç®¡ç† (",u.length,")"]})]}),z==="custom"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-purple-500/10 border border-purple-500/20 rounded-lg p-4 mb-6",children:[e.jsx(C,{level:3,className:"text-purple-400 mb-2",children:"è‡ªå®šç¾©è¦å‰‡èªªæ˜Ž"}),e.jsx(a,{size:"sm",className:"text-purple-300",children:"å¯ä»¥è¨­å®šç‰¹å®šæ™‚é–“ç¯„åœã€æ˜ŸæœŸå¹¾æˆ–ç‰¹å®šæ—¥æœŸçš„å°è©±è¦å‰‡ï¼Œç³»çµ±æœƒæ ¹æ“šæ¢ä»¶è‡ªå‹•é¡¯ç¤ºå°è©±ã€‚"})]}),Y&&e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-lg p-4 mb-6",children:[e.jsx(C,{level:3,className:"mb-4",children:q?"ç·¨è¼¯è¦å‰‡":"æ·»åŠ æ–°è¦å‰‡"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(b,{htmlFor:"ruleName",required:!0,children:"è¦å‰‡åç¨±"}),e.jsx(k,{id:"ruleName",value:m.name,onChange:s=>R("name",s.target.value),placeholder:"ä¾‹å¦‚ï¼šæ—©ä¸Šå•å€™",disabled:t})]}),e.jsxs("div",{children:[e.jsx(b,{htmlFor:"ruleType",required:!0,children:"è¦å‰‡é¡žåž‹"}),e.jsxs("select",{id:"ruleType",value:m.type,onChange:s=>R("type",s.target.value),disabled:t,className:"w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary/50 disabled:opacity-50",children:[e.jsx("option",{value:"timeRange",children:"æ™‚é–“ç¯„åœ"}),e.jsx("option",{value:"dayOfWeek",children:"æ˜ŸæœŸå¹¾"}),e.jsx("option",{value:"specificDate",children:"ç‰¹å®šæ—¥æœŸ"})]})]}),$e(),e.jsxs("div",{children:[e.jsxs(b,{required:!0,children:["å°è©±å…§å®¹ (",m.messages.length,"æ¢)"]}),e.jsxs("div",{className:"space-y-2",children:[m.messages.map((s,r)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{value:s,onChange:l=>ge(r,l.target.value),placeholder:`å°è©± ${r+1}...`,disabled:t}),e.jsx(y,{onClick:()=>pe(r),variant:"danger",size:"sm",disabled:t||m.messages.length<=1,className:"px-3",children:"åˆªé™¤"})]},r)),e.jsx(y,{onClick:je,variant:"secondary",size:"sm",disabled:t,className:"w-full",children:"æ·»åŠ å°è©±"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"ruleEnabled",checked:m.enabled,onChange:s=>R("enabled",s.target.checked),disabled:t,className:"w-5 h-5 disabled:opacity-50"}),e.jsx(b,{htmlFor:"ruleEnabled",className:"!mb-0",children:"å•Ÿç”¨æ­¤è¦å‰‡"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{onClick:ye,variant:"primary",disabled:t,loading:t,children:q?"æ›´æ–°è¦å‰‡":"æ·»åŠ è¦å‰‡"}),e.jsx(y,{onClick:he,variant:"secondary",disabled:t,children:"å–æ¶ˆ"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(b,{children:["ç¾æœ‰è¦å‰‡ (",n.length,"æ¢)"]}),e.jsx(y,{onClick:we,variant:"secondary",size:"sm",disabled:t,children:"è¼‰å…¥é è¨­"})]}),n.length===0?e.jsx(a,{color:"secondary",className:"text-center py-8",children:"æš«ç„¡è‡ªå®šç¾©è¦å‰‡"}):n.map(s=>{var r,l;return e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:s.enabled,onChange:()=>Ne(s.id),disabled:t,className:"w-4 h-4 disabled:opacity-50"}),e.jsx(C,{level:4,className:"!mb-0",children:s.name}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.enabled?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"}`,children:s.enabled?"å•Ÿç”¨":"åœç”¨"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{onClick:()=>ve(s),variant:"ghost",size:"sm",disabled:t,children:"ç·¨è¼¯"}),e.jsx(y,{onClick:()=>fe(s.id),variant:"danger",size:"sm",disabled:t,children:"åˆªé™¤"})]})]}),e.jsxs(a,{size:"sm",color:"secondary",className:"mb-2",children:["é¡žåž‹ï¼š",s.type==="timeRange"?"æ™‚é–“ç¯„åœ":s.type==="dayOfWeek"?"æ˜ŸæœŸå¹¾":"ç‰¹å®šæ—¥æœŸ"]}),s.type==="timeRange"&&e.jsxs(a,{size:"sm",color:"secondary",className:"mb-2",children:["æ™‚é–“ï¼š",s.startTime," - ",s.endTime]}),s.type==="dayOfWeek"&&e.jsxs(a,{size:"sm",color:"secondary",className:"mb-2",children:["æ˜ŸæœŸ",s.day," ",s.startTime," - ",s.endTime]}),s.type==="specificDate"&&e.jsxs(a,{size:"sm",color:"secondary",className:"mb-2",children:[s.month,"æœˆ",s.date,"æ—¥"]}),e.jsxs(a,{size:"sm",color:"secondary",className:"mb-2",children:["å°è©±æ•¸é‡ï¼š",((r=s.messages)==null?void 0:r.length)||0," æ¢"]}),e.jsx("div",{className:"space-y-1",children:(l=s.messages)==null?void 0:l.map((d,w)=>e.jsx(a,{className:"bg-white/5 rounded p-2 text-sm",children:d},w))})]},s.id)})]})]}),z==="schedule"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(C,{level:3,className:"text-blue-400",children:"å¯ç”¨è®Šæ•¸èªªæ˜Ž"}),e.jsxs(y,{onClick:()=>Z(!D),variant:"secondary",size:"sm",className:"flex items-center gap-2",children:[D?"éš±è—èªªæ˜Ž":"é¡¯ç¤ºèªªæ˜Ž",e.jsx("span",{className:"text-xs",children:D?"â–¼":"â–¶"})]})]}),D&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[e.jsx(a,{size:"sm",className:"text-blue-300 font-bold mb-3 text-center",children:"ðŸ“‹ ç­æ¬¡è®Šæ•¸"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(a,{size:"sm",className:"text-blue-300",children:["â€¢ ","{æ—©ç­åŒäº‹}"," - æ—©ç­åŒäº‹åå­—"]}),e.jsxs(a,{size:"sm",className:"text-blue-300",children:["â€¢ ","{ä¸­ç­åŒäº‹}"," - ä¸­ç­åŒäº‹åå­—"]}),e.jsxs(a,{size:"sm",className:"text-blue-300",children:["â€¢ ","{æ™šç­åŒäº‹}"," - æ™šç­åŒäº‹åå­—"]}),e.jsxs(a,{size:"sm",className:"text-blue-300",children:["â€¢ ","{æ‰€æœ‰åŒäº‹}"," - æ‰€æœ‰ä¸Šç­åŒäº‹åå­—"]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-white/10",children:[e.jsx(a,{size:"sm",className:"text-blue-300 font-semibold mb-2",children:"ðŸ’¡ ä½¿ç”¨ç¯„ä¾‹ï¼š"}),e.jsxs(a,{size:"sm",className:"text-blue-300",children:["â€¢ ","{æ—©ç­åŒäº‹}ï¼Œæ—©å®‰ï¼"," â†’ å°æ˜Žã€å°è¯ï¼Œæ—©å®‰ï¼"]}),e.jsxs(a,{size:"sm",className:"text-blue-300",children:["â€¢ ","{æ‰€æœ‰åŒäº‹}ï¼Œå·¥ä½œè¾›è‹¦äº†ï¼"," â†’ å°æ˜Žã€å°è¯ã€å°ç¾Žï¼Œå·¥ä½œè¾›è‹¦äº†ï¼"]})]})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[e.jsx(a,{size:"sm",className:"text-blue-300 font-bold mb-3 text-center",children:"ðŸ‘¥ äººæ•¸è®Šæ•¸"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(a,{size:"sm",className:"text-blue-300",children:["â€¢ ","{æ—©ç­äººæ•¸}"," - æ—©ç­äººæ•¸"]}),e.jsxs(a,{size:"sm",className:"text-blue-300",children:["â€¢ ","{ä¸­ç­äººæ•¸}"," - ä¸­ç­äººæ•¸"]}),e.jsxs(a,{size:"sm",className:"text-blue-300",children:["â€¢ ","{æ™šç­äººæ•¸}"," - æ™šç­äººæ•¸"]}),e.jsxs(a,{size:"sm",className:"text-blue-300",children:["â€¢ ","{ç¸½äººæ•¸}"," - ç¸½ä¸Šç­äººæ•¸"]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-white/10",children:[e.jsx(a,{size:"sm",className:"text-blue-300 font-semibold mb-2",children:"ðŸ’¡ ä½¿ç”¨ç¯„ä¾‹ï¼š"}),e.jsxs(a,{size:"sm",className:"text-blue-300",children:["â€¢ ","ä»Šå¤©æœ‰{ç¸½äººæ•¸}ä½åŒäº‹ä¸Šç­"," â†’ ä»Šå¤©æœ‰5ä½åŒäº‹ä¸Šç­"]}),e.jsxs(a,{size:"sm",className:"text-blue-300",children:["â€¢ ","æ—©ç­{æ—©ç­äººæ•¸}äººï¼Œæ™šç­{æ™šç­äººæ•¸}äºº"," â†’ æ—©ç­2äººï¼Œæ™šç­3äºº"]})]})]})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[e.jsx(a,{size:"sm",className:"text-blue-300 font-bold mb-4 text-center",children:"â° é€£çºŒä¸Šç­è®Šæ•¸"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx(a,{size:"sm",className:"text-blue-300 font-semibold mb-2",children:"ðŸ”§ åŸºæœ¬è®Šæ•¸"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(a,{size:"sm",className:"text-blue-300",children:["â€¢ ","{é€£çºŒä¸Šç­åŒäº‹}"," - é€£çºŒä¸Šç­4-6å¤©çš„åŒäº‹ï¼ˆé¡¯ç¤ºåå­—+å¤©æ•¸ï¼‰"]}),e.jsxs(a,{size:"sm",className:"text-blue-300",children:["â€¢ ","{é€£çºŒä¸Šç­åŒäº‹æ•¸é‡}"," - é€£çºŒä¸Šç­4-6å¤©çš„åŒäº‹æ•¸é‡"]})]})]}),e.jsxs("div",{children:[e.jsx(a,{size:"sm",className:"text-blue-300 font-semibold mb-2",children:"ðŸŽ¯ æŒ‡å®šå¤©æ•¸è®Šæ•¸"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(a,{size:"sm",className:"text-blue-300",children:["â€¢ ","{é€£çºŒä¸Šç­Xå¤©åŒäº‹}"," - æŒ‡å®šå¤©æ•¸çš„åŒäº‹åå­—ï¼ˆXç‚ºæ•¸å­—ï¼Œåªé¡¯ç¤ºåå­—ï¼‰"]}),e.jsxs(a,{size:"sm",className:"text-blue-300",children:["â€¢ ","{é€£çºŒä¸Šç­Xå¤©åŒäº‹æ•¸é‡}"," - æŒ‡å®šå¤©æ•¸çš„åŒäº‹æ•¸é‡"]})]})]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-white/10",children:[e.jsx(a,{size:"sm",className:"text-blue-300 font-semibold mb-2",children:"ðŸ’¡ ä½¿ç”¨ç¯„ä¾‹"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(a,{size:"sm",className:"text-blue-300",children:["â€¢ ","{é€£çºŒä¸Šç­åŒäº‹}ï¼Œè¾›è‹¦äº†ï¼"]}),e.jsx(a,{size:"sm",className:"text-gray-400 text-xs",children:"â†’ å°æ˜Žé€£çºŒä¸Šç­5å¤©ã€å°è¯é€£çºŒä¸Šç­4å¤©ï¼Œè¾›è‹¦äº†ï¼"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs(a,{size:"sm",className:"text-blue-300",children:["â€¢ ","{é€£çºŒä¸Šç­6å¤©åŒäº‹}ï¼Œè«‹å‹™å¿…ä¼‘æ¯"]}),e.jsx(a,{size:"sm",className:"text-gray-400 text-xs",children:"â†’ ç´…è‘‰ï¼Œè«‹å‹™å¿…ä¼‘æ¯"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs(a,{size:"sm",className:"text-blue-300",children:["â€¢ ","ä»Šå¤©æœ‰{é€£çºŒä¸Šç­åŒäº‹æ•¸é‡}ä½åŒäº‹éœ€è¦é—œå¿ƒ"]}),e.jsx(a,{size:"sm",className:"text-gray-400 text-xs",children:"â†’ ä»Šå¤©æœ‰2ä½åŒäº‹éœ€è¦é—œå¿ƒ"})]})]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-white/10",children:[e.jsx(a,{size:"sm",className:"text-blue-300 font-semibold mb-2",children:"âš™ï¸ åŠŸèƒ½èªªæ˜Ž"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(a,{size:"sm",className:"text-blue-300",children:"â€¢ è‡ªå‹•è¨ˆç®—ï¼šå¾žä»Šå¤©é–‹å§‹å¾€å‰è¨ˆç®—ï¼Œé‡åˆ°ä¼‘å‡ç‚ºæ­¢"}),e.jsx(a,{size:"sm",className:"text-blue-300",children:"â€¢ æ™ºèƒ½é¡¯ç¤ºï¼šæ²’æœ‰ç¬¦åˆæ¢ä»¶çš„åŒäº‹æ™‚ï¼Œæ¨¡æ¿ä¸æœƒé¡¯ç¤º"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(a,{size:"sm",className:"text-blue-300",children:"â€¢ é©ç”¨å ´æ™¯ï¼šé—œå¿ƒåŒäº‹ã€æé†’ä¼‘æ¯ã€è¡¨æšå‹¤å¥®"}),e.jsx(a,{size:"sm",className:"text-blue-300",children:"â€¢ æ³¨æ„äº‹é …ï¼šéœ€è¦å…ˆåœ¨å§“åç®¡ç†ä¸­è¨­å®šåŒäº‹å§“åå°æ‡‰"})]})]})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(y,{onClick:()=>F(!0),variant:"primary",size:"sm",disabled:t,children:"æ·»åŠ è¦å‰‡"})})]})]}),Y&&e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-lg p-4 mb-6",children:[e.jsx(C,{level:3,className:"mb-4",children:W?"ç·¨è¼¯æ¨¡æ¿":"æ·»åŠ æ–°æ¨¡æ¿"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(b,{htmlFor:"templateName",required:!0,children:"æ¨¡æ¿åç¨±"}),e.jsx(k,{id:"templateName",value:S.name,onChange:s=>B("name",s.target.value),placeholder:"ä¾‹å¦‚ï¼šæ—©ç­å•å€™",disabled:t})]}),e.jsxs("div",{children:[e.jsx(b,{htmlFor:"templateMessage",required:!0,children:"å•å€™èªžå…§å®¹"}),e.jsx(k,{id:"templateMessage",value:S.message,onChange:s=>B("message",s.target.value),placeholder:"ä¾‹å¦‚ï¼š{æ—©ç­åŒäº‹}ï¼Œæ—©å®‰ï¼ä»Šå¤©ä¹Ÿè¦åŠ æ²¹å–”ï¼",disabled:t})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"templateEnabled",checked:S.enabled,onChange:s=>B("enabled",s.target.checked),disabled:t,className:"w-5 h-5 disabled:opacity-50"}),e.jsx(b,{htmlFor:"templateEnabled",className:"!mb-0",children:"å•Ÿç”¨æ­¤æ¨¡æ¿"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"timeRestriction",checked:S.timeRestriction,onChange:s=>B("timeRestriction",s.target.checked),disabled:t,className:"w-5 h-5 disabled:opacity-50"}),e.jsx(b,{htmlFor:"timeRestriction",className:"!mb-0",children:"å•Ÿç”¨æ™‚é–“é™åˆ¶"})]}),S.timeRestriction&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(b,{htmlFor:"startTime",required:!0,children:"é™åˆ¶é–‹å§‹æ™‚é–“"}),e.jsx(k,{id:"startTime",type:"time",value:S.startTime,onChange:s=>B("startTime",s.target.value),disabled:t})]}),e.jsxs("div",{children:[e.jsx(b,{htmlFor:"endTime",required:!0,children:"é™åˆ¶çµæŸæ™‚é–“"}),e.jsx(k,{id:"endTime",type:"time",value:S.endTime,onChange:s=>B("endTime",s.target.value),disabled:t})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{onClick:Te,variant:"primary",disabled:t,loading:t,children:W?"æ›´æ–°æ¨¡æ¿":"æ·»åŠ æ¨¡æ¿"}),e.jsx(y,{onClick:xe,variant:"secondary",disabled:t,children:"å–æ¶ˆ"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(b,{children:["ç¾æœ‰æ¨¡æ¿ (",c.length,"æ¢)"]}),e.jsx(y,{onClick:Me,variant:"secondary",size:"sm",disabled:t,children:"è¼‰å…¥é è¨­"})]}),c.length===0?e.jsx(a,{color:"secondary",className:"text-center py-8",children:"æš«ç„¡ç­è¡¨å•å€™æ¨¡æ¿"}):c.map(s=>e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:s.enabled,onChange:()=>ke(s.id),disabled:t,className:"w-4 h-4 disabled:opacity-50"}),e.jsx(C,{level:4,className:"!mb-0",children:s.name}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.enabled?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"}`,children:s.enabled?"å•Ÿç”¨":"åœç”¨"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{onClick:()=>Ce(s),variant:"ghost",size:"sm",disabled:t,children:"ç·¨è¼¯"}),e.jsx(y,{onClick:()=>ze(s.id),variant:"danger",size:"sm",disabled:t,children:"åˆªé™¤"})]})]}),e.jsxs(a,{size:"sm",color:"secondary",className:"mb-2",children:["åŽŸå§‹æ¨¡æ¿ï¼š",s.message]}),s.timeRestriction&&e.jsxs(a,{size:"sm",color:"secondary",className:"mb-2",children:["æ™‚é–“é™åˆ¶ï¼š",s.startTime," - ",s.endTime]})]},s.id))]})]}),z==="dialogue"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsx(b,{htmlFor:"newMessage",children:"æ·»åŠ æ–°å°è©±"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{id:"newMessage",type:"text",value:se,onChange:s=>oe(s.target.value),disabled:t,placeholder:"è¼¸å…¥æ–°å°è©±å…§å®¹...",onKeyPress:s=>s.key==="Enter"&&!t&&me()}),e.jsx(y,{onClick:()=>me(),disabled:t||!se.trim(),loading:t,children:t?"æ·»åŠ ä¸­...":"æ·»åŠ "})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(b,{children:["å°è©±åˆ—è¡¨ (",u.length,"æ¢)"]}),e.jsx("div",{className:"max-h-64 overflow-y-auto space-y-2 border border-white/10 rounded-lg p-3",children:u.length===0?e.jsx(a,{color:"secondary",className:"text-center py-4",children:"æš«ç„¡å°è©±å…§å®¹"}):u.map((s,r)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/5 rounded-lg",children:[e.jsx(a,{className:"flex-1",children:s}),e.jsx(y,{onClick:()=>ue(r),variant:"ghost",size:"sm",disabled:t,className:"p-1 text-red-400 hover:text-red-300",title:"åˆªé™¤",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},r))})]})]}),e.jsxs("div",{className:"mt-8 bg-gradient-to-r from-purple-500/10 to-blue-500/10 border border-purple-500/20 rounded-lg p-6",children:[e.jsx(C,{level:3,className:"text-purple-400 mb-4 text-center",children:"æ‰€æœ‰å°è©±åˆ—è¡¨"}),e.jsx("div",{className:"space-y-3",children:(()=>{const s=te(j,n,c,N),r=s.map(i=>i.message).filter(i=>i&&typeof i=="string"&&i.trim()!==""),l=u.filter(i=>i&&typeof i=="string"&&i.trim()!==""&&!r.includes(i)),d=[...s.map(i=>({...i,isNormal:!1})),...l.map(i=>({type:"normal",priority:999,message:i,source:"æ™®é€šå°è©±",isNormal:!0}))],w=[],T=new Set;for(const i of d)T.has(i.message)||(w.push(i),T.add(i.message));return w.length===0?e.jsx(a,{size:"sm",className:"text-gray-400 text-center py-4",children:"ç›®å‰æ²’æœ‰ä»»ä½•å°è©±"}):w.map((i,I)=>e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs(a,{size:"sm",className:"text-green-400 font-bold",children:[I+1,". ",i.source]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${i.type==="custom"?"bg-purple-500/20 text-purple-400":i.type==="schedule"?"bg-blue-500/20 text-blue-400":i.type==="normal"?"bg-orange-500/20 text-orange-400":"bg-gray-500/20 text-gray-400"}`,children:i.type==="custom"?"è‡ªå®šç¾©è¦å‰‡":i.type==="schedule"?"ç­è¡¨æ¨¡æ¿":i.type==="normal"?"æ™®é€šå°è©±":"å…¶ä»–"})]}),e.jsx(a,{className:"text-white",children:i.message})]},I))})()}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-white/10",children:[e.jsx(a,{size:"sm",className:"text-blue-300 font-bold mb-2",children:"è©³ç´°èª¿è©¦è³‡è¨Šï¼š"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-xs text-gray-400",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{children:["ç­è¡¨è³‡æ–™ï¼š",j?"å·²è¼‰å…¥":"æœªè¼‰å…¥"]}),e.jsxs("div",{children:["å§“åè³‡æ–™ï¼š",Object.keys(N).length>0?`å·²è¼‰å…¥ ${Object.keys(N).length} å€‹`:"æœªè¼‰å…¥"]}),e.jsxs("div",{children:["ä»Šå¤©ä¸Šç­åŒäº‹ï¼š",j?H(j).length:0," äºº"]}),e.jsxs("div",{children:["è‡ªå®šç¾©è¦å‰‡ï¼š",n.filter(s=>s.enabled).length," å€‹å•Ÿç”¨"]}),e.jsxs("div",{children:["ç­è¡¨æ¨¡æ¿ï¼š",c.filter(s=>s.enabled).length," å€‹å•Ÿç”¨"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{children:["æ™ºèƒ½å°è©±ï¼š",te(j,n,c,N).length," æ¢"]}),e.jsxs("div",{children:["æ™®é€šå°è©±ï¼š",u.length," æ¢"]}),e.jsxs("div",{children:["ç¸½å°è©±æ•¸ï¼š",te(j,n,c,N).length+u.length," æ¢"]}),e.jsxs("div",{children:["ç•¶å‰æ™‚é–“ï¼š",new Date().toLocaleString()]}),e.jsxs("div",{children:["æ˜ŸæœŸï¼š",new Date().toLocaleDateString("zh-TW",{weekday:"long"})]})]})]}),c.filter(s=>s.enabled).length>0&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-white/10",children:[e.jsx(a,{size:"sm",className:"text-blue-300 font-bold mb-2",children:"ç­è¡¨æ¨¡æ¿èª¿è©¦ï¼š"}),e.jsx("div",{className:"space-y-1 text-xs text-gray-400",children:c.filter(s=>s.enabled).map((s,r)=>{const l=H(j),d=Fe(l,N),w=s.timeRestriction?be(s.startTime,s.endTime):!0,T=Se(s,j,N),i=T&&typeof T=="string"&&T.trim()!=="";return e.jsxs("div",{className:"bg-white/5 rounded p-2",children:[e.jsxs("div",{children:["æ¨¡æ¿ï¼š",s.name]}),e.jsxs("div",{children:["æ™‚é–“é™åˆ¶ï¼š",s.timeRestriction?`${s.startTime}-${s.endTime}`:"ç„¡"]}),e.jsxs("div",{children:["æ™‚é–“æª¢æŸ¥ï¼š",w?"é€šéŽ":"ä¸é€šéŽ"]}),e.jsxs("div",{children:["æœƒé¡¯ç¤ºï¼š",i?"æ˜¯":"å¦"]}),i&&e.jsxs("div",{children:["è™•ç†å¾Œï¼š",T]}),e.jsxs("div",{children:["æ—©ç­åŒäº‹ï¼š",d.morning.join("ã€")||"ç„¡"]}),e.jsxs("div",{children:["ä¸­ç­åŒäº‹ï¼š",d.afternoon.join("ã€")||"ç„¡"]}),e.jsxs("div",{children:["æ™šç­åŒäº‹ï¼š",d.evening.join("ã€")||"ç„¡"]})]},r)})})]})]})]})]})},Ye=()=>{const[n,c]=o.useState(!1),[x,f]=o.useState([]),[t,v]=o.useState(4),[u,M]=o.useState(!1),[L,A]=o.useState(!0),[V,X]=o.useState(!1),[G,$]=o.useState(""),[Y,F]=o.useState(""),[q,Q]=o.useState(null),[z,K]=o.useState(!1),[D,Z]=o.useState([]),[m,E]=o.useState([]),j=Oe();o.useEffect(()=>de.onAuthStateChanged(async p=>{if(p)try{const g=await _e(p.uid);M(g),g||($("æ‚¨æ²’æœ‰ç®¡ç†å“¡æ¬Šé™"),setTimeout(()=>j("/"),3e3))}catch(g){$("æª¢æŸ¥æ¬Šé™æ™‚ç™¼ç”ŸéŒ¯èª¤"),console.error("æ¬Šé™æª¢æŸ¥å¤±æ•—:",g)}else M(!1),$("è«‹å…ˆç™»å…¥"),setTimeout(()=>j("/"),2e3);A(!1)}),[j]),o.useEffect(()=>{u&&(async()=>{try{console.log("AdminPanel: é–‹å§‹è¼‰å…¥ç­è¡¨è³‡æ–™...");const p=await ae(U(P,"schedule","currentMonth")),g=await ae(U(P,"schedule","nextMonth"));console.log("AdminPanel: currentMonthDoc.exists():",p.exists()),console.log("AdminPanel: nextMonthDoc.exists():",g.exists());let H=null;p.exists()?H=p.data():g.exists()&&(H=g.data()),Q(H)}catch{}})()},[u]),o.useEffect(()=>u?Pe(U(P,"catSpeech","global"),p=>{if(p.exists()){const g=p.data();c(g.enabled||!1),f(g.texts||[]),v(g.intervalSeconds||4),K(g.smartMode||!1),Z(g.customRules||[]),E(g.scheduleTemplates||[])}},p=>{console.error("ç›£è½è¨­å®šå¤±æ•—:",p),$("è¼‰å…¥è¨­å®šå¤±æ•—")}):void 0,[u]);const ee=async()=>{try{A(!0);const{signOut:h}=await He(async()=>{const{signOut:p}=await import("./index-BpFX72zA.js").then(g=>g.w);return{signOut:p}},__vite__mapDeps([0,1]));await h(de),j("/")}catch(h){console.error("ç™»å‡ºå¤±æ•—:",h),$("ç™»å‡ºå¤±æ•—"),A(!1)}},N=async h=>{var p;if(u)try{X(!0),$(""),F(""),await We(U(P,"catSpeech","global"),{...h,lastUpdated:Be(),updatedBy:(p=de.currentUser)==null?void 0:p.uid}),F("è¨­å®šå·²æ›´æ–°"),setTimeout(()=>F(""),3e3)}catch(g){console.error("æ›´æ–°è¨­å®šå¤±æ•—:",g),$("æ›´æ–°è¨­å®šå¤±æ•—")}finally{X(!1)}},re=async h=>{Z(h),await N({texts:x,enabled:n,intervalSeconds:t,smartMode:z,customRules:h,scheduleTemplates:m})},J=async h=>{E(h),await N({texts:x,enabled:n,intervalSeconds:t,smartMode:z,customRules:D,scheduleTemplates:h})};return L?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx(a,{size:"lg",className:"mb-2",children:"è¼‰å…¥ä¸­..."}),e.jsx(a,{size:"sm",color:"secondary",children:"æ­£åœ¨æª¢æŸ¥ç®¡ç†å“¡æ¬Šé™"})]})}):G?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center max-w-md mx-auto",children:[e.jsx("div",{className:"text-red-400 text-4xl mb-4",children:"âš ï¸"}),e.jsx(C,{level:2,className:"mb-4",children:"ç™¼ç”ŸéŒ¯èª¤"}),e.jsx(a,{className:"mb-6",children:G}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(y,{onClick:()=>j("/"),variant:"primary",size:"lg",className:"w-full",children:"è¿”å›žé¦–é "}),e.jsx(y,{onClick:()=>window.location.reload(),variant:"secondary",size:"lg",className:"w-full",children:"é‡æ–°è¼‰å…¥"})]})]})}):u?e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs(Ue,{children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx(C,{level:1,gradient:!0,className:"mb-2",children:"ç®¡ç†å“¡è¨­å®š"}),e.jsx(a,{color:"secondary",children:"ç®¡ç†è²“å’ªå°è©±å’Œç³»çµ±è¨­å®š"})]}),Y&&e.jsx("div",{className:"mb-6 bg-green-500/10 border border-green-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-green-400",children:"âœ“"}),e.jsx(a,{color:"success",children:Y})]})}),e.jsx("div",{className:"flex justify-end mb-6",children:e.jsx(y,{onClick:ee,variant:"danger",disabled:L,loading:L,children:L?"ç™»å‡ºä¸­...":"ç™»å‡ºç®¡ç†å“¡"})}),e.jsx(Xe,{customRules:D,scheduleTemplates:m,onRulesChange:re,onTemplatesChange:J,isSaving:V,scheduleData:q,speechTexts:x,onSpeechTextsChange:h=>N({texts:h,enabled:n,intervalSeconds:t,smartMode:z,customRules:D,scheduleTemplates:m}),showBubble:n,onShowBubbleChange:h=>N({texts:x,enabled:h,intervalSeconds:t,smartMode:z,customRules:D,scheduleTemplates:m}),intervalSeconds:t,onIntervalSecondsChange:h=>N({texts:x,enabled:n,intervalSeconds:h,smartMode:z,customRules:D,scheduleTemplates:m}),smartMode:z,onSmartModeChange:h=>N({texts:x,enabled:n,intervalSeconds:t,smartMode:h,customRules:D,scheduleTemplates:m})})]})}):null};export{Ye as default};
